(function(){var t={"esri/core/pbf":268,"esri/layers/graphics/sources/FeatureLayerSource":2023},e=this||window,r=e.webpackJsonp=e.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(t):(r.absMidsWaiting=r.absMidsWaiting||[]).push(t)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{2023:function(t,e,r){var a,n;a=[r.dj.c(t.i),e,r(117),r(165),r(154),r(323),r(152),r(153),r(172),r(151),r(463),r(829),r(248)],void 0===(n=function(t,e,r,a,n,s,i,o,u,d,p,h,l){function c(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return"string"==typeof t?[2,u.dataComponents(t)||{data:t}]:[2,o.create((function(e,r){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){return e(u.dataComponents(a.result))},a.onerror=function(t){return r(t)}}))]}))}))}Object.defineProperty(e,"__esModule",{value:!0});var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="feature-layer",e}return r.__extends(e,t),e.prototype.load=function(t){var e=i.isSome(t)?t.signal:null;return this.addResolvingPromise(this._fetchService(e)),o.resolve(this)},Object.defineProperty(e.prototype,"queryTask",{get:function(){var t=this.layer,e=t.parsedUrl,r=t.dynamicDataSource,a=t.gdbVersion,n=t.spatialReference;return new p({url:null!=r?e.path+"?"+u.objectToQuery(e.query):e.path,gdbVersion:a,sourceSpatialReference:n})},enumerable:!0,configurable:!0}),e.prototype.addAttachment=function(t,e){var n=this;return this.load().then((function(){var s=t.attributes[n.layer.objectIdField],i=n.layer.parsedUrl.path+"/"+s+"/addAttachment",o=r.__assign(r.__assign({f:"json"},n.layer.parsedUrl.query),{gdbVersion:n.layer.gdbVersion}),u=n._getFormDataForAttachment(e,o);return a(i,{body:u}).then((function(t){return n._createFeatureEditResult(t.data.addAttachmentResult)})).catch((function(t){throw n._createAttachmentErrorResult(s,t)}))}))},e.prototype.updateAttachment=function(t,e,n){var s=this;return this.load().then((function(){var i=t.attributes[s.layer.objectIdField],o=s.layer.parsedUrl.path+"/"+i+"/updateAttachment",u=r.__assign(r.__assign({f:"json"},s.layer.parsedUrl.query),{gdbVersion:s.layer.gdbVersion,attachmentId:e}),d=s._getFormDataForAttachment(n,u);return a(o,{body:d}).then((function(t){return s._createFeatureEditResult(t.data.updateAttachmentResult)})).catch((function(t){throw s._createAttachmentErrorResult(i,t)}))}))},e.prototype.applyEdits=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,s,i,o,u,d,p,h,c,_,y,f,g,b,m,v,F,w;return r.__generator(this,(function(I){switch(I.label){case 0:return[4,this.load()];case 1:I.sent(),n=t.addFeatures.map(this._serializeFeature,this),s=t.updateFeatures.map(this._serializeFeature,this),i=this._getFeatureIds(t.deleteFeatures),l.unapplyEditsZUnitScaling(n,s,this.layer.spatialReference),o=[],u=[],d=r.__spreadArrays(t.deleteAttachments),p=0,h=t.addAttachments,I.label=2;case 2:return p<h.length?(g=h[p],_=(c=o).push,[4,this._serializeAttachment(g)]):[3,5];case 3:_.apply(c,[I.sent()]),I.label=4;case 4:return p++,[3,2];case 5:y=0,f=t.updateAttachments,I.label=6;case 6:return y<f.length?(g=f[y],m=(b=u).push,[4,this._serializeAttachment(g)]):[3,9];case 7:m.apply(b,[I.sent()]),I.label=8;case 8:return y++,[3,6];case 9:return v=o.length||u.length||d.length?{adds:o,updates:u,deletes:d}:null,F={f:"json",adds:n.length?JSON.stringify(n):null,updates:s.length?JSON.stringify(s):null,deletes:i.length?i.join(","):null,gdbVersion:e&&e.gdbVersion||this.layer.gdbVersion,rollbackOnFailure:e&&e.rollbackOnFailureEnabled,useGlobalIds:e&&e.globalIdUsed,attachments:v&&JSON.stringify(v)},[4,a(this.layer.parsedUrl.path+"/applyEdits",{query:F,method:"post",responseType:"json"})];case 10:return w=I.sent(),[2,this._createEditsResult(w)]}}))}))},e.prototype.deleteAttachments=function(t,e){var n=this;return this.load().then((function(){var s=t.attributes[n.layer.objectIdField],i=n.layer.parsedUrl.path+"/"+s+"/deleteAttachments";return a(i,{query:r.__assign(r.__assign({f:"json"},n.layer.parsedUrl.query),{gdbVersion:n.layer.gdbVersion,attachmentIds:e.join(",")}),method:"post",responseType:"json"}).then((function(t){return t.data.deleteAttachmentResults.map(n._createFeatureEditResult)})).catch((function(t){throw n._createAttachmentErrorResult(s,t)}))}))},e.prototype.queryAttachments=function(t,e){var n=this;void 0===e&&(e={});var s=this.layer.parsedUrl,i=s.path;return this.load().then((function(){var u=r.__assign(r.__assign({},e),{query:r.__assign(r.__assign({},s.query),{gdbVersion:n.layer.gdbVersion,f:"json"}),responseType:"json"});if(!n.layer.get("capabilities.operations.supportsQueryAttachments")){for(var d=t.objectIds,p=[],l=0,c=d;l<c.length;l++){var _=c[l],y=i+"/"+_+"/attachments";p.push(a(y,u))}return o.all(p).then((function(t){return d.map((function(e,r){return{parentObjectId:e,attachmentInfos:t[r].data.attachmentInfos}}))})).then((function(t){return h.processAttachmentQueryResult(t,i)}))}return n.queryTask.executeAttachmentQuery(t,u)}))},e.prototype.queryFeatures=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.execute(t,e)}))},e.prototype.queryFeaturesJSON=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.executeJSON(t,e)}))},e.prototype.queryObjectIds=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.executeForIds(t,e)}))},e.prototype.queryFeatureCount=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.executeForCount(t,e)}))},e.prototype.queryExtent=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.executeForExtent(t,e)}))},e.prototype.queryRelatedFeatures=function(t,e){var r=this;return this.load().then((function(){return r.queryTask.executeRelationshipQuery(t,e)}))},e.prototype._fetchService=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(s){switch(s.label){case 0:return(e=this.layer.sourceJSON)?(this.sourceJSON=e,[2]):[4,a(this.layer.parsedUrl.path,{query:r.__assign({f:"json"},this.layer.parsedUrl.query),responseType:"json",signal:t})];case 1:return n=s.sent().data,this.sourceJSON=n,[2]}}))}))},e.prototype._serializeFeature=function(t){var e=t.geometry,r=t.attributes;return i.isNone(e)?{attributes:r}:"mesh"===e.type||"extent"===e.type?null:{geometry:e.toJSON(),attributes:r}},e.prototype._serializeAttachment=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,a,n,s,i,o,u,d,p;return r.__generator(this,(function(r){switch(r.label){case 0:return e=t.feature,a=t.attachment,n=a.globalId,s=a.name,i=a.contentType,o=a.data,u=a.uploadId,d={globalId:n,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null},e&&(d.parentGlobalId="attributes"in e?e.attributes&&e.attributes[this.layer.globalIdField]:e.globalId),u?(d.uploadId=u,[3,3]):[3,1];case 1:return o?[4,c(o)]:[3,3];case 2:p=r.sent(),d.contentType=p.mediaType,d.data=p.data,o instanceof File&&(d.name=o.name),r.label=3;case 3:return s&&(d.name=s),i&&(d.contentType=i),[2,d]}}))}))},e.prototype._getFeatureIds=function(t){var e=t[0];return e?"objectId"in e?this._getIdsFromFeatureIdentifier(t):this._getIdsFromFeatures(t):[]},e.prototype._getIdsFromFeatures=function(t){var e=this.layer.objectIdField;return t.map((function(t){return t.attributes&&t.attributes[e]}))},e.prototype._getIdsFromFeatureIdentifier=function(t){return t.map((function(t){return t.objectId}))},e.prototype._createEditsResult=function(t){var e=t.data,r=t.data&&t.data.attachments;return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}},e.prototype._createFeatureEditResult=function(t){var e=!0===t.success?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:e?new n("feature-layer-source:edit-failure",e.description,{code:e.code}):null}},e.prototype._createAttachmentErrorResult=function(t,e){var r=e.details.messages&&e.details.messages[0]||e.message,a=e.details.httpStatus||e.details.messageCode;return{objectId:t,globalId:null,error:new n("feature-layer-source:attachment-failure",r,{code:a})}},e.prototype._getFormDataForAttachment=function(t,e){var r=t instanceof FormData?t:t&&t.elements?new FormData(t):null;if(r)for(var a in e){var n=e[a];null!=n&&(r.set?r.set(a,n):r.append(a,n))}return r},r.__decorate([d.property()],e.prototype,"type",void 0),r.__decorate([d.property({constructOnly:!0})],e.prototype,"layer",void 0),r.__decorate([d.property({readOnly:!0,dependsOn:["layer.parsedUrl","layer.gdbVersion","layer.dynamicDataSource"]})],e.prototype,"queryTask",null),r.__decorate([d.subclass("esri.layers.graphics.sources.FeatureLayerSource")],e)}(s);e.default=_}.apply(null,a))||(t.exports=n)},268:function(t,e,r){var a,n;a=[r.dj.c(t.i),e,r(164),r(230)],void 0===(n=function(t,e,r,a){var n=r("esri-text-decoder")?new TextDecoder("utf-8"):null,s=r("safari")||r("ios")?6:r("ff")?12:32;return function(){function t(t,e,r,a){void 0===r&&(r=0),void 0===a&&(a=t?t.byteLength:0),this._tag=0,this._dataType=99,this.init(t,e,r,a)}return t.prototype.init=function(t,e,r,a){this._data=t,this._dataView=e,this._pos=r,this._end=a},t.prototype.clone=function(){return new t(this._data,this._dataView,this._pos,this._end)},t.prototype.pos=function(){return this._pos},t.prototype.next=function(t){for(;;){if(this._pos===this._end)return!1;var e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0},t.prototype.empty=function(){return this._pos>=this._end},t.prototype.tag=function(){return this._tag},t.prototype.getInt32=function(){return this._decodeVarint()},t.prototype.getInt64=function(){return this._decodeVarint()},t.prototype.getUInt32=function(){var t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))},t.prototype.getUInt64=function(){return this._decodeVarint()},t.prototype.getSInt32=function(){var t=this.getUInt32();return t>>>1^-(1&t)|0},t.prototype.getSInt64=function(){return this._decodeSVarint()},t.prototype.getBool=function(){var t=0!==this._data[this._pos];return this._skip(1),t},t.prototype.getEnum=function(){return this._decodeVarint()},t.prototype.getFixed64=function(){var t=this._dataView,e=this._pos,r=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),r},t.prototype.getSFixed64=function(){var t=this._dataView,e=this._pos,r=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),r},t.prototype.getDouble=function(){var t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t},t.prototype.getFixed32=function(){var t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t},t.prototype.getSFixed32=function(){var t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t},t.prototype.getFloat=function(){var t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t},t.prototype.getString=function(){var t=this._getLength(),e=this._pos,r=this._toString(this._data,e,e+t);return this._skip(t),r},t.prototype.getBytes=function(){var t=this._getLength(),e=this._pos,r=this._toBytes(this._data,e,e+t);return this._skip(t),r},t.prototype.processMessageWithArgs=function(t,e,r,a){var n=this.getMessage(),s=t(n,e,r,a);return n.release(),s},t.prototype.processMessage=function(t){var e=this.getMessage(),r=t(e);return e.release(),r},t.prototype.getMessage=function(){var e=this._getLength(),r=t.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),r},t.prototype.release=function(){t.pool.release(this)},t.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},t.prototype._skip=function(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t},t.prototype._decodeVarint=function(){var t,e=this._data,r=this._pos,a=0;if(this._end-r>=10)do{if(a|=127&(t=e[r++]),0==(128&t))break;if(a|=(127&(t=e[r++]))<<7,0==(128&t))break;if(a|=(127&(t=e[r++]))<<14,0==(128&t))break;if(a|=(127&(t=e[r++]))<<21,0==(128&t))break;if(a+=268435456*(127&(t=e[r++])),0==(128&t))break;if(a+=34359738368*(127&(t=e[r++])),0==(128&t))break;if(a+=4398046511104*(127&(t=e[r++])),0==(128&t))break;if(a+=562949953421312*(127&(t=e[r++])),0==(128&t))break;if(a+=72057594037927940*(127&(t=e[r++])),0==(128&t))break;if(a+=0x8000000000000000*(127&(t=e[r++])),0==(128&t))break;throw new Error("Varint too long!")}while(0);else{for(var n=1;r!==this._end&&0!=(128&(t=e[r]));)++r,a+=(127&t)*n,n*=128;if(r===this._end)throw new Error("Varint overrun!");++r,a+=t*n}return this._pos=r,a},t.prototype._decodeSVarint=function(){var t=this._decodeVarint();return t%2?-(t+1)/2:t/2},t.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},t.prototype._toString=function(t,e,r){if((r=Math.min(this._end,r))-e>s&&n){var a=t.subarray(e,r);return n.decode(a)}for(var i="",o="",u=e;u<r;++u){var d=t[u];128&d?o+="%"+d.toString(16):(i+=decodeURIComponent(o)+String.fromCharCode(d),o="")}return o.length&&(i+=decodeURIComponent(o)),i},t.prototype._toBytes=function(t,e,r){return r=Math.min(this._end,r),new Uint8Array(t.buffer,e,r-e)},t.pool=new a(t,null,(function(t){t._data=null,t._dataView=null})),t}()}.apply(null,a))||(t.exports=n)}}]);
//# sourceMappingURL=130.js.map