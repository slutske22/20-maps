(function(){var e={"esri/views/layers/support/ClipArea":176,"esri/tasks/support/FeatureSet":187,"esri/views/layers/support/ClipRect":209,"esri/views/2d/layers/LayerView2D":219,"esri/views/layers/support/Geometry":220,"esri/views/layers/support/Path":221,"esri/geometry/support/normalizeUtils":234,"esri/tasks/geometry/cut":279,"esri/tasks/geometry/simplify":280,"esri/geometry/projection":291,"esri/widgets/Legend":300,"esri/geometry/pe":310,"esri/geometry/support/GeographicTransformation":311,"esri/geometry/support/GeographicTransformationStep":312,"esri/layers/support/RasterFunction":313,"esri/tasks/operations/urlUtils":314,"esri/tasks/operations/pbfQueryUtils":328,"esri/tasks/operations/pbfFeatureServiceParser":329,"esri/tasks/operations/pbfDehydratedFeatureSet":330,"esri/tasks/operations/pbfOptimizedFeatureSet":331,"esri/tasks/operations/query":348,"esri/core/colorUtils":360,"esri/layers/support/ExportImageParameters":378,"esri/symbols/support/svgUtils":396,"esri/widgets/Legend/support/utils":397,"esri/layers/WebTileLayer":398,"esri/rasterRenderers":399,"esri/layers/support/MosaicRule":400,"esri/layers/support/DimensionalDefinition":421,"esri/layers/support/imageryRendererUtils":422,"esri/layers/support/RasterInfo":423,"esri/layers/ImageryLayer":460,"esri/renderers/support/colorRampUtils":461,"esri/layers/support/rasterFormats/Zlib":462,"esri/tasks/QueryTask":463,"esri/symbols/support/previewUtils":501,"esri/symbols/support/renderUtils":502,"esri/symbols/support/previewSymbol3D":503,"esri/widgets/Legend/styles/support/utils":504,"esri/widgets/Legend/support/styleUtils":505,"esri/layers/support/WMTSLayerInfo":507,"esri/layers/MapImageLayer":508,"esri/renderers/support/stretchRendererUtils":549,"esri/layers/support/RasterJobHandler":550,"esri/layers/support/rasterFormats/RasterCodec":603,"esri/renderers/support/RasterSymbolizer":604,"esri/views/2d/layers/BaseLayerView2D":669,"esri/views/2d/layers/support/Display":675,"esri/widgets/Legend/LegendViewModel":676,"esri/widgets/Legend/support/ActiveLayerInfo":677,"esri/symbols/support/symbolUtils":678,"esri/symbols/support/previewCIMSymbol":679,"esri/symbols/support/previewSymbol2D":680,"esri/symbols/support/previewWebStyleSymbol":681,"esri/widgets/Legend/support/clusterUtils":682,"esri/widgets/Legend/support/colorRampUtils":683,"esri/widgets/Legend/support/heatmapRampUtils":684,"esri/widgets/Legend/support/relationshipRampUtils":685,"esri/widgets/Legend/support/sizeRampUtils":686,"esri/widgets/Legend/styles/Card":687,"esri/widgets/Legend/styles/Classic":688,"esri/layers/mixins/ArcGISImageService":689,"esri/layers/support/ExportImageServiceParameters":690,"esri/layers/support/rasterFormats/Jpg":691,"esri/layers/support/rasterFormats/LercCodec":692,"esri/tasks/ImageServiceIdentifyTask":693,"esri/tasks/support/ImageServiceIdentifyResult":694,"esri/layers/support/AttachmentInfo":695,"esri/tasks/support/ImageServiceIdentifyParameters":696,"esri/layers/support/rasterFormats/TiffDecoder":826,"esri/layers/support/rasterDatasets/byteStreamUtils":827,"esri/layers/support/rasterFormats/TiffTags":828,"esri/tasks/operations/queryAttachments":829,"esri/renderers/RasterColormapRenderer":979,"esri/renderers/support/ColormapInfo":980,"esri/renderers/RasterShadedReliefRenderer":981,"esri/renderers/RasterStretchRenderer":982,"esri/layers/support/rasterFormats/ImageCanvasDecoder":983,"esri/layers/support/rasterFormats/JpgPlus":984,"esri/layers/support/rasterFormats/Lerc2Codec":985,"esri/layers/support/rasterFormats/Png":986,"esri/layers/support/rasterFormats/Raw":987,"esri/layers/support/rasterFunctions/surfaceUtils":988,"esri/layers/support/exifUtils":989,"esri/tasks/operations/queryRelatedRecords":990},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[34,6,9,14,32,64,134,188],{176:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(151)],void 0===(i=function(e,t,r,n,i){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),r.__decorate([i.subclass("esri.views.layers.support.ClipArea")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},181:function(e,t,r){"use strict";r.r(t);var n=r(10),i=r.n(n)()(!0);i.push([e.i,".esri-scroll-zoom-toggle{padding:0.7em 1.5em}.esri-scroll-zoom-toggle--inner-wrapper{display:flex;flex-direction:row;align-items:center;cursor:pointer}.esri-scroll-zoom-toggle--input-checkbox{margin-left:1em;margin-bottom:6px;cursor:pointer}\n","",{version:3,sources:["webpack://src/components/mapcomponents/ScrollZoom.scss"],names:[],mappings:"AAAA,yBACC,mBAAoB,CACpB,wCAGA,YAAa,CACb,kBAAmB,CACnB,kBAAmB,CACnB,cAAe,CACf,yCAGA,eAAgB,CAChB,iBAAkB,CAClB,cAAe",sourcesContent:[".esri-scroll-zoom-toggle {\n\tpadding: 0.7em 1.5em;\n}\n\n.esri-scroll-zoom-toggle--inner-wrapper {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tcursor: pointer;\n}\n\n.esri-scroll-zoom-toggle--input-checkbox {\n\tmargin-left: 1em;\n\tmargin-bottom: 6px;\n\tcursor: pointer;\n}\n"],sourceRoot:""}]),t.default=i},187:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(174),r(166),r(155),r(152),r(151),r(170),r(163),r(194)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){var d=new o.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),f=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return r.__extends(t,e),t.prototype.readFeatures=function(e,t){for(var r=u.fromJSON(t.spatialReference),n=[],o=0;o<e.length;o++){var a=e[o],l=i.fromJSON(a),p=a.geometry&&a.geometry.spatialReference;s.isSome(l.geometry)&&!p&&(l.geometry.spatialReference=r),n.push(l)}return n},t.prototype.writeGeometryType=function(e,t,r,n){if(e)d.write(e,t,r,n);else{var i=this.features;if(i)for(var o=0,a=i;o<a.length;o++){var l=a[o];if(l&&s.isSome(l.geometry))return void d.write(l.geometry.type,t,r,n)}}},t.prototype.writeSpatialReference=function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r)for(var n=0,i=r;n<i.length;n++){var o=i[n];o&&s.isSome(o.geometry)&&o.geometry.spatialReference&&(t.spatialReference=o.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var i=e&&e[r];n.geometry=i&&i.toJSON()||n.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],n=t[1],i=e.translate,o=i[0],a=i[1],l=this.features,u=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/r)}),(function(e){return Math.round((a-e)/n)})),p=0,c=l.length;p<c;p++)u(s.unwrap(l[p].geometry))||(l.splice(p,1),p--,c--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this.geometryType,t=this.features,r=this.transform;if(!r)return this;for(var n=r.translate,i=n[0],o=n[1],a=r.scale,l=a[0],u=a[1],p=this._getHydrationFunction(e,(function(e){return e*l+i}),(function(e){return o-e*u})),c=0,d=t;c<d.length;c++){var f=d[c].geometry;s.isSome(f)&&p(f)}return this},t.prototype._quantizePoints=function(e,t,r){for(var n,i,o=[],a=0,s=e.length;a<s;a++){var l=e[a];if(a>0){var u=t(l[0]),p=r(l[1]);u===n&&p===i||(o.push([u-n,p-i]),n=u,i=p)}else n=t(l[0]),i=r(l[1]),o.push([n,i])}return o.length>0?o:null},t.prototype._getQuantizationFunction=function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var i=p.isPolygon(e)?e.rings:e.paths,o=[],a=0,s=i.length;a<s;a++){var l=i[a],u=n._quantizePoints(l,t,r);u&&o.push(u)}return o.length>0?(p.isPolygon(e)?e.rings=o:e.paths=o,e):null}:"multipoint"===e?function(e){var i;return(i=n._quantizePoints(e.points,t,r)).length>0?(e.points=i,e):null}:"extent"===e?function(e){return e}:null},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var n,i,o=p.isPolygon(e)?e.rings:e.paths,a=0,s=o.length;a<s;a++)for(var l=o[a],u=0,c=l.length;u<c;u++){var d=l[u];u>0?(n+=d[0],i+=d[1]):(n=d[0],i=d[1]),d[0]=t(n),d[1]=r(i)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var n,i,o=e.points,a=0,s=o.length;a<s;a++){var l=o[a];a>0?(n+=l[0],i+=l[1]):(n=l[0],i=l[1]),l[0]=t(n),l[1]=r(i)}}:void 0},r.__decorate([l.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r.__decorate([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r.__decorate([l.property({type:[i],json:{write:!0}})],t.prototype,"features",void 0),r.__decorate([l.reader("features")],t.prototype,"readFeatures",null),r.__decorate([l.property({type:[c],json:{write:!0}})],t.prototype,"fields",void 0),r.__decorate([l.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:d.read}}})],t.prototype,"geometryType",void 0),r.__decorate([l.writer("geometryType")],t.prototype,"writeGeometryType",null),r.__decorate([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r.__decorate([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r.__decorate([l.property({types:n.geometryTypes,json:{read:p.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r.__decorate([l.property({type:u,json:{write:!0}})],t.prototype,"spatialReference",void 0),r.__decorate([l.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r.__decorate([l.property({json:{write:!0}})],t.prototype,"transform",void 0),r.__decorate([l.subclass("esri.tasks.support.FeatureSet")],t)}(a.JSONSupport);return f.prototype.toJSON.isDefaultToJSON=!0,f||(f={}),f}.apply(null,n))||(e.exports=i)},209:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(151),r(176)],void 0===(i=function(e,t,r,n,i){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="rect",t.left=null,t.right=null,t.top=null,t.bottom=null,t}var i;return r.__extends(t,e),i=t,t.prototype.clone=function(){return new i({left:this.left,right:this.right,top:this.top,bottom:this.bottom})},Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r.__decorate([n.property({type:[Number,String],json:{write:!0}})],t.prototype,"left",void 0),r.__decorate([n.property({type:[Number,String],json:{write:!0}})],t.prototype,"right",void 0),r.__decorate([n.property({type:[Number,String],json:{write:!0}})],t.prototype,"top",void 0),r.__decorate([n.property({type:[Number,String],json:{write:!0}})],t.prototype,"bottom",void 0),r.__decorate([n.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],t.prototype,"version",null),i=r.__decorate([n.subclass("esri.views.layers.support.ClipRect")],t)}(i)}.apply(null,n))||(e.exports=i)},212:function(e,t,r){var n=r(99),i=r(181);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1},a=n(i,o);if(!i.locals||e.hot.invalidate){var s=i.locals;e.hot.accept(181,(function(){"string"==typeof(i=(i=r(181)).__esModule?i.default:i)&&(i=[[e.i,i,""]]),function(e,t,r){if(!e&&t||e&&!t)return!1;var n;for(n in e)if((!r||"default"!==n)&&e[n]!==t[n])return!1;for(n in t)if(!(r&&"default"===n||e[n]))return!1;return!0}(s,i.locals)?(s=i.locals,a(i)):e.hot.invalidate()}))}e.hot.dispose((function(){a()})),e.exports=i.locals||{}},213:function(e,t,r){"use strict";var n=r(2),i=r.n(n),o=r(3),a=r(108),s=r.n(a),l=r(6),u=r(5),p=r(284),c=r.n(p),d=r(275),f=r.n(d),h=r(266),y=r.n(h),m=r(287),g=r.n(m),v=r(278),_=r.n(v),b=r(157),w=r(188),S=r.n(w),x=r(151),I=r(183);r(212);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var T,C,P,L=(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),k=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":R(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},M="esri-widget esri-scroll-zoom-toggle",O="esri-scroll-zoom-toggle--inner-wrapper",E="esri-scroll-zoom-toggle--input-checkbox",A=function(e){function t(t){var r=e.call(this,t)||this;return r.enabled=!1,r._toggleZoomOnScroll=function(){r.enabled=!r.enabled,r.enabled?(r.view.navigation.mouseWheelZoomEnabled=!0,r.view.navigation.browserTouchPanEnabled=!0):(r.view.navigation.mouseWheelZoomEnabled=!1,r.view.navigation.browserTouchPanEnabled=!1)},r}return L(t,e),t.prototype.render=function(){return Object(I.tsx)("div",{class:M},Object(I.tsx)("div",{class:O,onclick:this._toggleZoomOnScroll},Object(I.tsx)("div",null,"Enable Scroll Zoom"),Object(I.tsx)("input",{type:"checkbox",class:E,checked:this.enabled})))},k([Object(x.property)(),Object(I.renderable)()],t.prototype,"enabled",void 0),t=k([Object(x.subclass)("esri.widgets.ScrollZoom")],t)}(S.a),D=function(){return(D=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},N=function(e){var t=e.metadata,r=e.sources,o=e.customFeatures,a=e.customFeaturesPerPage,s=e.customMapDOM,l=e.pageRefs,p=e.currentPage,d=e.mapState,h=d.basemap,m=d.layers,v=d.position,w=d.customBehavior,S=Object(n.useRef)(null),x=Object(n.useState)(null),I=x[0],R=x[1],T=Object(n.useState)(!0),C=T[0],P=T[1],L=Object(n.useState)(null),k=L[0],M=L[1];return Object(n.useEffect)((function(){var e=new f.a({basemap:h||null,layers:m}),n=D(D({container:S.current,map:e},v),{navigation:{mouseWheelZoomEnabled:!1,browserTouchPanEnabled:!1}}),a=t.sceneview?new g.a(n):new y.a(n);(R({map:e,view:a}),t.fullWidthMap&&!t.sceneview)&&(document.querySelector("#"+t.name+" .esri-ui-top-left").style.left="calc(30% - 10px)");if(t.fullWidthMap&&t.sceneview){var s=document.querySelector("#"+t.name+' div[class^="SideCar"]');s.style.left="40px",s.style.width="500px",s.style.transition="all 0.5s";var l=new _.a({view:a,expandIconClass:"esri-icon-question",expandTooltip:"Information",expanded:!0});a.ui.add([{component:l,position:"top-left",index:0}]),l.container.addEventListener("click",(function(){l.expanded?(s.style.left="40px",s.style.opacity="1",s.style.pointerEvents="auto",s.style.transition="all 0.5s"):(s.style.left="35px",s.style.opacity="0",s.style.pointerEvents="none",s.style.transition="none")}));var p=new A({view:a});a.ui.add(p,"top-right")}document.createElement("div").innerHTML="Data sources here";var d=new _.a({view:a,expandIconClass:"clipboard-icon",expandTooltip:"Data Sources",collapseTooltip:"Close",content:c.a.renderToStaticMarkup(i.a.createElement(u.a,{sources:r,theme:t.theme}))});a.ui.add(d,"bottom-right"),t.disableSpinnerAfterInitialLoad?b.whenTrueOnce(a,"updating",(function(){P(!0)})):b.whenTrue(a,"updating",(function(){P(!0)})),b.whenFalse(a,"updating",(function(){P(!1)})),o&&o({map:e,view:a,layers:m})}),[]),Object(n.useEffect)((function(){I&&(I.map.layers=m)}),[m]),Object(n.useEffect)((function(){I&&(I.map.basemap=h)}),[h,I]),Object(n.useEffect)((function(){I&&v&&I.view.goTo({target:v.center,zoom:v.zoom},{duration:1e3})}),[v]),Object(n.useEffect)((function(){if(I)if(w){var e=I.map,t=I.view;k&&k();var r=w({map:e,view:t});M((function(){return r}))}else k&&k()}),[w,I]),Object(n.useEffect)((function(){if(I&&a){var e=I.view,t=I.map,r=a({map:t,view:e,layers:m,pageRefs:l,currentPage:p});if(r)return r}}),[I,p,a]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"arcgis-map "+t.name,ref:S}),s&&I&&s(I),C&&i.a.createElement(u.c,null))},F=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},j=o.b.section.withConfig({displayName:"ChapterTemplate__Wrapper",componentId:"sc-1cxnsi8-0"})(C||(C=F(["\n\twidth: 100%;\n\theight: ",";\n\tmin-height: 500px;\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: row;\n\tbackground-color: ",";\n\t/* scroll-snap-stop: always;\n\tscroll-snap-align: start; */\n"],["\n\twidth: 100%;\n\theight: ",";\n\tmin-height: 500px;\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: row;\n\tbackground-color: ",";\n\t/* scroll-snap-stop: always;\n\tscroll-snap-align: start; */\n"])),(function(e){return e.height||100*e.screensTall+"vh"||"auto"}),(function(e){return"light"===e.maptheme?"":"#242424"})),V=o.b.div.withConfig({displayName:"ChapterTemplate__Trigger",componentId:"sc-1cxnsi8-1"})(P||(P=F(["\n\tposition: absolute;\n\ttop: 0px;\n\tleft: 0px;\n\theight: 3px;\n\twidth: 3px;\n\tpointer-events: none;\n"],["\n\tposition: absolute;\n\ttop: 0px;\n\tleft: 0px;\n\theight: 3px;\n\twidth: 3px;\n\tpointer-events: none;\n"])));t.a=function(e){e.customMap;var t=e.data,r=t.metadata,o=t.sources,a=t.customFeatures,p=t.customFeaturesPerPage,c=t.customMapDOM,d=t.customChapterDOM,f=t.pages,h=Object(n.useState)(0),y=h[0],m=h[1],g=Object(n.useContext)(l.a).dispatch,v={};return Object(n.useMemo)((function(){return i.a.createElement(j,{maptheme:r.theme,id:r.name,screensTall:f.length>1?f.length:1},i.a.createElement(u.i,{floating:r.fullWidthMap},f.map((function(e,t){return i.a.createElement(u.d,{floating:r.fullWidthMap,ref:function(e){return v[t]=e},key:r.name+"-page-"+t},i.a.createElement(u.e,{theme:r.theme,floating:r.fullWidthMap},i.a.createElement(u.g,null,e.title),i.a.createElement(u.f,{floating:r.fullWidthMap},e.content)),i.a.createElement(s.a,{onChange:function(e){e&&(g({type:"SET_NAV",payload:r.name}),m(t))}},(function(e){e.isVisible;return i.a.createElement(V,null)})))}))),i.a.createElement(s.a,{partialVisibility:!0},(function(e){var t=e.isVisible;return i.a.createElement(u.b,{fullWidth:r.fullWidthMap,className:"arcgis-map-"+r.theme},t&&i.a.createElement(N,{mapState:f[y].mapState,customFeatures:a,customFeaturesPerPage:p,customMapDOM:c,metadata:r,sources:o,pageRefs:v,currentPage:y}))})),d&&d)}),[y])}},219:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(169),r(254),r(157),r(151),r(186),r(176),r(209),r(220),r(221)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){Object.defineProperty(t,"__esModule",{value:!0});var d=n.ofType({key:"type",base:l,typeMap:{rect:u,path:c,geometry:p}});t.LayerView2DMixin=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clips=new d,t.moving=!1,t.attached=!1,t.lastUpdateId=-1,t.updateRequested=!1,t}return r.__extends(t,e),t.prototype.initialize=function(){var e,t=this;this.container||(this.container=new s.Container),this.handles.add([o.init(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),o.init(this,["layer.opacity","container"],(function(){var e,r;t.container&&(t.container.opacity=null!==(r=null===(e=t.layer)||void 0===e?void 0:e.opacity)&&void 0!==r?r:1)}),!0),o.init(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),this.container.clips=this.clips,(null===(e=this.view)||void 0===e?void 0:e.whenLayerView)?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))},t.prototype.destroy=function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null,this.view=null},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,r=this.layer,n=r.minScale,i=r.maxScale;if(null!=n&&null!=i){var o=!n,a=!i;!o&&e<=n&&(o=!0),!a&&e>=i&&(a=!0),t=o&&a}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){return!!e.prototype.canResume.call(this)&&this.isVisibleAtScale(this.view.scale)},r.__decorate([a.property({type:d,set:function(e){var t=i.referenceSetter(e,this._get("clips"),d);this._set("clips",t)}})],t.prototype,"clips",void 0),r.__decorate([a.property()],t.prototype,"moving",void 0),r.__decorate([a.property()],t.prototype,"attached",void 0),r.__decorate([a.property()],t.prototype,"container",void 0),r.__decorate([a.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),r.__decorate([a.property({readOnly:!0})],t.prototype,"updateParameters",void 0),r.__decorate([a.property()],t.prototype,"updateRequested",void 0),r.__decorate([a.property({dependsOn:["attached","updateRequested","suspended"]})],t.prototype,"updating",null),r.__decorate([a.property()],t.prototype,"view",void 0),r.__decorate([a.subclass("esri.views.2d.layers.LayerView2D")],t)}(e)}}.apply(null,n))||(e.exports=i)},220:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(151),r(215),r(163),r(176)],void 0===(i=function(e,t,r,n,i,o,a,s){var l={base:o,key:"type",typeMap:{extent:n.Extent,polygon:n.Polygon}};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="geometry",t.geometry=null,t}var n;return r.__extends(t,e),n=t,Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new n({geometry:this.geometry.clone()})},r.__decorate([i.property({types:l,json:{read:a.fromJSON,write:!0}})],t.prototype,"geometry",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["geometry"]})],t.prototype,"version",null),n=r.__decorate([i.subclass("esri.views.layers.support.Geometry")],t)}(s)}.apply(null,n))||(e.exports=i)},221:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(151),r(176)],void 0===(i=function(e,t,r,n,i){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="path",t.path=[],t}return r.__extends(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r.__decorate([n.property({type:[[[Number]]],json:{write:!0}})],t.prototype,"path",void 0),r.__decorate([n.property({readOnly:!0,dependsOn:["path"]})],t.prototype,"version",null),r.__decorate([n.subclass("esri.views.layers.support.Path")],t)}(i)}.apply(null,n))||(e.exports=i)},2294:function(e,t,r){"use strict";r.r(t);var n=r(2),i=r.n(n),o=r(300),a=r.n(o),s=r(5),l=r(208),u=r.n(l),p=r(222),c=r.n(p),d=r(398),f=r.n(d),h=r(508),y=r.n(h),m=r(460),g=r.n(m),v=r(237),_=r.n(v),b=r(668),w={type:"simple",symbol:{type:"simple-marker",color:"rgba(238,255,14,1)",size:"3px",outline:{color:"transparent",width:0}},visualVariables:[{type:"color",field:"ACQ_DATE",stops:[{value:new Date("2020-07-24").getTime(),color:"rgba(114,66,0,0.6)"},{value:new Date("2020-08-05").getTime(),color:"rgba(238,255,14,1)"},{value:new Date("2020-08-15").getTime(),color:"rgba(248,165,49,1)"},{value:new Date("2020-09-5").getTime(),color:"rgba(207,0,0,1)"}]}]},S=new f.a({urlTemplate:"https://stamen-tiles-{subDomain}.a.ssl.fastly.net/terrain-background/{level}/{col}/{row}{r}.png",subDomains:["a","b","c","d"]}),x=new c.a({url:"https://services7.arcgis.com/WSiUmUhlFx4CtMBB/arcgis/rest/services/FIRMS_Active_Fire_Points_for_the_California_Fires_2020/FeatureServer",renderer:w}),I=(new g.a({url:"https://maps.disasters.nasa.gov/ags04/rest/services/ca_fires_202008/misr_2d_imagery_08242020/ImageServer"}),new y.a({url:"/proxy/https://maps.disasters.nasa.gov/ags04/rest/services/ca_fires_202008/sentinel2/MapServer?f=json",sublayers:[{id:976},{id:948},{id:925}]})),R=new c.a({url:"https://services.arcgis.com/ue9rwulIoeLEI9bj/arcgis/rest/services/US_StateBoundaries/FeatureServer/0"}),T=new(u.a.createSubclass({tileInfo:_.a.create({size:512,spatialReference:{wkid:3857}}),constructor:function(){this.color=[0,0,0,1],this.distance=2},createLayerView:function(e){if("2d"===e.type)return new b.a({view:e,layer:this})},properties:{color:{},geometry:{},distance:{}}}))({color:[255,255,255,1]}),C={metadata:{name:"wildfires_california",fullWidthMap:!1,theme:"light"},sources:[{name:"FIRMS Active Fire Points for the California Fires, 2020",url:"https://www.arcgis.com/home/item.html?id=c5da7b0c3a704141975adec5b9407da6"},{name:"ESRI World Imagery",url:"https://www.arcgis.com/home/item.html?id=10df2279f9684e4a9f6a7f08febac2a9"}],pages:[{title:"California Wildfires",content:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"Due to their inability to"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.politico.com/states/california/story/2020/08/20/trump-blames-california-for-wildfires-tells-state-you-gotta-clean-your-floors-1311059",linkTitle:"\"Trump blames California for wildfires, tells state 'you gotta clean your floors'\", White, J., Aug 20, 2020, Retrieved Dec 20, 2020 "},"rake their leaves"),", California had another devastating fire season. With over"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.nbcnews.com/news/us-news/california-exceeds-4-million-acres-burned-wildfires-2020-n1242078",linkTitle:'"California exceeds 4 million acres burned by wildfires in 2020", Stelloh, T., NBC News, Oct 4, 2020, Retrieved Dec 20, 2020'},"4 million acres")," ","burned, accounting for",i.a.createElement(s.h,{theme:"light",link:"https://fas.org/sgp/crs/misc/IF10244.pdf",linkTitle:'"Wildfire Statistics, Congressional Research Service, Dec 4, 2020 Retrieved Dec 20, 2020"'},"almost half")," ","the acres burned in the U.S. Oregon and Washington accounted for another"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.cnbc.com/2020/09/18/fires-in-california-oregon-and-washington-data-shows-blazes-getting-worse-.html",linkTitle:'"These charts show how wildfires are getting larger, more severe in the U.S.", Newburger, E., CNBC News, Sep 18, 2020, Retrieved Dec 20, 2020'},"1.2 million acres"),"."),i.a.createElement("p",null,"This map shows the areas burned in 2020 as captured by the"," ",i.a.createElement(s.h,{theme:"light",link:"https://modis.gsfc.nasa.gov",linkTitle:"modis.gsfc.nasa.gov"},"MODIS")," ","and"," ",i.a.createElement(s.h,{theme:"light",link:"https://ncc.nesdis.noaa.gov/VIIRS/",linkTitle:"ncc.nesdis.noaa.gov/VIIRS"},"VIIRS")," ","satellite imaging systems."),i.a.createElement("p",null,"For more detailed maps of each fire complex, check out"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.nytimes.com/interactive/2020/us/fires-map-tracker.html",linkTitle:'"Fire Map: California, Oregon and Washington", New York Times, Bloch, M., Oct 1, 2020, Retrieved Dec 20, 2020'},"this great article")," ","by the New York Times.")),mapState:{position:{center:[-120,37],zoom:6},basemap:"satellite",layers:[S,x,T]}},{title:"Satellite Imagery of Smoke",content:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"More widespread than the fires themselves was the resulting smoke. Air quality in the western U.S. was"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.cnn.com/2020/09/14/weather/wildfire-air-quality-trnd/index.html",linkTitle:'"The Western US has the worst air quality in the world, group says", Murphy, P., CNN News, Sep 14, 2020, Retrieved Dec 20, 2020'},"so bad")," ","that state and local governments were urging people to stay indoors."),i.a.createElement("p",null,i.a.createElement(s.h,{theme:"light",link:"https://earth.esa.int/web/guest/missions/esa-operational-eo-missions/sentinel-2",linkTitle:'"What is Sentinel-2?", European Space Agency, Retrieved Dec 20, 2020'},"Sentinel-2"),", one of the European Space Agency's land monitoring systems comprised of 2 satellites, circles the Earth every 100 minutes, taking photographs of the planet's surface. Every pass captures a 290km wide swath, offset from the previous pass, repeating every 10 days."," "),i.a.createElement("p",null,"This map shows passes from September 29, October 1, and October 3 (from left to right), capturing smoke over northern California on those days. Here, southern California does not contain Sentinel-2 imagery from the fires, but rather idealized"," ",i.a.createElement(s.h,{theme:"light",link:"https://www.arcgis.com/home/item.html?id=10df2279f9684e4a9f6a7f08febac2a9",linkTitle:'"World Imagery", ESRI Living Atlas, Retrieved Dec 20, 2020'},"terrain imagery"),". The difference highlights the magnitude of smoke that covered the state as a result of the fires."," ")),mapState:{position:{center:[-120,37],zoom:6},basemap:"satellite",layers:[I,T]}}],customFeatures:function(e){var t=e.view,r=R.createQuery();r.where="NAME = 'California'",R.queryFeatures(r).then((function(e){var r=e.features[0].geometry;console.log("geometry",r),T.geometry=r,t.goTo(r).catch((function(e){"AbortError"!=e.name&&console.error(e)}))}));var n=new a.a({view:t,layerInfos:[{layer:x}]});t.ui.add(n,"bottom-left")}},P=r(213);t.default=function(){return i.a.createElement(P.a,{data:C})}},234:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(100),r(154),r(156),r(152),r(153),r(232),r(259),r(170),r(178),r(197),r(279),r(280)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h){Object.defineProperty(t,"__esModule",{value:!0});var y=o.getLogger("esri.geometry.support.normalizeUtils"),m={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new u({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:p.WebMercator}),minus180Line:new u({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:p.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new u({paths:[[[180,-180],[180,180]]],spatialReference:p.WGS84}),minus180Line:new u({paths:[[[-180,-180],[-180,180]]],spatialReference:p.WGS84})}};function g(e){return"polygon"===e.type}function v(e){return g(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function b(e,t){for(var r=0,n=v(e);r<n.length;r++)for(var i=0,o=n[r];i<o.length;i++)o[i][0]+=t;return e}function w(e){for(var t=[],r=0,n=0,i=0;i<e.length;i++){for(var o=e[i],a=null,s=0;s<o.length;s++)a=o[s],t.push(a),0===s?n=r=a[0]:(r=Math.min(r,a[0]),n=Math.max(n,a[0]));a&&t.push([(r+n)/2,0])}return t}function S(e,t){if(!(e instanceof u||e instanceof l)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw y.error(r),new i(r)}for(var n=[],o=0,a=v(e);o<a.length;o++){var s=a[o],p=[];n.push(p),p.push([s[0][0],s[0][1]]);for(var c=0;c<s.length-1;c++){var d=s[c][0],f=s[c][1],h=s[c+1][0],m=s[c+1][1],_=Math.sqrt((h-d)*(h-d)+(m-f)*(m-f)),b=(m-f)/_,w=(h-d)/_,S=_/t;if(S>1){for(var x=1;x<=S-1;x++){var I=x*t,R=w*I+d,T=b*I+f;p.push([R,T])}var C=(_+Math.floor(S-1)*t)/2,P=w*C+d,L=b*C+f;p.push([P,L])}p.push([h,m])}}return g(e)?new l({rings:n,spatialReference:e.spatialReference}):new u({paths:n,spatialReference:e.spatialReference})}function x(e,t,r){if(t){var n=S(e,1e6);e=d.webMercatorToGeographic(n,!0)}return r&&(e=b(e,r)),e}function I(e,t,r){var n;if(Array.isArray(e))if((n=e[0])>t){var i=_(n,t);e[0]=n+i*(-2*t)}else n<r&&(i=_(n,r),e[0]=n+i*(-2*r));else(n=e.x)>t?(i=_(n,t),e=e.clone().offset(i*(-2*t),0)):n<r&&(i=_(n,r),e=e.clone().offset(i*(-2*r),0));return e}t.straightLineDensify=S,t.normalizeCentralMeridian=function e(t,i,o){return r.__awaiter(this,void 0,void 0,(function(){var p,y,g,w,S,R,T,C,P,L,k,M,O,E,A,D,N,F,j,V,U,B,G,z,J,q,H,W,Z,Y,Q,X,K,$,ee,te,re;return r.__generator(this,(function(r){switch(r.label){case 0:if(!Array.isArray(t))return[2,e([t],i)];for(p=i?i.url:n.geometryServiceUrl,L=0,k=[],M=[],O=0,E=t;O<E.length;O++)A=E[O],a.isNone(A)?M.push(A):(y||(y=A.spatialReference,g=c.getInfo(y),w=y.isWebMercator,S=m[T=w?102100:4326].maxX,R=m[T].minX,C=m[T].plus180Line,P=m[T].minus180Line),g?"mesh"===A.type?M.push(A):"point"===A.type?M.push(I(A.clone(),S,R)):"multipoint"===A.type?((D=A.clone()).points=D.points.map((function(e){return I(e,S,R)})),M.push(D)):"extent"===A.type?(F=A.clone(),N=F._normalize(!1,!1,g),M.push(N.rings?new l(N):N)):A.extent?(F=A.extent,j=_(F.xmin,R),U=0==(V=j*(2*S))?A.clone():b(A.clone(),V),F.offset(V,0),F.intersects(C)&&F.xmax!==S?(L=F.xmax>L?F.xmax:L,U=x(U,w),k.push(U),M.push("cut")):F.intersects(P)&&F.xmin!==R?(L=F.xmax*(2*S)>L?F.xmax*(2*S):L,U=x(U,w,360),k.push(U),M.push("cut")):M.push(U)):M.push(A.clone()):M.push(A));for(B=_(L,S),G=-90,z=B,J=new u;B>0;)q=360*B-180,J.addPath([[q,G],[q,-1*G]]),G*=-1,B--;return k.length>0&&z>0?[4,f.cut(p,k,J,o)]:[3,3];case 1:for(H=r.sent(),W=function(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],o=t.geometries[n],a=v(o),s=function(e){var t=a[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var a=t[i][0];n=a>n?a:n}for(var s=-360*_(n=Number(n.toFixed(9)),180),l=0;l<t.length;l++){var u=o.getPoint(e,l);o.setPoint(e,l,u.clone().offset(s,0))}return!0}))},l=0;l<a.length;l++)s(l);if(i===r){if("polygon"===e[0].type)for(var u=0,p=v(o);u<p.length;u++){var c=p[u];e[i]=e[i].addRing(c)}else if(function(e){return"polyline"===e[0].type}(e))for(var d=0,f=v(o);d<f.length;d++){var h=f[d];e[i]=e[i].addPath(h)}}else r=i,e[i]=o},i=0;i<t.cutIndexes.length;i++)n(i);return e}(k,H),Z=[],Y=[],ee=0;ee<M.length;ee++)"cut"!==(te=M[ee])?Y.push(te):(re=W.shift(),Q=t[ee],a.isSome(Q)&&"polygon"===Q.type&&Q.rings&&Q.rings.length>1&&re.rings.length>=Q.rings.length?(Z.push(re),Y.push("simplify")):Y.push(w?d.geographicToWebMercator(re):re));return Z.length?[4,h.simplify(p,Z,o)]:[2,Y];case 2:for(X=r.sent(),K=[],ee=0;ee<Y.length;ee++)"simplify"!==(te=Y[ee])?K.push(te):K.push(w?d.geographicToWebMercator(X.shift()):X.shift());return[2,K];case 3:for($=[],ee=0;ee<M.length;ee++)"cut"!==(te=M[ee])?$.push(te):(re=k.shift(),$.push(!0===w?d.geographicToWebMercator(re):re));return[2,s.resolve($)]}}))}))},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var n=e.spatialReference&&c.getInfo(e.spatialReference);if(!n)return r;var i,o=n.valid,a=o[0],s=o[1],l=2*s,u=r.width,p=r.xmin,d=r.xmax;if(p=(t=[d,p])[0],d=t[1],"extent"===e.type||0===u||u<=s||u>l||p<a||d>s)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;i=w(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;i=w(e.paths);break;case"multipoint":i=e.points}for(var f=r.clone(),h=0;h<i.length;h++){var y=i[h][0];y<0?(y+=s,d=Math.max(y,d)):(y-=s,p=Math.min(y,p))}return f.xmin=p,f.xmax=d,f.width<u?(f.xmin-=s,f.xmax-=s,f):r},t.normalizeMapX=function(e,t){var r=c.getInfo(t);if(r){var n=r.valid,i=n[0],o=n[1],a=o-i;if(e<i)for(;e<i;)e+=a;if(e>o)for(;e>o;)e-=a}return e}}.apply(null,n))||(e.exports=i)},279:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(165),r(172),r(163)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.cut=function(e,t,s,l){return r.__awaiter(this,void 0,void 0,(function(){var u,p,c,d,f,h,y;return r.__generator(this,(function(m){switch(m.label){case 0:return u="string"==typeof e?o.urlToObject(e):e,p=t[0].spatialReference,c=r.__assign(r.__assign({},l),{query:r.__assign(r.__assign({},u.query),{f:"json",sr:JSON.stringify(p),target:JSON.stringify({geometryType:a.getJsonType(t[0]),geometries:t}),cutter:JSON.stringify(s)})}),[4,i(u.path+"/cut",c)];case 1:return d=m.sent(),f=d.data,h=f.cutIndexes,y=f.geometries,[2,{cutIndexes:h,geometries:(void 0===y?[]:y).map((function(e){return n.fromJSON(e).set(p)}))}]}}))}))}}.apply(null,n))||(e.exports=i)},280:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(172),r(163)],void 0===(i=function(e,t,r,n,i,o){function a(e){return{geometryType:o.getJsonType(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function s(e,t,r){var n=o.getGeometryType(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}Object.defineProperty(t,"__esModule",{value:!0}),t.simplify=function(e,t,l){return r.__awaiter(this,void 0,void 0,(function(){var u,p,c,d;return r.__generator(this,(function(f){switch(f.label){case 0:return u="string"==typeof e?i.urlToObject(e):e,p=t[0].spatialReference,c=o.getJsonType(t[0]),d=r.__assign(r.__assign({},l),{query:r.__assign(r.__assign({},u.query),{f:"json",sr:p.wkid?p.wkid:JSON.stringify(p),geometries:JSON.stringify(a(t))})}),[4,n(u.path+"/simplify",d)];case 1:return[2,s(f.sent().data,c,p)]}}))}))}}.apply(null,n))||(e.exports=i)},291:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(153),r(310),r(311),r(161)],void 0===(i=function(e,t,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=null,s=null;t.isLoaded=function(){return!!a&&i.isLoaded()},t.isSupported=function(){return i.isSupported()};var l=null;t.load=function(){return l||(l=n.all([i.load(),new Promise((function(e,t){r.e(12).then(function(){var t=[r(381)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})),new Promise((function(e,t){r.e(140).then(function(){var t=[r(405)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))]).then((function(e){var t=e[1],r=e[2].hydratedAdapter;s=r,(a=t)._enableProjection(i)})))},t.project=function(e,t,r){return void 0===r&&(r=null),e instanceof Array?0===e.length?[]:p(s,e,e[0].spatialReference,t,r):p(s,[e],e.spatialReference,t,r)[0]};var u={};function p(e,t,r,n,i){if(void 0===i&&(i=null),null===i){var s=o.cacheKey(r,n);void 0!==u[s]?i=u[s]:(null===(i=c(r,n,null))&&(i=new o),u[s]=i)}return a._project(e,t,r,n,i)}function c(e,t,r){void 0===r&&(r=null);var n=a._getTransformation(s,e,t,r,null==r?void 0:r.spatialReference);return null!==n?o.fromGE(n):null}t.projectMany=p,t.getTransformation=c,t.getTransformations=function(e,t,r){void 0===r&&(r=null);var n=a._getTransformationBySuitability(s,e,t,r,null==r?void 0:r.spatialReference);if(null!==n){for(var i=[],l=0,u=n;l<u.length;l++){var p=u[l];i.push(o.fromGE(p))}return i}return[]}}.apply(null,n))||(e.exports=i)},300:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(167),r(157),r(151),r(573),r(188),r(676),r(687),r(688),r(183)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){return function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._handles=new n,i.activeLayerInfos=null,i.basemapLegendVisible=!1,i.groundLegendVisible=!1,i.keepCacheOnDestroy=!1,i.respectLayerVisibility=!0,i.iconClass="esri-icon-layer-list",i.label=void 0,i.layerInfos=null,i.messages=null,i.style=new p,i.view=null,i.viewModel=new l,i}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this.own(i.on(this,"activeLayerInfos","change",(function(){return e._refreshActiveLayerInfos(e.activeLayerInfos)})),i.init(this,"style",(function(t,r){r&&t!==r&&r.destroy(),t&&(t.activeLayerInfos=e.activeLayerInfos,"card"===t.type&&(t.view=e.view))})))},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null},t.prototype.castStyle=function(e){if(e instanceof u||e instanceof p)return e;if("string"==typeof e)return"card"===e?new u:new p;if(e&&"string"==typeof e.type){var t=r.__assign({},e);return delete t.type,new("card"===e.type?u:p)(t)}return new p},t.prototype.render=function(){return c.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof p?"esri-widget--panel":null)},this.style.render())},t.prototype._refreshActiveLayerInfos=function(e){var t=this;this._handles.removeAll(),e.forEach((function(e){return t._renderOnActiveLayerInfoChange(e)})),this.scheduleRender()},t.prototype._renderOnActiveLayerInfoChange=function(e){var t=this,r=i.init(e,"version",(function(){return t.scheduleRender()}));this._handles.add(r,"version_"+e.layer.uid),e.children.forEach((function(e){return t._renderOnActiveLayerInfoChange(e)}))},r.__decorate([o.aliasOf("viewModel.activeLayerInfos"),c.renderable()],t.prototype,"activeLayerInfos",void 0),r.__decorate([o.aliasOf("viewModel.basemapLegendVisible"),c.renderable()],t.prototype,"basemapLegendVisible",void 0),r.__decorate([o.aliasOf("viewModel.groundLegendVisible"),c.renderable()],t.prototype,"groundLegendVisible",void 0),r.__decorate([o.aliasOf("viewModel.keepCacheOnDestroy")],t.prototype,"keepCacheOnDestroy",void 0),r.__decorate([o.aliasOf("viewModel.respectLayerVisibility"),c.renderable()],t.prototype,"respectLayerVisibility",void 0),r.__decorate([o.property()],t.prototype,"iconClass",void 0),r.__decorate([o.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],t.prototype,"label",void 0),r.__decorate([o.aliasOf("viewModel.layerInfos"),c.renderable()],t.prototype,"layerInfos",void 0),r.__decorate([o.property(),c.renderable(),c.messageBundle("esri/widgets/Legend/t9n/Legend")],t.prototype,"messages",void 0),r.__decorate([o.property(),c.renderable()],t.prototype,"style",void 0),r.__decorate([a.cast("style")],t.prototype,"castStyle",null),r.__decorate([o.aliasOf("viewModel.view"),c.renderable()],t.prototype,"view",void 0),r.__decorate([o.property(),c.renderable(["view.size"])],t.prototype,"viewModel",void 0),r.__decorate([o.subclass("esri.widgets.Legend")],t)}(s)}.apply(null,n))||(e.exports=i)},310:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(271),r(164),r(153),r(161)],void 0===(i=function(e,t,n,i,o,a){var s,l,u,p,c,d;function f(e){function r(e,t,r){e[t]=r(e[t])}t._pe=e,l.init(),u.init(),p.init(),c.init(),d.init(),t.PeGCSExtent=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.destroy=function(){t._pe.destroy(this)},r}(t._pe.PeGCSExtent);for(var i=0,o=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];i<o.length;i++)r(o[i].prototype,"getName",(function(e){return function(){return e.call(this,new Array(l.PE_NAME_MAX))}}));for(var a=0,s=[t._pe.PeGeogtran,t._pe.PeProjcs];a<s.length;a++)r(s[a].prototype,"getParameters",(function(e){return function(){for(var r=new Array(l.PE_PARM_MAX),n=e.call(this),i=0;i<r.length;i++){var o=t._pe.getValue(n,"*");r[i]=o?t._pe.wrapPointer(o,t._pe.PeParameter):null,n+=Int32Array.BYTES_PER_ELEMENT}return r}}));r(t._pe.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return g(r,t,e.call(this)),r}})),r(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var r=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var o=this.getSteps();if(o>1)for(var a=t._pe.getPointer(i),s=1;s<o;s++)n.push(t._pe.wrapPointer(a+r*s,t._pe.PeGTlistExtendedGTs))}return n}}));var f=t._pe._pe_getPeHorizonSize(),h=function(e){return function(){var r=this._cache;if(r||(r=new Map,this._cache=r),r.has(e))return r.get(e);var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var o=i.getNump();if(o>1)for(var a=t._pe.getPointer(i),s=1;s<o;s++)n.push(t._pe.wrapPointer(a+f*s,t._pe.PeHorizon))}return r.set(e,n),n}};r(t._pe.PeProjcs.prototype,"horizonGcsGenerate",h),r(t._pe.PeProjcs.prototype,"horizonPcsGenerate",h),t._pe.PeObject.prototype.toString=function(e){void 0===e&&(e=l.PE_STR_OPTS_NONE),t._pe.ensureCache.prepare();var r=t._pe.getPointer(this),n=t._pe.ensureInt8(new Array(l.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(r,e,n))}}function h(e){if(e){var r=t._pe.getClass(e);if(r){var n=t._pe.getCache(r);if(n){var i=t._pe.getPointer(e);i&&delete n[i]}}}}function y(e,r){for(var n=[],i=new Array(r),o=0;o<e;o++)n.push(t._pe.ensureInt8(i));return n}function m(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function g(e,r,n,i){if(void 0===i&&(i=!1),i)for(var o=0;o<2*r;o++)e[o]=t._pe.getValue(n+o*Float64Array.BYTES_PER_ELEMENT,"double");else{var a=0===e.length;for(o=0;o<r;o++)a&&(e[o]=new Array(2)),e[o][0]=t._pe.getValue(n,"double"),e[o][1]=t._pe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(t,"__esModule",{value:!0}),t._pe=null,t.isLoaded=function(){return!!t._pe},t.isSupported=function(){return!!o("esri-wasm")},t.load=function(){return s||(s=a.create((function(e,t){new Promise((function(e,t){r.e(122).then(function(){var t=[r(474)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})).then((function(r){r({locateFile:function(e){return i.getAssetUrl("esri/geometry/support/"+e)},onAbort:function(e){t(new Error(e))}}).then((function(t){f(t),e()}))}))})))},function(e){function r(e,r,n){t._pe.ensureCache.prepare();var i=m(n),o=n===i,a=t._pe.ensureFloat64(i),s=t._pe._pe_geog_to_proj(t._pe.getPointer(e),r,a);return s&&g(n,r,a,o),s}function n(e,t,r){return i(e,t,r,0)}function i(e,r,n,i){t._pe.ensureCache.prepare();var o=m(n),a=n===o,s=t._pe.ensureFloat64(o),l=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),r,s,i);return l&&g(n,r,s,a),l}e.geogToProj=r,e.projGeog=function(e,t,i,o){switch(o){case l.PE_TRANSFORM_P_TO_G:return n(e,t,i);case l.PE_TRANSFORM_G_TO_P:return r(e,t,i)}return 0},e.projToGeog=n,e.projToGeogCenter=i}(t.PeCSTransformations||(t.PeCSTransformations={})),function(e){e.init=function(){e.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,e.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}}(l=t.PeDefs||(t.PeDefs={})),function(e){var r={},n={};function i(e,n){var i=null,a=r[e];if(a||(a={},r[e]=a),a.hasOwnProperty(String(n)))i=a[n];else{var s=t._pe.PeFactory.prototype.factoryByType(e,n);t._pe.compare(s,t._pe.NULL)||(i=s,a[n]=i)}return o(i)}function o(e){if(e){var r=e.getType();switch(r){case l.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case l.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case l.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:r&l.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}}return e}e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return i(l.PE_TYPE_COORDSYS,e)},e.factoryByType=i,e.fromString=function(e,r){var i=null,a=n[e];if(a||(a={},n[e]=a),a.hasOwnProperty(r))i=a[r];else{var s=t._pe.PeFactory.prototype.fromString(e,r);t._pe.compare(s,t._pe.NULL)||(i=s,a[r]=i)}return o(i)},e.geogcs=function(e){return i(l.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return i(l.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return i(l.PE_TYPE_PROJCS,e)},e.unit=function(e){return i(l.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,function(e){var r;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,r=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,n,i,o,a,s){var l=null,u=new t._pe.PeInteger(s);try{var p=t._pe.PeGTlistExtended.prototype.getGTlist(e,n,i,o,a,u);if((s=u.val)&&(l=[p],s>1))for(var c=t._pe.getPointer(p),d=1;d<s;d++)l.push(t._pe.wrapPointer(c+r*d,t._pe.PeGTlistExtendedEntry))}finally{t._pe.destroy(u)}return l}}(u=t.PeGTlistExtended||(t.PeGTlistExtended={})),function(e){e.destroy=function(e){if(e&&e.length){for(var r=0,n=e;r<n.length;r++){var i=n[r];h(i),i.getEntries().forEach((function(e){h(e);var t=e.getGeogtran();h(t),t.getParameters().forEach(h),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){h(e);var t=e.getDatum();h(t),h(t.getSpheroid()),h(e.getPrimem()),h(e.getUnit())}))}))}t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})),function(e){e.geogToGeog=function(e,r,n,i,o){t._pe.ensureCache.prepare();var a=m(n),s=n===a,l=t._pe.ensureFloat64(a),u=0;i&&(u=t._pe.ensureFloat64(i));var p=t._pe._pe_geog_to_geog(t._pe.getPointer(e),r,l,u,o);return p&&g(n,r,l,s),p}}(t.PeGTTransformations||(t.PeGTTransformations={})),function(e){function r(e,r,n,i,o,a){var s,u;switch(t._pe.ensureCache.prepare(),e){case"dd":s=t._pe._pe_geog_to_dd,u=l.PE_DD_MAX;break;case"ddm":s=t._pe._pe_geog_to_ddm,u=l.PE_DDM_MAX;break;case"dms":s=t._pe._pe_geog_to_dms,u=l.PE_DMS_MAX}var p=0;r&&(p=t._pe.getPointer(r));var c=m(i),d=t._pe.ensureFloat64(c),f=y(n,u),h=s(p,n,d,o,t._pe.ensureInt32(f));if(h)for(var g=0;g<n;g++)a[g]=t._pe.UTF8ToString(f[g]);return h}function n(e,r,n,i,o){var a;switch(t._pe.ensureCache.prepare(),e){case"dd":a=t._pe._pe_dd_to_geog;break;case"ddm":a=t._pe._pe_ddm_to_geog;break;case"dms":a=t._pe._pe_dms_to_geog}var s=0;r&&(s=t._pe.getPointer(r));var l=i.map((function(e){return t._pe.ensureString(e)})),u=t._pe.ensureInt32(l),p=t._pe.ensureFloat64(new Array(2*n)),c=a(s,n,u,p);return c&&g(o,n,p),c}e.geog_to_dms=function(e,t,n,i,o){return r("dms",e,t,n,i,o)},e.dms_to_geog=function(e,t,r,i){return n("dms",e,t,r,i)},e.geog_to_ddm=function(e,t,n,i,o){return r("ddm",e,t,n,i,o)},e.ddm_to_geog=function(e,t,r,i){return n("ddm",e,t,r,i)},e.geog_to_dd=function(e,t,n,i,o){return r("dd",e,t,n,i,o)},e.dd_to_geog=function(e,t,r,i){return n("dd",e,t,r,i)}}(t.PeNotationDms||(t.PeNotationDms={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,r,n,i,o,a,s){t._pe.ensureCache.prepare();var u=0;e&&(u=t._pe.getPointer(e));var p=m(n),c=t._pe.ensureFloat64(p),d=y(r,l.PE_MGRS_MAX),f=t._pe.ensureInt32(d),h=t._pe._pe_geog_to_mgrs_extended(u,r,c,i,o,a,f);if(h)for(var g=0;g<r;g++)s[g]=t._pe.UTF8ToString(d[g]);return h},e.mgrs_to_geog_extended=function(e,r,n,i,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=n.map((function(e){return t._pe.ensureString(e)})),l=t._pe.ensureInt32(s),u=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_mgrs_to_geog_extended(a,r,l,i,u);return p&&g(o,r,u),p}}(p=t.PeNotationMgrs||(t.PeNotationMgrs={})),function(e){e.geog_to_usng=function(e,r,n,i,o,a,s){t._pe.ensureCache.prepare();var u=0;e&&(u=t._pe.getPointer(e));var p=m(n),c=t._pe.ensureFloat64(p),d=y(r,l.PE_MGRS_MAX),f=t._pe.ensureInt32(d),h=t._pe._pe_geog_to_usng(u,r,c,i,o,a,f);if(h)for(var g=0;g<r;g++)s[g]=t._pe.UTF8ToString(d[g]);return h},e.usng_to_geog=function(e,r,n,i){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var a=n.map((function(e){return t._pe.ensureString(e)})),s=t._pe.ensureInt32(a),l=t._pe.ensureFloat64(new Array(2*r)),u=t._pe._pe_usng_to_geog(o,r,s,l);return u&&g(i,r,l),u}}(t.PeNotationUsng||(t.PeNotationUsng={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,r,n,i,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=m(n),u=t._pe.ensureFloat64(s),p=y(r,l.PE_UTM_MAX),c=t._pe.ensureInt32(p),d=t._pe._pe_geog_to_utm(a,r,u,i,c);if(d)for(var f=0;f<r;f++)o[f]=t._pe.UTF8ToString(p[f]);return d},e.utm_to_geog=function(e,r,n,i,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=n.map((function(e){return t._pe.ensureString(e)})),l=t._pe.ensureInt32(s),u=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_utm_to_geog(a,r,l,i,u);return p&&g(o,r,u),p}}(c=t.PeNotationUtm||(t.PeNotationUtm={})),function(e){var r=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(n,i){var o,a;return void 0===i&&(i=e.PE_PCSINFO_OPTION_DOMAIN),r.has(n)&&(a=r.get(n))[i]&&(o=a[i]),o||(o=t._pe.PePCSInfo.prototype.generate(n,i),a||(a=[],r.set(n,a)),a[i]=o),o}}(d=t.PePCSInfo||(t.PePCSInfo={})),function(e){e.version_string=function(){return t._pe.PeVersion.prototype.version_string()}}(t.PeVersion||(t.PeVersion={})),t._init=f}.apply(null,n))||(e.exports=i)},311:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(312)],void 0===(i=function(e,t,r){return function(){function e(e){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(var t=0,n=e.steps;t<n.length;t++){var i=n[t];i instanceof r?this.steps.push(i):this.steps.push(new r({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}}return e.cacheKey=function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")},e.fromGE=function(t){for(var n=new e,i="",o=0,a=t.steps;o<a.length;o++){var s=a[o],l=r.fromGE(s);n.steps.push(l),i+=l.uid.toString()+","}return n._cached_projection={},n._gtlistentry=null,n._chain=i,n},e.prototype.getInverse=function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t},e.prototype.getGTListEntry=function(){for(var e="",t=0,r=this.steps;t<r.length;t++)e+=r[t].uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e),this._gtlistentry},e.prototype.assignCachedGe=function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n},e.prototype.getCachedGeTransformation=function(t,r){for(var n="",i=0,o=this.steps;i<o.length;i++)n+=o[i].uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=n);var a=this._cached_projection[e.cacheKey(t,r)];return void 0===a?null:a},e}()}.apply(null,n))||(e.exports=i)},312:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r=0;return function(){function e(e){void 0===e&&(e=null),this.uid=r++,e?(this._wkt=void 0!==e.wkt?e.wkt:null,this._wkid=void 0!==e.wkid?e.wkid:-1,this._isInverse=void 0!==e.isInverse&&!0===e.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return e.fromGE=function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r},Object.defineProperty(e.prototype,"wkt",{get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wkid",{get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInverse",{get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=r++},enumerable:!0,configurable:!0}),e.prototype.getInverse=function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t},e}()}.apply(null,n))||(e.exports=i)},313:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(118),r(198),r(151)],void 0===(i=function(e,t,r,n,i,o,a){var s,l=o.SetFromValues(["Raster","Raster2","DEM","FillRaster"]),u=o.SetFromValues(["Rasters"]),p=function(e){return e&&e.rasterFunction?d.fromJSON(e):e},c=function(e){return e&&e instanceof d?e.toJSON():e};!function(e){e[e.MOSAIC=0]="MOSAIC",e[e.GROUP=1]="GROUP",e[e.ITEM=2]="ITEM"}(s||(s={}));var d=function(e){function t(t){var r=e.call(this,t)||this;return r.functionArguments=null,r.functionName=null,r.outputPixelType="unknown",r.variableName=null,r.description=null,r.functionDefinition=null,r.thumbnail=null,r}var n;return r.__extends(t,e),n=t,t.prototype.readFunctionArguments=function(e,t){return function(e){if(null==e)return null;for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];l.has(i)?t[i]=p(e[i]):u.has(i)&&Array.isArray(e[i])?t[i]=e[i].map(p):t[i]=e[i]}return t}(t.arguments||t.rasterFunctionArguments)},t.prototype.writeFunctionArguments=function(e,t,r){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i];l.has(a)?n[a]=c(e[a]):u.has(a)&&Array.isArray(e[a])?n[a]=e[a].map(c):n[a]=c(e[a])}this.functionDefinition?t.arguments=n:t[r]=n},t.prototype.readFunctionName=function(e,t){var r=t.rasterFunctionInfos;return t.name||(r&&r.length&&"None"!==r[0].name?r[0].name:t.rasterFunction)},t.prototype.writeFunctionName=function(e,t,r){this.functionDefinition?t.name=e:t[r]=e},t.prototype.readFunctionType=function(e){return s[e]},t.prototype.writeFunctionType=function(e,t,r){t[r]=s[e]},t.prototype.clone=function(){return new n({functionName:this.functionName,functionArguments:i.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,name:this.functionName,description:this.description,functionType:this.functionType,functionDefinition:this.functionDefinition,thumbnail:this.thumbnail})},r.__decorate([a.property({json:{type:Object,write:{target:"rasterFunctionArguments"}}})],t.prototype,"functionArguments",void 0),r.__decorate([a.reader("functionArguments",["rasterFunctionArguments","arguments"])],t.prototype,"readFunctionArguments",null),r.__decorate([a.writer("functionArguments")],t.prototype,"writeFunctionArguments",null),r.__decorate([a.property({json:{type:String,write:{target:"rasterFunction"}}})],t.prototype,"functionName",void 0),r.__decorate([a.reader("functionName",["rasterFunction","rasterFunctionInfos","name"])],t.prototype,"readFunctionName",null),r.__decorate([a.writer("functionName")],t.prototype,"writeFunctionName",null),r.__decorate([a.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),a.property({json:{default:"unknown"}})],t.prototype,"outputPixelType",void 0),r.__decorate([a.property({type:String,json:{read:!0,write:!0}})],t.prototype,"variableName",void 0),r.__decorate([a.property({type:String,json:{read:!0,write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"description",void 0),r.__decorate([a.property({json:{origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"functionType",void 0),r.__decorate([a.reader("functionType")],t.prototype,"readFunctionType",null),r.__decorate([a.writer("functionType")],t.prototype,"writeFunctionType",null),r.__decorate([a.property({type:Object,json:{read:{source:"function"},write:{target:"function"},origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"functionDefinition",void 0),r.__decorate([a.property({type:String,json:{read:!0,write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"thumbnail",void 0),n=r.__decorate([a.subclass("esri.layers.support.RasterFunction")],t)}(n.JSONSupport);return d}.apply(null,n))||(e.exports=i)},314:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(var o=0;o<i.length;o++)r[n][o]=e(i[o])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}}.apply(null,n))||(e.exports=i)},328:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(329)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePBFFeatureQuery=function(e,t){var n=r.parseFeatureQuery(e,t).queryResult.featureResult;if(n&&n.features&&n.features.length&&n.objectIdFieldName)for(var i=n.objectIdFieldName,o=0,a=n.features;o<a.length;o++){var s=a[o];s.attributes&&(s.objectId=s.attributes[i])}return n}}.apply(null,n))||(e.exports=i)},329:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(154),r(156),r(268),r(330),r(331)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=n.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),l=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],u=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],p=["upperLeft","lowerLeft"];function c(e){return e>=l.length?null:l[e]}function d(e){return e>=p.length?null:p[e]}function f(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function h(e,t,r){for(var n=t.createPointGeometry(r);e.next();)switch(e.tag()){case 3:for(var i=e.getUInt32(),o=e.pos()+i,a=0;e.pos()<o;)t.addCoordinatePoint(n,e.getSInt64(),0,a++);break;case 1:case 2:default:e.skip()}return n}function y(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var o=e.getUInt32(),a=e.pos()+o,s=0;e.pos()<a;)t.addLength(n,e.getUInt32(),s++);break;case 3:for(var l=e.getUInt32(),u=(a=e.pos()+l,0),p=0;e.pos()<a;)t.addCoordinate(n,e.getSInt64(),p,u),++u===i&&(p++,u=0);break;case 1:default:e.skip()}return n}function m(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function g(e){for(var t,r={type:c(0)};e.next();)switch(e.tag()){case 1:r.name=e.getString();break;case 2:r.type=c(e.getEnum());break;case 3:r.alias=e.getString();break;case 4:r.sqlType=(t=e.getEnum())>=u.length?null:u[t];break;case 5:case 6:default:e.skip()}return r}function v(e,t,r,n){for(var i=t.createFeature(r),o=0;e.next();)switch(e.tag()){case 1:var a=n[o++].name;i.attributes[a]=e.processMessage(m);break;case 2:i.geometry=e.processMessageWithArgs(y,t,r);break;case 4:i.centroid=e.processMessageWithArgs(h,t,r);break;default:e.skip()}return i}function _(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function b(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function w(e){for(var t={originPosition:d(0)};e.next();)switch(e.tag()){case 1:t.originPosition=d(e.getEnum());break;case 2:t.scale=e.processMessage(_);break;case 3:t.translate=e.processMessage(b);break;default:e.skip()}return t}function S(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function x(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:case 3:case 4:default:e.skip()}return r}function I(e,t){var r=t.createFeatureResult();r.geometryType=f(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(S);break;case 7:r.geometryType=f(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(x,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(w);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(g));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(v,t,r,r.fields));break;case 2:case 6:default:e.skip()}return t.finishFeatureResult(r),r}function R(e,t){for(var r={};e.next();)switch(e.tag()){case 1:r.featureResult=e.processMessageWithArgs(I,t);break;default:e.skip()}return r}t.parseFeatureQuery=function(e,t){var n=function(e){return e&&"dehydrated"===e.type?new o.Context(e):new a.Context(e)}(t);try{for(var l=new i(new Uint8Array(e),new DataView(e)),u={};l.next();)switch(l.tag()){case 2:u.queryResult=l.processMessageWithArgs(R,n);break;default:l.skip()}return u}catch(e){var p=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return s.error(p),{queryResult:{featureResult:n.createFeatureResult()}}}}}.apply(null,n))||(e.exports=i)},330:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(174),r(177),r(170),r(207),r(194),r(248)],void 0===(i=function(e,t,r,n,i,o,a,s){function l(e,t){return t}function u(e,t,r,n){switch(r){case 0:return f(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?f:h)(e,t+n,1)}}function p(e,t,r,n){switch(r){case 0:return f(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?f:h)(e,t+n,1);case 2:return f(e,t,2)}}function c(e,t,r,n){switch(r){case 0:return f(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?f:h)(e,t+n,1);case 2:return f(e,t,3)}}function d(e,t,r,n){switch(r){case 0:return f(e,t+n,0);case 1:return("lowerLeft"===e.originPosition?f:h)(e,t+n,1);case 2:return f(e,t,2);case 3:return f(e,t,3)}}function f(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}function h(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e){this.options=e,this.geometryTypes=["point","multipoint","polyline","polygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=l,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return e.prototype.createFeatureResult=function(){return new o.DehydratedFeatureSetClass},e.prototype.finishFeatureResult=function(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=s.getGeometryZScaler(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(t)for(var r=0,n=e.features;r<n.length;r++)t(n[r].geometry)}},e.prototype.createSpatialReference=function(){return new i},e.prototype.addField=function(e,t){e.fields.push(a.fromJSON(t));var r=e.fields.map((function(e){return e.name}));this.AttributesConstructor=function(){for(var e=0,t=r;e<t.length;e++)this[t[e]]=null}},e.prototype.addFeature=function(e,t){var r=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(r>0)for(var n in t.attributes){var i=t.attributes[n];"string"==typeof i&&i.length>r&&(t.attributes[n]="")}e.features.push(t)},e.prototype.prepareFeatures=function(e){var t=this;switch(this.options.applyTransform&&e.transform&&(this.transform=e.transform,this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"point":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePoint(e,r,i)},this.createGeometry=function(e){return t.createPointGeometry(e)};break;case"polygon":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePolygon(e,r,i)},this.createGeometry=function(e){return t.createPolygonGeometry(e)};break;case"polyline":this.addCoordinate=function(e,r,n,i){return t.addCoordinatePolyline(e,r,i)},this.createGeometry=function(e){return t.createPolylineGeometry(e)};break;case"multipoint":this.addCoordinate=function(e,r,n,i){return t.addCoordinateMultipoint(e,r,i)},this.createGeometry=function(e){return t.createMultipointGeometry(e)};break;default:n.neverReached(e.geometryType)}},e.prototype.createFeature=function(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,new o.DehydratedFeatureClass(r.generateUID(),null,new this.AttributesConstructor)},e.prototype.addLength=function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)},e.prototype.createPointGeometry=function(e){var t={type:"point",x:0,y:0,spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM};return t.hasZ&&(t.z=0),t.hasM&&(t.m=0),t},e.prototype.addCoordinatePoint=function(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:e.hasZ?e.z=t:e.m=t;break;case 3:e.m=t}},e.prototype.transformPathLikeValue=function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)},e.prototype.addCoordinatePolyline=function(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r)},e.prototype.addCoordinatePolygon=function(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r)},e.prototype.addCoordinateMultipoint=function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)},e.prototype.createPolygonGeometry=function(e){return{type:"polygon",rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createPolylineGeometry=function(e){return{type:"polyline",paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createMultipointGeometry=function(e){return{type:"multipoint",points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.dehydratedAddPointsCoordinate=function(e,t,r){if(null===this.coordinateBuffer){var n=this.lengths.reduce((function(e,t){return e+t}),0);this.coordinateBuffer=new Float64Array(n*this.vertexDimension)}0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var i=this.transformPathLikeValue(t,r),o=e[e.length-1];0===r&&o.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension)),this.coordinateBuffer[this.coordinateBufferPtr++]=i},e.prototype.deriveApplyTransform=function(e){var t=e.hasZ,r=e.hasM;return t&&r?d:t?p:r?c:u},e}();t.Context=y}.apply(null,n))||(e.exports=i)},331:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(200),r(178),r(274),r(304),r(224)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this.options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}return e.prototype.createFeatureResult=function(){return new o.default},e.prototype.prepareFeatures=function(){},e.prototype.finishFeatureResult=function(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!n.equals(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=r.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference)/r.getMetersPerVerticalUnitForSR(e.spatialReference);if(1!==t)for(var i=0,o=e.features;i<o.length;i++){var a=o[i];if(a.geometry&&a.geometry.coords)for(var s=a.geometry.coords,l=2;l<s.length;l+=3)s[l]*=t}}},e.prototype.addFeature=function(e,t){e.features.push(t)},e.prototype.createFeature=function(){return new i.default},e.prototype.createSpatialReference=function(){return{wkid:0}},e.prototype.createGeometry=function(){return new a.default},e.prototype.addField=function(e,t){e.fields.push(t)},e.prototype.addCoordinate=function(e,t){e.coords.push(t)},e.prototype.addCoordinatePoint=function(e,t){e.coords.push(t)},e.prototype.addLength=function(e,t){e.lengths.push(t)},e.prototype.createPointGeometry=function(){return new a.default},e}();t.Context=s}.apply(null,n))||(e.exports=i)},348:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(152),r(153),r(172),r(163),r(234),r(304),r(328),r(314),r(248),r(161)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d){function f(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(r&&(i.geometry=JSON.stringify(r),i.geometryType=s.getJsonType(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(i.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var o=n.timeExtent,a=o.start,l=o.end;null==a&&null==l||(i.time=a===l?a:(null==a?"null":a)+","+(null==l?"null":l)),delete n.timeExtent}return i}function h(e,t,o,s,u){void 0===s&&(s={});var p="string"==typeof e?a.urlToObject(e):e,d=t.geometry?[t.geometry]:[];return s.responseType="pbf"===o?"array-buffer":"json",l.normalizeCentralMeridian(d,null,s).then((function(e){var a=e&&e[0];i.isSome(a)&&((t=t.clone()).geometry=a);var l=c.mapParameters(r.__assign(r.__assign(r.__assign(r.__assign({},p.query),{f:o}),u),f(t,u)));return n(p.path+"/query",r.__assign(r.__assign({},s),{query:l}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.queryToQueryStringParameters=f,t.executeQuery=function(e,t,n,i){var o;return r.__awaiter(this,void 0,void 0,(function(){var a,s;return r.__generator(this,(function(r){switch(r.label){case 0:return(null===(o=t.timeExtent)||void 0===o?void 0:o.isEmpty)?(s={data:{features:[]}},[3,3]):[3,1];case 1:return[4,h(e,t,"json",i)];case 2:s=r.sent(),r.label=3;case 3:return a=s,d.applyFeatureSetZUnitScaling(t,n,a.data),[2,a]}}))}))},t.executeQueryPBF=function(e,t,r,n){var i;return(null===(i=t.timeExtent)||void 0===i?void 0:i.isEmpty)?o.resolve({data:new u.default}):h(e,t,"pbf",n).then((function(e){var t,n;return t=p.parsePBFFeatureQuery(e.data,r),(n=e).data=t,n}))},t.executeQueryForIds=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?o.resolve({data:{objectIds:[]}}):h(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?o.resolve({data:{count:0}}):h(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){var n;return(null===(n=t.timeExtent)||void 0===n?void 0:n.isEmpty)?o.resolve({data:{count:0,extent:null}}):h(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error("Layer does not support extent calculation.");if(t.hasOwnProperty("count"))throw new Error("Layer does not support extent calculation.");return e}))},t.runQuery=h}.apply(null,n))||(e.exports=i)},360:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){return"h"in e&&"s"in e&&"v"in e}function n(e){return"l"in e&&"a"in e&&"b"in e}function i(e){return"l"in e&&"c"in e&&"h"in e}function o(e){return"x"in e&&"y"in e&&"z"in e}Object.defineProperty(t,"__esModule",{value:!0});var a=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],s=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function l(e,t){var r,n,i=[];if(e[0].length!==t.length)throw"dimensions do not match";var o=e.length,a=e[0].length,s=0;for(r=0;r<o;r++){for(s=0,n=0;n<a;n++)s+=e[r][n]*t[n];i.push(s)}return i}function u(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)})),r=l(a,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function p(e){var t=l(s,[e.x/100,e.y/100,e.z/100]).map((function(e){var t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function c(e){var t=[e.x/95.047,e.y/100,e.z/108.883].map((function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29}));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function d(e){var t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((function(e){return e>6/29?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)}));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function f(e){return c(u(e))}function h(e){return p(d(e))}function y(e){return function(e){return"r"in e&&"g"in e&&"b"in e}(e)?e:i(e)?function(e){return p(d(function(e){var t=e.l,r=e.c,n=e.h;return{l:t,a:r*Math.cos(n),b:r*Math.sin(n)}}(e)))}(e):n(e)?h(e):o(e)?p(e):r(e)?function(e){var t,r=(e.h+360)%360/60,n=e.s/100,i=e.v/100*255,o=i*n,a=o*(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:t={r:o,g:a,b:0};break;case 1:t={r:a,g:o,b:0};break;case 2:t={r:0,g:o,b:a};break;case 3:t={r:0,g:a,b:o};break;case 4:t={r:a,g:0,b:o};break;case 5:case 6:t={r:o,g:0,b:a};break;default:t={r:0,g:0,b:0}}return t.r=Math.round(t.r+i-o),t.g=Math.round(t.g+i-o),t.b=Math.round(t.b+i-o),t}(e):void 0}t.toRGB=y,t.toHSV=function(e){return r(e)?e:function(e){var t,r,n,i=e.r,o=e.g,a=e.b,s=Math.max(i,o,a),l=s-Math.min(i,o,a);return n=s,0===l?t=0:s===i?t=(o-a)/l%6:s===o?t=(a-i)/l+2:s===a&&(t=(i-o)/l+4),r=0===l?0:l/n,t<0&&(t+=6),{h:t*=60,s:r*=100,v:n*=100/255}}(y(e))},t.toLAB=function(e){return n(e)?e:f(y(e))},t.toLCH=function(e){return i(e)?e:function(e){return function(e){var t=e.l,r=e.a,n=e.b,i=Math.sqrt(r*r+n*n),o=Math.atan2(n,r);return{l:t,c:i,h:o=o>0?o:o+2*Math.PI}}(c(u(e)))}(y(e))},t.toXYZ=function(e){return o(e)?e:u(y(e))},t.darken=function(e,t){var r=f(e);return r.l*=1-t,h(r)}}.apply(null,n))||(e.exports=i)},378:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(158),r(151),r(439),r(235),r(490)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"},u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._scale=null,t.view=null,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"dynamicLayers",{get:function(){if(!this.hasDynamicLayers)return null;var e=this.visibleSublayers.map((function(e){return e.toExportImageJSON()}));return e.length?JSON.stringify(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasDynamicLayers",{get:function(){return this.layer&&o.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layer",{set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this._layerHandles&&(this._layerHandles.forEach((function(e){return e.remove()})),this._layerHandles.length=0),e&&(this._layerHandles=[e.allSublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("sublayer-update",(function(e){return t.notifyChange(l[e.propertyName])}))]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){var e=this.visibleSublayers;return e?e.length?"show:"+e.map((function(e){return e.id})).join(","):"show:-1":null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layerDefs",{get:function(){var e=this.visibleSublayers.filter((function(e){return null!=e.definitionExpression}));return e.length?JSON.stringify(e.reduce((function(e,t){return e[t.id]=t.definitionExpression,e}),{})):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(e){this.view||(this._scale=e,this.notifyChange("scale"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){this.layers,this.layerDefs,this.dynamicLayers,this.timeExtent;var e=this.layer;return e&&(e.dpi,e.imageFormat,e.imageTransparency,e.gdbVersion),(this._get("version")||0)+1},set:function(e){this._set("version",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visibleSublayers",{get:function(){var e=this,t=[];if(!this.layer)return t;var r=this.layer.sublayers,n=function(r){var i=e.scale,o=0===i,a=0===r.minScale||i<=r.minScale,s=0===r.maxScale||i>=r.maxScale;r.visible&&(o||a&&s)&&(r.sublayers?r.sublayers.forEach(n):t.unshift(r))};r&&r.forEach(n);var i=this._get("visibleSublayers");return!i||i.length!==t.length||i.some((function(e,r){return t[r]!==e}))?t:i},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var e=this.layer,t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t=r.__assign(r.__assign({},t),{layers:this.layers,layerDefs:this.layerDefs}),t},r.__decorate([i.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],t.prototype,"dynamicLayers",null),r.__decorate([i.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],t.prototype,"hasDynamicLayers",null),r.__decorate([i.property()],t.prototype,"layer",null),r.__decorate([i.property({readOnly:!0,dependsOn:["visibleSublayers"]})],t.prototype,"layers",null),r.__decorate([i.property({readOnly:!0,dependsOn:["visibleSublayers"]})],t.prototype,"layerDefs",null),r.__decorate([i.property({type:Number,dependsOn:["view.scale"]})],t.prototype,"scale",null),r.__decorate([i.property(a.combinedViewLayerTimeExtentProperty)],t.prototype,"timeExtent",void 0),r.__decorate([i.property({dependsOn:["layers","layerDefs","dynamicLayers","layer.dpi","layer.imageFormat","layer.imageTransparency","layer.gdbVersion","timeExtent"]})],t.prototype,"version",null),r.__decorate([i.property({type:s})],t.prototype,"view",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],t.prototype,"visibleSublayers",null),r.__decorate([i.subclass("esri.layers.mixins.ExportImageParameters")],t)}(n);t.ExportImageParameters=u}.apply(null,n))||(e.exports=i)},396:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(182),r(164),r(370),r(792),r(183)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=0,l=0,u=n("android"),p=n("chrome")||u&&u>=4?"auto":"optimizeLegibility",c={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},d=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,f={},h={},y={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};function m(e){return e.map((function(e){return e.command+" "+e.values.join(" ")})).join(" ").trim()}function g(e,t,r,n){if(e){if("circle"===e.type)return a.tsx("circle",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===e.type)return a.tsx("ellipse",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return a.tsx("rect",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===e.type)return a.tsx("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type){var i="string"!=typeof e.path?m(e.path):e.path;return a.tsx("path",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",d:i})}if("text"===e.type)return a.tsx("text",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4","text-anchor":n.align,"text-decoration":n.decoration,kerning:n.kerning,rotate:n.rotate,"text-rendering":p,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,"font-size":n.font.size,"font-family":n.font.family,x:e.x,y:e.y},e.text)}return null}function v(e){var t={fill:"none",pattern:null,linearGradient:null};if(e)if("type"in e&&"pattern"===e.type){var n="patternId-"+ ++s;t.fill="url(#"+n+")",t.pattern={id:n,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&"linear"===e.type)n="linearGradientId-"+ ++l,t.fill="url(#"+n+")",t.linearGradient={id:n,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map((function(e){return{offset:e.offset,color:e.color&&new r(e.color).toString()}}))};else if(e){var i=new r(e);t.fill=i.toString()}return t}function _(e){var t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(e&&(null!=e.width&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new r(e.color).toString()),e.style)){var n=null;if(e.style in y&&(n=y[e.style]),Array.isArray(n)){n=n.slice(0);for(var i=0;i<n.length;++i)n[i]*=e.width;if("butt"!==e.cap){for(i=0;i<n.length;i+=2)n[i]-=e.width,n[i]<1&&(n[i]=1);for(i=1;i<n.length;i+=2)n[i]+=e.width}n=n.join(",")}t.dashArray=n}return t}function b(e,t){var r={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};return e&&(r.align=e.align,r.decoration=e.decoration,r.kerning=e.kerning?"auto":"0",r.rotate=e.rotated?"90":"0",r.font.style=t.style||"normal",r.font.variant=t.variant||"normal",r.font.weight=t.weight||"normal",r.font.size=t.size&&t.size.toString()||"10pt",r.font.family=t.family||"serif"),r}function w(e){var t=e.pattern,r=e.linearGradient;if(t)return a.tsx("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},a.tsx("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(r){var n=r.stops.map((function(e,t){return a.tsx("stop",{key:t+"-stop",offset:e.offset,"stop-color":e.color})}));return a.tsx("linearGradient",{id:r.id,gradientUnits:"userSpaceOnUse",x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2},n)}return null}function S(e,t,r,n,i){return o.scale(e,o.identity(e),[t,r]),e[4]=e[4]*t-n*t+n,e[5]=e[5]*r-i*r+i,e}function x(e,t){f&&"left"in f?(f.left>e&&(f.left=e),f.right<e&&(f.right=e),f.top>t&&(f.top=t),f.bottom<t&&(f.bottom=t)):f={left:e,bottom:t,right:e,top:t}}function I(e){var t,r=e.args,n=r.length;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(t=0;t<n;t+=2)x(r[t],r[t+1]);h.x=r[n-2],h.y=r[n-1];break;case"H":for(t=0;t<n;++t)x(r[t],h.y);h.x=r[n-1];break;case"V":for(t=0;t<n;++t)x(h.x,r[t]);h.y=r[n-1];break;case"m":var i=0;"x"in h||(x(h.x=r[0],h.y=r[1]),i=2);for(t=i;t<n;t+=2)x(h.x+=r[t],h.y+=r[t+1]);break;case"l":case"t":for(t=0;t<n;t+=2)x(h.x+=r[t],h.y+=r[t+1]);break;case"h":for(t=0;t<n;++t)x(h.x+=r[t],h.y);break;case"v":for(t=0;t<n;++t)x(h.x,h.y+=r[t]);break;case"c":for(t=0;t<n;t+=6)x(h.x+r[t],h.y+r[t+1]),x(h.x+r[t+2],h.y+r[t+3]),x(h.x+=r[t+4],h.y+=r[t+5]);break;case"s":case"q":for(t=0;t<n;t+=4)x(h.x+r[t],h.y+r[t+1]),x(h.x+=r[t+2],h.y+=r[t+3]);break;case"A":for(t=0;t<n;t+=7)x(r[t+5],r[t+6]);h.x=r[n-2],h.y=r[n-1];break;case"a":for(t=0;t<n;t+=7)x(h.x+=r[t+5],h.y+=r[t+6])}}function R(e,t,r){var n,i=c[e.toLowerCase()];"number"==typeof i&&(i?t.length>=i&&(n={action:e,args:t.slice(0,t.length-t.length%i)},r.push(n),I(n)):(n={action:e,args:[]},r.push(n),I(n)))}function T(e){var t={x:0,y:0,width:0,height:0};if("circle"===e.type)t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if("ellipse"===e.type)t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if("image"===e.type||"rect"===e.type)t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if("path"===e.type){var r=function(e){var t=("string"!=typeof e.path?m(e.path):e.path).match(d),r=[];if(f={},h={},!t)return null;for(var n="",i=[],o=t.length,a=0;a<o;++a){var s=t[a],l=parseFloat(s);isNaN(l)?(n&&R(n,i,r),i=[],n=s):i.push(l)}R(n,i,r);var u={x:0,y:0,width:0,height:0};return f&&"left"in f&&(u.x=f.left,u.y=f.top,u.width=f.right-f.left,u.height=f.bottom-f.top),u}(e);t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height}return t}function C(e){for(var t={x:0,y:0,width:0,height:0},r=null,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=0,a=e;o<a.length;o++){var s=a[o];r?(r.x=Math.min(r.x,s.x),r.y=Math.min(r.y,s.y),n=Math.max(n,s.x+s.width),i=Math.max(i,s.y+s.height)):((r=t).x=s.x,r.y=s.y,n=s.x+s.width,i=s.y+s.height)}return r&&(r.width=n-r.x,r.height=i-r.y),r}function P(e,t,r,n,a,s){var l=t/2,u=r/2,p=e.width+n,c=e.height+n,d=i.mat2df32.create(),f=i.mat2df32.create(),h=!1;if(a&&0!==p&&0!==c){var y=p/c,m=t>r?t:r,g=1,v=1;isNaN(m)||(y>1?(g=m/p,v=m/y/c):(v=m/c,g=m*y/p)),o.multiply(f,f,S(d,g,v,l,u)),h=!0}var _=e.x+(p-n)/2,b=e.y+(c-n)/2,w=l-_,x=u-b;if(o.multiply(f,f,function(e,t,r){return o.translate(e,o.identity(e),[t,r])}(d,w,x)),!h&&(p>t||c>r)){var I=p/t>c/r,R=(I?t:r)/(I?p:c);o.multiply(f,f,S(d,R,R,_,b))}return s&&o.multiply(f,f,function(e,t,r,n){var i=t%360*Math.PI/180;o.rotate(e,o.identity(e),i);var a=Math.cos(i),s=Math.sin(i),l=e[4],u=e[5];return e[4]=l*a-u*s+n*s-r*a+r,e[5]=u*a+l*s-r*s-n*a+n,e}(d,s,_,b)),"matrix("+f[0]+","+f[1]+","+f[2]+","+f[3]+","+f[4]+","+f[5]+")"}t.renderShape=g,t.generateFillAttributes=v,t.generateStrokeAttributes=_,t.generateTextAttributes=b,t.renderDef=w,t.getBoundingBox=T,t.computeBBox=C,t.getTransformMatrix=P,t.renderSVG=function(e,t,r,n){for(var i=[],o=[],s=0,l=e;s<l.length;s++){for(var u=[],p=[],c=0,d=0,f=l[s];d<f.length;d++){var h=f[d],y=h.shape,m=h.fill,S=h.stroke,x=h.font;c+=S&&S.width||0;var I=v(m),R=_(S),L="text"===y.type?b(y,x):null;i.push(w(I)),u.push(g(y,I.fill,R,L)),p.push(T(y))}var k=P(C(p),t,r,c,n&&n.scale,n&&n.rotation);o.push(a.tsx("g",{transform:k},u))}return a.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:r},a.tsx("defs",null,i),o)}}.apply(null,n))||(e.exports=i)},397:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(366),r(434)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=r.convertDateFormatToIntlOptions("short-date");t.createStopLabel=function(e,t,o,a){var s="";return 0===t?s="< ":t===o&&(s="> "),s+(a?r.formatDate(e,i):n.format(e))},t.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="]}.apply(null,n))||(e.exports=i)},398:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(165),r(154),r(118),r(225),r(153),r(229),r(172),r(172),r(151),r(208),r(244),r(240),r(298),r(265),r(486),r(237),r(507)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=e.apply(this,t)||this;return i.copyright="",i.fullExtent=new n.Extent(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,n.SpatialReference.WebMercator),i.legendEnabled=!1,i.isReference=null,i.popupEnabled=!1,i.spatialReference=n.SpatialReference.WebMercator,i.subDomains=null,i.tileInfo=new _({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new n.Point({x:-20037508.342787,y:20037508.342787,spatialReference:n.SpatialReference.WebMercator}),spatialReference:n.SpatialReference.WebMercator,lods:[new v({level:0,scale:591657527.591555,resolution:156543.033928}),new v({level:1,scale:295828763.795777,resolution:78271.5169639999}),new v({level:2,scale:147914381.897889,resolution:39135.7584820001}),new v({level:3,scale:73957190.948944,resolution:19567.8792409999}),new v({level:4,scale:36978595.474472,resolution:9783.93962049996}),new v({level:5,scale:18489297.737236,resolution:4891.96981024998}),new v({level:6,scale:9244648.868618,resolution:2445.98490512499}),new v({level:7,scale:4622324.434309,resolution:1222.99245256249}),new v({level:8,scale:2311162.217155,resolution:611.49622628138}),new v({level:9,scale:1155581.108577,resolution:305.748113140558}),new v({level:10,scale:577790.554289,resolution:152.874056570411}),new v({level:11,scale:288895.277144,resolution:76.4370282850732}),new v({level:12,scale:144447.638572,resolution:38.2185141425366}),new v({level:13,scale:72223.819286,resolution:19.1092570712683}),new v({level:14,scale:36111.909643,resolution:9.55462853563415}),new v({level:15,scale:18055.954822,resolution:4.77731426794937}),new v({level:16,scale:9027.977411,resolution:2.38865713397468}),new v({level:17,scale:4513.988705,resolution:1.19432856685505}),new v({level:18,scale:2256.994353,resolution:.597164283559817}),new v({level:19,scale:1128.497176,resolution:.298582141647617})]}),i.type="web-tile",i.urlTemplate=null,i.wmtsInfo=null,i}return r.__extends(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?a.mixin({urlTemplate:e},t||{}):e},t.prototype.load=function(e){var t=this,r=this.loadFromPortal({supportedTypes:["WMTS"]},e).then((function(){var e="";if(t.urlTemplate)if(t.spatialReference.equals(t.tileInfo.spatialReference)){var r=new p.Url(t.urlTemplate);t.subDomains&&t.subDomains.length>0||-1===r.authority.indexOf("{subDomain}")||(e="is missing 'subDomains' property")}else e="spatialReference must match tileInfo.spatialReference";else e="is missing the required 'urlTemplate' property value";if(e)throw new o("web-tile-layer:load","WebTileLayer (title: '"+t.title+"', id: '"+t.id+"') "+e)}));return this.addResolvingPromise(r),l.resolve(this)},Object.defineProperty(t.prototype,"levelValues",{get:function(){var e=[];if(!this.tileInfo)return null;for(var t=0,r=this.tileInfo.lods;t<r.length;t++){var n=r[t];e[n.level]=n.levelValue||n.level}return e},enumerable:!0,configurable:!0}),t.prototype.readSpatialReference=function(e,t){return e||t.fullExtent&&t.fullExtent.spatialReference&&n.SpatialReference.fromJSON(t.fullExtent.spatialReference)},Object.defineProperty(t.prototype,"tileServers",{get:function(){if(!this.urlTemplate)return null;var e=[],t=this.urlTemplate,r=this.subDomains,n=new p.Url(t),i=n.scheme?n.scheme+"://":"//",o=i+n.authority+"/";if(-1===n.authority.indexOf("{subDomain}"))e.push(o);else if(r&&r.length>0&&n.authority.split(".").length>1)for(var a=0,s=r;a<s.length;a++){var l=s[a];e.push(i+n.authority.replace(/\{subDomain\}/gi,l)+"/")}return e.map((function(e){return"/"!==e.charAt(e.length-1)&&(e+="/"),e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"urlPath",{get:function(){if(!this.urlTemplate)return null;var e=this.urlTemplate,t=new p.Url(e),r=(t.scheme?t.scheme+"://":"//")+t.authority+"/";return e.substring(r.length)},enumerable:!0,configurable:!0}),t.prototype.readUrlTemplate=function(e,t){return e||t.templateUrl},t.prototype.writeUrlTemplate=function(e,t){e&&c.isProtocolRelative(e)&&(e="https:"+e),t.templateUrl=e?c.normalize(e):e},t.prototype.fetchTile=function(e,t,r,n){void 0===n&&(n={});var o=n.signal,a=n.timestamp,s=this.getTileUrl(e,t,r),l={responseType:"image",signal:o};return null!=a&&(l.query={_ts:n.timestamp}),i(s,l).then((function(e){return e.data}))},t.prototype.getTileUrl=function(e,t,r){var n=this.levelValues[e],i=this.tileServers[t%this.tileServers.length]+u.replace(this.urlPath,{level:n,col:r,row:t});return i.replace(/\{level\}/gi,""+n).replace(/\{row\}/gi,""+t).replace(/\{col\}/gi,""+r)},r.__decorate([d.property({type:String,value:"",json:{write:!0}})],t.prototype,"copyright",void 0),r.__decorate([d.property({type:n.Extent,json:{write:!0}})],t.prototype,"fullExtent",void 0),r.__decorate([d.property({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"legendEnabled",void 0),r.__decorate([d.property({type:["show","hide"]})],t.prototype,"listMode",void 0),r.__decorate([d.property({dependsOn:["tileInfo"]})],t.prototype,"levelValues",null),r.__decorate([d.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],t.prototype,"isReference",void 0),r.__decorate([d.property({type:["WebTiledLayer"],value:"WebTiledLayer"})],t.prototype,"operationalLayerType",void 0),r.__decorate([d.property({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"popupEnabled",void 0),r.__decorate([d.property({type:n.SpatialReference})],t.prototype,"spatialReference",void 0),r.__decorate([d.reader("spatialReference",["spatialReference","fullExtent.spatialReference"])],t.prototype,"readSpatialReference",null),r.__decorate([d.property({type:[String],json:{write:!0}})],t.prototype,"subDomains",void 0),r.__decorate([d.property({type:_,json:{write:!0}})],t.prototype,"tileInfo",void 0),r.__decorate([d.property({readOnly:!0,dependsOn:["urlTemplate","subDomains"]})],t.prototype,"tileServers",null),r.__decorate([d.property({json:{read:!1}})],t.prototype,"type",void 0),r.__decorate([d.property({dependsOn:["urlTemplate"]})],t.prototype,"urlPath",null),r.__decorate([d.property({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],t.prototype,"urlTemplate",void 0),r.__decorate([d.reader("urlTemplate",["urlTemplate","templateUrl"])],t.prototype,"readUrlTemplate",null),r.__decorate([d.writer("urlTemplate",{templateUrl:{type:String}})],t.prototype,"writeUrlTemplate",null),r.__decorate([d.property({type:b.default,json:{write:!0}})],t.prototype,"wmtsInfo",void 0),r.__decorate([d.subclass("esri.layers.WebTileLayer")],t)}(m.RefreshableLayer(g.ScaleRangeLayer(h.OperationalLayer(y.PortalLayer(s.MultiOriginJSONMixin(f))))))}.apply(null,n))||(e.exports=i)},399:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(264),r(770),r(979),r(981),r(982),r(784)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0}),t.ClassBreaksRenderer=n,t.RasterColormapRenderer=i,t.RasterShadedReliefRenderer=o,t.RasterStretchRenderer=a,t.UniqueValueRenderer=s,t.rasterRendererTypes={key:"type",base:null,typeMap:{"unique-value":s,"class-breaks":n,"raster-colormap":i,"raster-stretch":a,"raster-shaded-relief":o}};var l={uniqueValue:s,classBreaks:n,rasterStretch:a,rasterColormap:i,rasterShadedRelief:o};function u(e,t){if(!e)return null;var n=function(e){return e&&l[e.type]||null}(e);if(n){var i=new n;return i.read(e,t),i}return t&&t.messages&&e&&t.messages.push(new r("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t})),null}t.read=u,t.fromJSON=function(e,t){return u(e,t)}}.apply(null,n))||(e.exports=i)},400:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(166),r(155),r(118),r(151),r(202),r(421),r(313)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){var p=n.strict()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),c=n.strict()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});return function(e){function t(t){var r=e.call(this,t)||this;return r.ascending=!0,r.itemRenderingRule=null,r.lockRasterIds=null,r.method=null,r.multidimensionalDefinition=null,r.objectIds=null,r.operation=null,r.sortField=null,r.sortValue=null,r.viewpoint=null,r.where=null,r}var n;return r.__extends(t,e),n=t,t.prototype.readAscending=function(e,t){return null!=t.ascending?t.ascending:null==t.sortAscending||t.sortAscending},t.prototype.readMethod=function(e,t){return function(e){var t;switch(e?e.toLowerCase().replace("esrimosaic",""):""){case"byattribute":case"attribute":t="esriMosaicAttribute";break;case"lockraster":t="esriMosaicLockRaster";break;case"center":t="esriMosaicCenter";break;case"northwest":t="esriMosaicNorthwest";break;case"nadir":t="esriMosaicNadir";break;case"viewpoint":t="esriMosaicViewpoint";break;case"seamline":t="esriMosaicSeamline";break;case"none":default:t="esriMosaicNone"}return c.fromJSON(t)}(t.mosaicMethod||t.defaultMosaicMethod)},t.prototype.readOperation=function(e,t){var r=t.mosaicOperation,n=t.mosaicOperator&&t.mosaicOperator.toLowerCase(),i=r||(n?p.toJSON(n):null);return p.fromJSON(i)||"first"},t.prototype.castSortValue=function(e){return null==e||"string"==typeof e||"number"==typeof e?e:""+e},t.prototype.clone=function(){return new n({ascending:this.ascending,itemRenderingRule:o.clone(this.itemRenderingRule),lockRasterIds:o.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:o.clone(this.multidimensionalDefinition),objectIds:o.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:o.clone(this.viewpoint),where:this.where})},r.__decorate([a.property({type:Boolean,json:{write:!0}})],t.prototype,"ascending",void 0),r.__decorate([a.reader("ascending",["ascending","sortAscending"])],t.prototype,"readAscending",null),r.__decorate([a.property({type:u,json:{write:!0}})],t.prototype,"itemRenderingRule",void 0),r.__decorate([a.property({type:[Number],json:{write:{overridePolicy:function(){return{enabled:"lock-raster"===this.method}}}}})],t.prototype,"lockRasterIds",void 0),r.__decorate([a.property({type:String,json:{type:c.jsonValues,write:{target:"mosaicMethod",writer:c.write}}})],t.prototype,"method",void 0),r.__decorate([a.reader("method",["mosaicMethod","defaultMosaicMethod"])],t.prototype,"readMethod",null),r.__decorate([a.property({type:[l],json:{write:!0}})],t.prototype,"multidimensionalDefinition",void 0),r.__decorate([a.property({type:[Number],json:{read:{source:"fids"},write:{target:"fids"}}})],t.prototype,"objectIds",void 0),r.__decorate([a.property({json:{type:p.jsonValues,read:{reader:p.read},write:{target:"mosaicOperation",writer:p.write}}})],t.prototype,"operation",void 0),r.__decorate([a.reader("operation",["mosaicOperation","mosaicOperator"])],t.prototype,"readOperation",null),r.__decorate([a.property({type:String,json:{write:{overridePolicy:function(){return{enabled:"attribute"===this.method}}}}})],t.prototype,"sortField",void 0),r.__decorate([a.property({type:[String,Number],json:{write:{allowNull:!0,overridePolicy:function(){return{enabled:"attribute"===this.method,allowNull:!0}}}}})],t.prototype,"sortValue",void 0),r.__decorate([a.cast("sortValue")],t.prototype,"castSortValue",null),r.__decorate([a.property({type:s,json:{write:!0}})],t.prototype,"viewpoint",void 0),r.__decorate([a.property({type:String,json:{write:!0}})],t.prototype,"where",void 0),n=r.__decorate([a.subclass("esri.layers.support.MosaicRule")],t)}(i.JSONSupport)}.apply(null,n))||(e.exports=i)},421:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(118),r(151),r(179)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.variableName=null,r.dimensionName=null,r.values=[],r.isSlice=!1,r}var n;return r.__extends(t,e),n=t,t.prototype.clone=function(){return new n({variableName:this.variableName,dimensionName:this.dimensionName,values:i.clone(this.values),isSlice:this.isSlice})},r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"variableName",void 0),r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"dimensionName",void 0),r.__decorate([o.property({type:a.types.array(a.types.oneOf([a.types.native(Number),a.types.array(a.types.native(Number))])),json:{write:!0}})],t.prototype,"values",void 0),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"isSlice",void 0),n=r.__decorate([o.subclass("esri.layers.support.DimensionalDefinition")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},422:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(399),r(180),r(118),r(313),r(461),r(549),r(630)],void 0===(i=function(e,t,r,n,i,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767]},p={type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},c=l.fromJSON(a.PREDEFINED_JSON_COLOR_RAMPS[0]);t.isSupportedRendererType=function(e){return["raster-stretch","unique-value","class-breaks","raster-shaded-relief"].indexOf(e.type)>-1},t.combineRenderingRules=function(e,t){if(!e||!t)return i.clone(e||t);var r=i.clone(e);return"none"!==t.functionName.toLowerCase()&&((function e(t){var r=t.Raster;return r&&"esri.layers.support.RasterFunction"===r.declaredClass?e(r.functionArguments):t}(r.functionArguments)).Raster=t),r},t.convertRendererToRenderingRule=function(e,t){switch(t=t||{},e.type){case"raster-stretch":return function(e,t){var r=new o;r.functionName="Stretch";var n=d[s.stretchTypeJSONDict.toJSON(e.stretchType)],i={StretchType:n,Statistics:function(e){var t=[];return e.forEach((function(e){var r=e;if(Array.isArray(r))t.push(r);else{if(null==r.min||null==r.max)return;var n=[r.min,r.max,r.avg||0,r.stddev||0];t.push(n)}})),t}(e.statistics),DRA:e.dynamicRangeAdjustment,UseGamma:e.useGamma,Gamma:e.gamma,ComputeGamma:e.computeGamma};if(null!=e.outputMin&&(i.Min=e.outputMin),null!=e.outputMax&&(i.Max=e.outputMax),n===d.standardDeviation?(i.NumberOfStandardDeviations=e.numberOfStandardDeviations,r.outputPixelType="u8"):n===d.percentClip?(i.MinPercent=e.minPercent,i.MaxPercent=e.maxPercent,r.outputPixelType="u8"):n===d.minMax?r.outputPixelType="u8":n===d.sigmoid&&(i.SigmoidStrengthLevel=e.sigmoidStrengthLevel),r.functionArguments=i,r.variableName="Raster",e.colorRamp){var l=e.colorRamp,u=new o,p=a.getColorRampName(l);return p?u.functionArguments={colorRamp:p}:!t.convertColorRampToColormap||"algorithmic"!==l.type&&"multipart"!==l.type?u.functionArguments={colorRamp:e.colorRamp.toJSON()}:u.functionArguments={Colormap:a.convertColorRampToColormap(l,256)},u.variableName="Raster",u.functionName="Colormap",u.functionArguments.Raster=r,u}return r}(e,t);case"class-breaks":return function(e,t){var r=[],n=[],i=[],a=[],s=t.pixelType,l=t.rasterAttributeTable,u=l&&l.features,p=h(l);if(u&&Array.isArray(u)&&e.classBreakInfos){e.classBreakInfos.forEach((function(t,r){var n,i=t.symbol.color;i.a&&u.forEach((function(o){((n=o.attributes[e.field])>=t.minValue&&n<t.maxValue||r===e.classBreakInfos.length-1&&n>=t.minValue)&&a.push([o.attributes[p],i.r,i.g,i.b])}))}));var c=s?f(a,s):a,d=new o;return d.functionName="Colormap",d.functionArguments={},d.functionArguments.Colormap=c,d.variableName="Raster",d}e.classBreakInfos.forEach((function(e,t){var o=e.symbol&&e.symbol.color;o.a?(0===t?r.push(e.minValue,e.maxValue+1e-6):r.push(e.minValue+1e-6,e.maxValue+1e-6),n.push(t),a.push([t,o.r,o.g,o.b])):i.push(e.minValue,e.maxValue)}));var y=s?f(a,s):a,m=new o;m.functionName="Remap",m.functionArguments={InputRanges:r,OutputValues:n,NoDataRanges:i},m.variableName="Raster";var g=new o;return g.functionName="Colormap",g.functionArguments={Colormap:y,Raster:m},g}(e,t);case"unique-value":return function(e,t){var r=[],n=t.pixelType,i=t.rasterAttributeTable,a=i&&i.features,s=h(i),l=!1;if(e.uniqueValueInfos&&e.uniqueValueInfos.forEach((function(t){var n=t.symbol.color;n.a&&(e.field!==s&&a?a&&a.forEach((function(i){String(i.attributes[e.field])===String(t.value)&&r.push([i.attributes[s],n.r,n.g,n.b])})):isNaN(t.value)?l=!0:r.push([t.value,n.r,n.g,n.b]))})),l)return null;var u=n&&r.length>0?f(r,n):r,p=new o;return p.functionName="Colormap",p.functionArguments={},p.functionArguments.Colormap=u,p.variableName="Raster",p}(e,t);case"raster-colormap":return function(e,t){var r=e.extractColormap();if(r&&0!==r.length){var n=t.pixelType,i=n?f(r,n):r,a=new o;return a.functionName="Colormap",a.functionArguments={},a.functionArguments.Colormap=i,a}}(e,t);case"raster-shaded-relief":return function(e,t){if("elevation"!==t.dataType)return new o;var r=new o;r.functionName="Hillshade";var n="traditional"===e.hillshadeType?0:1,i="none"===e.scalingType?1:3,s={HillshadeType:n,SlopeType:i,ZFactor:e.zFactor};return 0===n&&(s.Azimuth=e.azimuth,s.Altitude=e.altitude),3===i&&(s.PSPower=e.pixelSizePower,s.PSZFactor=e.pixelSizeFactor),r.functionArguments=s,r.variableName="Raster",e.colorRamp&&(r.functionName="ShadedRelief",s.Colormap=a.convertColorRampToColormap(e.colorRamp,256)),r}(e,t)}},t.createDefaultRenderer=function(e,t){if(e){var n,i,o,s,l,u,d,f=e.attributeTable,h=e.dataType,y=e.bandCount,m=e.pixelType,g=e.colormap,v=e.statistics,_=e.histograms;if(t&&t.length>0&&(v=v?t.map((function(e){return v[e]})):null,_=_?t.map((function(e){return _[e]})):null),f&&(i=f.fields.filter((function(e){return"red"===e.name.toLowerCase()}))[0],o=f.fields.filter((function(e){return"green"===e.name.toLowerCase()}))[0],s=f.fields.filter((function(e){return"blue"===e.name.toLowerCase()}))[0],u=f.fields.filter((function(e){return"value"===e.name.toLowerCase()}))[0],(l=f.fields.filter((function(e){return"classname"===e.name.toLowerCase()||"class_name"===e.name.toLowerCase()}))[0])||(l=f.fields.filter((function(e){return"string"===e.type}))[0])||(l=u)),1===y&&(null==g?void 0:g.length)>0)f&&i&&o&&s&&(d={},f.features.forEach((function(e){var t=e.attributes;d[t[u.name]]=l?t[l.name]:t[u.name]}))),n=r.RasterColormapRenderer.createFromColormap(g,d);else if(1===y&&f){var b=void 0,w=f.features;if(i&&o&&s&&l)b=w.map((function(e){return{value:e.attributes[l.name],label:e.attributes[l.name],symbol:{type:"esriSFS",style:"esriSFSSolid",color:[e.attributes[i.name],e.attributes[o.name],e.attributes[s.name],255]}}}));else{var S=a.convertColorRampToColormap(c,w.length);b=w.map((function(e,t){return{value:e.attributes[u.name],label:e.attributes[u.name],symbol:{color:S[t].slice(1,4),type:"esriSFS",style:"esriSFSSolid"}}}))}b.sort((function(e,t){return e.value>t.value?1:-1})),n=r.UniqueValueRenderer.fromJSON({field1:l.name,uniqueValueInfos:b})}if(!n){var x=void 0,I=!1,R=void 0,T=void 0,C=void 0;"u8"===m&&"processed"===h?(x="none",v=1===y?[{min:0,max:255}]:[{min:0,max:255},{min:0,max:255},{min:0,max:255}]):"u8"===m||"elevation"===h?(x="min-max",I=!v):"scientific"===h?(x="min-max",I=!v,R=p):_&&_.length>0?(x="percent-clip",C=T=.25):v?x="min-max":(x="percent-clip",I=!0),n=r.RasterStretchRenderer.fromJSON({stretchType:x,dra:I,colorRamp:R,min:0,max:255,statistics:I?null:v,histograms:I?null:_,maxPercent:T,minPercent:C})}return n}},t.getDefaultBandCombination=function(e){var t=e.bandCount;if(1===t)return null;if(2===t)return[0];var r,n,i,o,a,s=e.keyProperties&&e.keyProperties.BandProperties;if(s&&s.length===t){for(var l=0;l<s.length;l++)s[l].BandName&&"red"===s[l].BandName.toLowerCase()&&(n=l),s[l].BandName&&"green"===s[l].BandName.toLowerCase()&&(i=l),s[l].BandName&&"blue"===s[l].BandName.toLowerCase()&&(o=l),s[l].BandName&&"nearinfrared"===s[l].BandName.toLowerCase()&&(a=l);void 0!==n&&void 0!==i&&void 0!==o?r=[n,i,o]:void 0!==n&&void 0!==i&&void 0!==a&&(r=[a,n,i])}return!r&&t>3&&(r=[0,1,2]),r};var d={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function f(e,t){var r=u[String(t).toLowerCase()];return r&&e.push([Math.floor(r[0]-1),0,0,0],[Math.ceil(r[1]+1),0,0,0]),e}function h(e){if(e){var t=e.fields,r=t&&n.find(t,(function(e){return e&&e.name&&"value"===e.name.toLowerCase()}));return r&&r.name}}}.apply(null,n))||(e.exports=i)},423:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(151),r(184),r(187)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.attributeTable=null,r.bandCount=null,r.colormap=null,r.extent=null,r.format=void 0,r.height=null,r.width=null,r.histograms=null,r.keyProperties=null,r.multidimensionalInfo=null,r.noDataValue=null,r.pixelSize=null,r.pixelType=null,r.spatialReference=null,r.statistics=null,r.storageInfo=null,r}return r.__extends(t,e),Object.defineProperty(t.prototype,"dataType",{get:function(){var e=this.keyProperties&&this.keyProperties.DataType;return e?e.toLowerCase():"generic"},enumerable:!0,configurable:!0}),r.__decorate([i.property({type:a,json:{write:!0}})],t.prototype,"attributeTable",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"bandCount",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"colormap",void 0),r.__decorate([i.property({type:String,readOnly:!0})],t.prototype,"dataType",null),r.__decorate([i.property({type:o,json:{write:!0}})],t.prototype,"extent",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"format",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"height",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"width",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"histograms",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"keyProperties",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"multidimensionalInfo",void 0),r.__decorate([i.property()],t.prototype,"noDataValue",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"pixelSize",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"pixelType",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"spatialReference",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"statistics",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"storageInfo",void 0),r.__decorate([i.subclass("esri.layers.support.RasterInfo")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},460:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(297),r(152),r(225),r(153),r(151),r(208),r(689),r(339),r(244),r(240),r(298),r(265),r(410),r(233),r(411)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,t)||this;return n.legendEnabled=!0,n.isReference=null,n.operationalLayerType="ArcGISImageServiceLayer",n.popupEnabled=!0,n.popupTemplate=null,n.type="imagery",n}return r.__extends(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?r.__assign({url:e},t):e},t.prototype.load=function(e){var t=this,r=i.isSome(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).then((function(){return t._fetchService(r)}),(function(){return t._fetchService(r)}))),a.resolve(this)},Object.defineProperty(t.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0}),t.prototype.createPopupTemplate=function(e){var t=this.rasterFields,n=this.title,i=new Set,o=!1,a=!1;this.capabilities&&(a=(o=this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0)&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType));var s=new Set;o&&(s.add("raster.itempixelvalue"),a&&s.add("raster.magnitude").add("raster.direction"));for(var l=0,u=t;l<u.length;l++){var p=u[l],c=p.name.toLowerCase();s.has(c)||c.indexOf("raster.servicepixelvalue.")>-1||i.add(p.name)}return g.createPopupTemplate({fields:t,title:n},r.__assign(r.__assign({},e),{visibleFieldNames:i}))},t.prototype.redraw=function(){this.emit("redraw")},r.__decorate([s.property(m.legendEnabled)],t.prototype,"legendEnabled",void 0),r.__decorate([s.property({type:["show","hide"]})],t.prototype,"listMode",void 0),r.__decorate([s.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],t.prototype,"isReference",void 0),r.__decorate([s.property({type:["ArcGISImageServiceLayer"]})],t.prototype,"operationalLayerType",void 0),r.__decorate([s.property(m.popupEnabled)],t.prototype,"popupEnabled",void 0),r.__decorate([s.property({type:n,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),r.__decorate([s.property({readOnly:!0,dependsOn:["fields","title"]})],t.prototype,"defaultPopupTemplate",null),r.__decorate([s.property({readOnly:!0,json:{read:!1}})],t.prototype,"type",void 0),r.__decorate([s.subclass("esri.layers.ImageryLayer")],t)}(y.TemporalLayer(f.RefreshableLayer(h.ScaleRangeLayer(c.OperationalLayer(d.PortalLayer(u.ArcGISImageService(p.ArcGISService(o.MultiOriginJSONMixin(l)))))))))}.apply(null,n))||(e.exports=i)},461:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(182),r(360)],void 0===(i=function(e,t,r,n){function i(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]>t[r]+2||e[r]<t[r]-2)return!1;return!0}function o(e,t,r){var i=n.toLAB(e),o=n.toLAB(t),a={l:i.l*(1-r)+r*o.l,a:i.a*(1-r)+r*o.a,b:i.b*(1-r)+r*o.b};return n.toRGB(a)}function a(e,n){if(e){var o,a=n||t.PREDEFINED_JSON_COLOR_RAMPS,s=null;return"algorithmic"===e.type?a.some((function(t){if(i(e.fromColor.toRgb(),t.fromColor)&&i(e.toColor.toRgb(),t.toColor))return s=t.id,!0})):"multipart"===e.type&&a.some((function(t){if(e.colorRamps&&t.colorRamps&&e.colorRamps.length===t.colorRamps.length&&(o=e.colorRamps,!t.colorRamps.some((function(e,t){if(!i(o[t].fromColor.toRgb(),new r(e.fromColor).toRgb())||!i(o[t].toColor.toRgb(),new r(e.toColor).toRgb()))return!0})))){if(s)return!0;s=t.id}})),s}}Object.defineProperty(t,"__esModule",{value:!0}),t.PREDEFINED_JSON_COLOR_RAMPS=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],t.PREDEFINED_COLOR_RAMP_NAME_MAP={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"},t.getColorRampId=a,t.getColorRampName=function(e){var r=a(e);return r?t.PREDEFINED_COLOR_RAMP_NAME_MAP[r]:null},t.convertColorRampToColormap=function(e,t){if(e&&t){for(var n,i,a,s,l,u="multipart"===e.type?e.colorRamps.length:1,p=[],c=[],d=0,f=0;f<u;f++)p[f]={start:null,end:null},p[f].start=d,p[f].end=d+1/u,d=p[f].end;var h=function(u){s=u/t,p.forEach((function(p,d){s>=p.start&&s<p.end&&(l=(s-p.start)/(p.end-p.start),"multipart"===e.type?(n=new r(e.colorRamps[d].fromColor),i=new r(e.colorRamps[d].toColor)):(n=new r(e.fromColor),i=new r(e.toColor)),a=o(n,i,l),0===u?c.push([u,n.r,n.g,n.b]):u===t-1?c.push([u,i.r,i.g,i.b]):(a=o(n,i,l),c.push([u,a.r,a.g,a.b])))}))};for(f=0;f<t;f++)h(f);return c}}}.apply(null,n))||(e.exports=i)},462:function(e,t,r){var n;void 0===(n=function(){var e=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var n=512;n<e;)n<<=1;for(var i=new Uint8Array(n),o=0;o<r;++o)i[o]=t[o];return this.buffer=i},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}();return function(){if(!self||!self.Uint32Array)return null;var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),n=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],o=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function a(e){throw new Error(e)}function s(t){var r=0,n=t[r++],i=t[r++];-1!=n&&-1!=i||a("Invalid header in flate stream"),8!=(15&n)&&a("Unknown compression method in flate stream"),((n<<8)+i)%31!=0&&a("Bad FCHECK in flate stream"),32&i&&a("FDICT bit set in flate stream"),this.bytes=t,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,e.call(this)}return s.prototype=Object.create(e.prototype),s.prototype.getBits=function(e){for(var t,r=this.codeSize,n=this.codeBuf,i=this.bytes,o=this.bytesPos;r<e;)void 0===(t=i[o++])&&a("Bad encoding in flate stream"),n|=t<<r,r+=8;return t=n&(1<<e)-1,this.codeBuf=n>>e,this.codeSize=r-=e,this.bytesPos=o,t},s.prototype.getCode=function(e){for(var t=e[0],r=e[1],n=this.codeSize,i=this.codeBuf,o=this.bytes,s=this.bytesPos;n<r;){var l;void 0===(l=o[s++])&&a("Bad encoding in flate stream"),i|=l<<n,n+=8}var u=t[i&(1<<r)-1],p=u>>16,c=65535&u;return(0==n||n<p||0==p)&&a("Bad encoding in flate stream"),this.codeBuf=i>>p,this.codeSize=n-p,this.bytesPos=s,c},s.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,n=0;n<t;++n)e[n]>r&&(r=e[n]);for(var i=1<<r,o=new Uint32Array(i),a=1,s=0,l=2;a<=r;++a,s<<=1,l<<=1)for(var u=0;u<t;++u)if(e[u]==a){var p=0,c=s;for(n=0;n<a;++n)p=p<<1|1&c,c>>=1;for(n=p;n<i;n+=l)o[n]=a<<16|u;++s}return[o,r]},s.prototype.readBlock=function(){function e(e,t,r,n,i){for(var o=e.getBits(r)+n;o-- >0;)t[h++]=i}var s=this.getBits(3);if(1&s&&(this.eof=!0),0!=(s>>=1)){var l,u;if(1==s)l=i,u=o;else if(2==s){for(var p=this.getBits(5)+257,c=this.getBits(5)+1,d=this.getBits(4)+4,f=Array(t.length),h=0;h<d;)f[t[h++]]=this.getBits(3);for(var y=this.generateHuffmanTable(f),m=0,g=(h=0,p+c),v=new Array(g);h<g;){var _=this.getCode(y);16==_?e(this,v,2,3,m):17==_?e(this,v,3,3,m=0):18==_?e(this,v,7,11,m=0):v[h++]=m=_}l=this.generateHuffmanTable(v.slice(0,p)),u=this.generateHuffmanTable(v.slice(p,g))}else a("Unknown block type in flate stream");for(var b=(O=this.buffer)?O.length:0,w=this.bufferLength;;){var S=this.getCode(l);if(S<256)w+1>=b&&(b=(O=this.ensureBuffer(w+1)).length),O[w++]=S;else{if(256==S)return void(this.bufferLength=w);var x=(S=r[S-=257])>>16;x>0&&(x=this.getBits(x)),m=(65535&S)+x,S=this.getCode(u),(x=(S=n[S])>>16)>0&&(x=this.getBits(x));var I=(65535&S)+x;w+m>=b&&(b=(O=this.ensureBuffer(w+m)).length);for(var R=0;R<m;++R,++w)O[w]=O[w-I]}}}else{var T,C=this.bytes,P=this.bytesPos;void 0===(T=C[P++])&&a("Bad block header in flate stream");var L=T;void 0===(T=C[P++])&&a("Bad block header in flate stream"),L|=T<<8,void 0===(T=C[P++])&&a("Bad block header in flate stream");var k=T;void 0===(T=C[P++])&&a("Bad block header in flate stream"),(k|=T<<8)!=(65535&~L)&&a("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var M=this.bufferLength,O=this.ensureBuffer(M+L),E=M+L;this.bufferLength=E;for(var A=M;A<E;++A){if(void 0===(T=C[P++])){this.eof=!0;break}O[A]=T}this.bytesPos=P}},s}()}.apply(null,[]))||(e.exports=n)},463:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(151),r(327),r(348),r(829),r(990),r(527),r(187),r(199),r(584)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.source=null,r.sourceSpatialReference=null,r}return r.__extends(t,e),t.prototype.execute=function(e,t){return this.executeJSON(e,t).then((function(e){return p.fromJSON(e)}))},t.prototype.executeJSON=function(e,t){return a.executeQuery(this.parsedUrl,this._normalizeQuery(e),this.sourceSpatialReference,r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){return e.data}))},t.prototype.executeForCount=function(e,t){return a.executeQueryForCount(this.parsedUrl,this._normalizeQuery(e),r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){return e.data.count}))},t.prototype.executeForExtent=function(e,t){return a.executeQueryForExtent(this.parsedUrl,this._normalizeQuery(e),r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){return{count:e.data.count,extent:n.Extent.fromJSON(e.data.extent)}}))},t.prototype.executeForIds=function(e,t){return a.executeQueryForIds(this.parsedUrl,this._normalizeQuery(e),r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){return e.data.objectIds}))},t.prototype.executeRelationshipQuery=function(e,t){return e=d.from(e),(this.gdbVersion||this.source)&&(e=e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source})),l.executeRelationshipQuery(this.parsedUrl,e,r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=p.fromJSON(t[e])})),r}))},t.prototype.executeAttachmentQuery=function(e,t){var n=this;return s.executeAttachmentQuery(this.parsedUrl,u.from(e),r.__assign(r.__assign({},this.requestOptions),t)).then((function(e){return s.processAttachmentQueryResult(e.data.attachmentGroups,n.parsedUrl.path)}))},t.prototype._normalizeQuery=function(e){var t=c.from(e);return this.gdbVersion||this.source?(t===e?t.clone():t).set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source}):t},r.__decorate([i.property()],t.prototype,"gdbVersion",void 0),r.__decorate([i.property()],t.prototype,"source",void 0),r.__decorate([i.property()],t.prototype,"sourceSpatialReference",void 0),r.__decorate([i.subclass("esri.tasks.QueryTask")],t)}(o)}.apply(null,n))||(e.exports=i)},501:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]},t.getPathSymbolShapes=function(e){var t=22,r=22;return e<1?t*=.75:e>1&&(r*=1.25),[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,r-11]},{command:"L",values:[t-11,r-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[t-11,22]},{command:"L",values:[t-11,r-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[t-11,r-11]},{command:"L",values:[0,r-11]},{command:"L",values:[0,22]},{command:"L",values:[t-11,22]},{command:"Z",values:[]}]}]},t.getExtrudeSymbolShapes=function(e){var t=.5*e;return[{type:"path",path:[{command:"M",values:[0,22*.7*.5]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+t]},{command:"L",values:[0,22*.7+t-22*.7*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+t]},{command:"L",values:[22,t]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,22*.7*.5]},{command:"Z",values:[]}]}]},t.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]},t.getCubeShapes=function(e,t){var r=t?20:e,n=t?4:6,i=(r-=r<=22?.5*n:n,t?.35*r:.5*r);return[{type:"path",path:[{command:"M",values:[.5*r,0]},{command:"L",values:[r,.5*i]},{command:"L",values:[.5*r,i]},{command:"L",values:[0,.5*i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*i]},{command:"L",values:[.5*r,i]},{command:"L",values:[.5*r,e]},{command:"L",values:[0,e-.5*i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*r,i]},{command:"L",values:[.5*r,e]},{command:"L",values:[r,e-.5*i]},{command:"L",values:[r,.5*i]},{command:"Z",values:[]}]}]},t.getCylinderShapes=function(e,t){var r=t?20:e,n=t?4:6,i=.5*(r-=r<=22?.5*n:n),o=.15*r,a=e-o;return[{type:"ellipse",cx:.5*r,cy:a,rx:i,ry:o},{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[0,a]},{command:"L",values:[r,a]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*r,cy:o,rx:i,ry:o}]},t.getConeShapes=function(e,t){var r=t?20:e,n=t?4:6,i=.15*(r-=r<=22?.5*n:n),o=e-i;return[{type:"ellipse",cx:.5*r,cy:o,rx:.5*r,ry:i},{type:"path",path:[{command:"M",values:[.5*r,0]},{command:"L",values:[r,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]},t.getInvertedConeShapes=function(e){var t=e,r=.15*(t-=t<22?3:6);return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[t,0]},{command:"L",values:[.5*t,e-r]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:0,rx:.5*t,ry:r}]},t.getDiamondShapes=function(e){var t=e,r=e,n=t-=t<22?2:4,i=r,o=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*n,0]},{command:"L",values:[n,.5*i-o]},{command:"L",values:[.45*n-o,.5*i+o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*n,0]},{command:"L",values:[.45*n-o,.5*i+o]},{command:"L",values:[0,.5*i-o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*i-o]},{command:"L",values:[.45*n-o,.5*i+o]},{command:"L",values:[.45*n,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*n,r]},{command:"L",values:[n,.5*i-o]},{command:"L",values:[.45*n-o,.5*i+o]},{command:"Z",values:[]}]}]},t.getTetrahedronShapes=function(e){var t=e;return[{type:"path",path:[{command:"M",values:[.45*e,0]},{command:"L",values:[e,t-=t<22?1:2]},{command:"L",values:[.45*e,.6*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,0]},{command:"L",values:[.45*e,.6*t]},{command:"L",values:[0,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[.45*e,.6*t]},{command:"L",values:[e,t]},{command:"Z",values:[]}]}]}}.apply(null,n))||(e.exports=i)},502:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(336),r(165),r(360),r(154),r(164),r(153),r(621),r(396)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var p=l.createProjector();function c(e,t,r,n,o){switch(o){case"multiply":e[t+0]*=r[0],e[t+1]*=r[1],e[t+2]*=r[2],e[t+3]*=r[3];break;default:var a=i.toHSV({r:e[t+0],g:e[t+1],b:e[t+2]});a.h=n.h,a.s=n.s,a.v=a.v/100*n.v;var s=i.toRGB(a);e[t+0]=s.r,e[t+1]=s.g,e[t+2]=s.b,e[t+3]*=r[3]}}t.renderSymbol=function(e,t,r){var n=Math.ceil(t[0]),i=Math.ceil(t[1]);if(!e.some((function(e){return!!e.length})))return null;var o=r&&r.node||document.createElement("div");return null!=r.opacity&&(o.style.opacity=r.opacity.toString()),p.append(o,u.renderSVG.bind(null,e,n,i,r)),o},t.tintImageWithColor=function(e,t,l,u,p){return function(e,t,r){return e?n(e,{responseType:"image"}).then((function(e){var n=e.data,i=n.width,o=n.height,a=i/o,s=t;if(r){var l=Math.max(i,o);s=Math.min(s,l)}return{image:n,width:a<=1?Math.ceil(s*a):s,height:a<=1?s:Math.ceil(s/a)}})):s.reject(new o("renderUtils: imageDataSize","href not provided."))}(e,t,p).then((function(n){var o=n.width?n.width:t,s=n.height?n.height:t;if(n.image&&function(e,t){return!(!e||"ignore"===t||"multiply"===t&&255===e.r&&255===e.g&&255===e.b&&1===e.a)}(l,u)){var p=n.image.width,d=n.image.height;(a("edge")||a("ie"))&&/\.svg$/i.test(e)&&(p-=1,d-=1);var f=function(e,t){e=Math.ceil(e),t=Math.ceil(t);var r=document.createElement("canvas");r.width=e,r.height=t,r.style.width=e+"px",r.style.height=t+"px";var n=r.getContext("2d");return n.clearRect(0,0,e,t),n}(o,s);f.drawImage(n.image,0,0,p,d,0,0,o,s);for(var h=f.getImageData(0,0,o,s),y=[l.r/255,l.g/255,l.b/255,l.a],m=i.toHSV(l),g=0;g<h.data.length;g+=4)c(h.data,g,y,m,u);f.putImageData(h,0,0),e=f.canvas.toDataURL("image/png")}else{var v=r.id&&r.id.findCredential(e);if(v&&v.token){var _=-1===e.indexOf("?")?"?":"&";e=""+e+_+"token="+v.token}}return{url:e,width:o,height:s}})).catch((function(){return{url:e,width:t,height:t}}))}}.apply(null,n))||(e.exports=i)},503:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(271),r(360),r(177),r(154),r(156),r(152),r(153),r(171),r(420),r(627),r(577),r(501),r(502),r(633),r(357)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g){Object.defineProperty(t,"__esModule",{value:!0});var v=n.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png"),_=s.getLogger("esri.symbols.support.previewSymbol3D");function b(e){var t=e.outline,r=l.isSome(e.material)?e.material.color:null,n=l.isSome(r)?r.toRgba().toString():null;if(l.isNone(t))return"fill"===e.type&&"255,255,255,1"===n?{color:"#bdc3c7",width:.75}:null;var i=p.pt2px(t.size)||0;return{color:"rgba("+(l.isSome(t.color)?t.color.toRgba():"255,255,255,1")+")",width:Math.min(i,80)}}function w(e,t){void 0===t&&(t=1);var r=e.a,n=i.toHSV(e),o=n.h,a=n.s/t,s=100-(100-n.v)/t,l=i.toRGB({h:o,s:a,v:s});return[l.r,l.g,l.b,r]}function S(e,t){return Math.round(Math.min(Math.max(e+255*t*.75,0),255))}function x(e){return"water"===e.type?l.isNone(e.color)?null:e.color:l.isNone(e.material)||l.isNone(e.material.color)?null:e.material.color}function I(e,t){void 0===t&&(t=0);var r=x(e);if(!r){var n=S(c.defaultThematicColor.r,t);return[n,n,n,100]}for(var i=r.toRgba(),o=0;o<3;o++)i[o]=S(i[o],t);return i}function R(e){return e.outline?b(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function T(e,t){var r=x(e);if(!r)return null;var n="rgba(";return n+=S(r.r,t)+",",n+=S(r.g,t)+",",(n+=S(r.b,t)+",")+r.a+");"}function C(e,t){var r=T(e,t);return r?{color:r,width:Math.min(e.size?p.pt2px(e.size):.75,80)}:{}}function P(e,t,r){var n=.75*r;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}t.getSymbolLayerFill=I,t.previewSymbol3D=function(e,t){if(0===e.symbolLayers.length)return u.reject(new a("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var n=null;switch(e.type){case"point-3d":n=function(e,t){var r,n=t&&t.size?p.pt2px(t.size):null,i=t&&t.maxSize?p.pt2px(t.maxSize):null,a=t&&t.disableUpsampling,s=e.symbolLayers,l=[],c=0,w=0,S=s.getItemAt(s.length-1);return S&&"icon"===S.type&&(r=S.size&&p.pt2px(S.size)),s.forEach((function(s){if("icon"===s.type||"object"===s.type){var _="icon"===s.type?s.size&&p.pt2px(s.size):0,S=n||_?Math.ceil(Math.min(n||_,i||120)):22;if(s&&s.resource&&s.resource.href){var x=function(e,t){var r=t&&t.resource,n=r&&r.href;return e.thumbnail&&e.thumbnail.url?u.resolve(e.thumbnail.url):n&&"object"!==t.type?u.resolve(g.getIconHref(e,t)):e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)?m.resolveWebStyleSymbol(e.styleOrigin,{portal:e.styleOrigin.portal},"webRef").catch((function(e){return e})).then((function(e){return e&&e.thumbnail&&e.thumbnail.url||v})):u.resolve(v)}(e,s).then((function(e){var t=s.get("material.color"),r=function(e){return"icon"===e.type?"multiply":"tint"}(s);return y.tintImageWithColor(e,S,t,r,a)})).then((function(e){var t=e.width,r=e.height;return c=Math.max(c,t),w=Math.max(w,r),[{shape:{type:"image",x:0,y:0,width:t,height:r,src:e.url},fill:null,stroke:null}]}));l.push(x)}else{var T=S;"icon"===s.type&&r&&n&&(T=S*(_/r));var C=t&&"tall"===t.symbolConfig||"object"===s.type&&function(e){var t=e.depth,r=e.height,n=e.width;return n&&t&&r&&n===t&&n<r}(s);c=Math.max(c,C?20:T),w=Math.max(w,T),l.push(u.resolve(function(e,t,r){var n=[];if(!e)return n;switch(e.type){case"icon":var i=t,a=t;switch(s=e.resource&&e.resource.primitive||d.defaultPrimitive){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:I(e,0),stroke:b(e)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[i,0]},{command:"L",values:[i,a]},{command:"Z",values:[]}]},fill:I(e,0),stroke:b(e)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*i,0]},{command:"L",values:[i,a]},{command:"Z",values:[]}]},fill:I(e,0),stroke:b(e)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[.5*i,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[i,.5*a]}]},stroke:R(e)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[i,a]},{command:"M",values:[i,0]},{command:"L",values:[0,a]}]},stroke:R(e)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*i,0]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"Z",values:[]}]},fill:I(e,0),stroke:b(e)});break;default:o.neverReached(s)}break;case"object":var s;switch(s=e.resource&&e.resource.primitive||f.defaultPrimitive){case"cone":var l=P(I(e,0),I(e,-.6),r?20:t),u=h.getConeShapes(t,r);n.push({shape:u[0],fill:l}),n.push({shape:u[1],fill:l});break;case"inverted-cone":var p=I(e,0),c=P(p,I(e,-.6),t),y=h.getInvertedConeShapes(t);n.push({shape:y[0],fill:c}),n.push({shape:y[1],fill:p});break;case"cube":var m=h.getCubeShapes(t,r);n.push({shape:m[0],fill:I(e,0)}),n.push({shape:m[1],fill:I(e,-.3)}),n.push({shape:m[2],fill:I(e,-.5)});break;case"cylinder":var g=P(I(e,0),I(e,-.6),r?20:t),v=h.getCylinderShapes(t,r);n.push({shape:v[0],fill:g}),n.push({shape:v[1],fill:g}),n.push({shape:v[2],fill:I(e,0)});break;case"diamond":var _=h.getDiamondShapes(t);n.push({shape:_[0],fill:I(e,-.3)}),n.push({shape:_[1],fill:I(e,0)}),n.push({shape:_[2],fill:I(e,-.3)}),n.push({shape:_[3],fill:I(e,-.7)});break;case"sphere":var w=P(I(e,0),I(e,-.6));w.x1=0,w.y1=0,w.x2=.25*t,w.y2=.25*t,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:w});break;case"tetrahedron":var S=h.getTetrahedronShapes(t);n.push({shape:S[0],fill:I(e,-.3)}),n.push({shape:S[1],fill:I(e,0)}),n.push({shape:S[2],fill:I(e,-.6)});break;default:o.neverReached(s)}}return n}(s,T,C)))}}})),u.eachAlways(l).then((function(e){var r=[];return e.forEach((function(e){e.value?r.push(e.value):e.error&&_.warn("error while building swatchInfo!",e.error)})),y.renderSymbol(r,[c,w],{node:t&&t.node,scale:!1,opacity:t&&t.opacity})}))}(e,t);break;case"line-3d":n=function(e,t){var n,i=e.symbolLayers,o=[],a=g.isVolumetricSymbol(e),s=t&&t.size?p.pt2px(t.size):null,l=(t&&t.maxSize?p.pt2px(t.maxSize):null)||80,c=0,d=0;return i.forEach((function(e,t){if(e&&("line"===e.type||"path"===e.type)){var i=[];switch(e.type){case"line":var a=(_=C(e,0))&&_.width||0;0===t&&(n=a);var u=Math.min(s||a,l),p=0===t?u:s?u*(a/n):u,f=p>20?2*p:40;d=Math.max(d,p),c=Math.max(c,f),_.width=p,i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[c,.5*d]}]},stroke:_});break;case"path":var y=Math.min(s||22,l),m=I(e,0),g=I(e,-.2),v=T(e,-.4),_=v?{color:v,width:1}:{};if("quad"===e.profile){var b=e.width||e.size,w=e.height||e.size,S=b&&w?b/w:1,x=h.getPathSymbolShapes(S),R=r.__assign(r.__assign({},_),{join:"bevel"});i.push({shape:x[0],fill:g,stroke:R}),i.push({shape:x[1],fill:g,stroke:R}),i.push({shape:x[2],fill:m,stroke:R})}else i.push({shape:h.shapes.pathSymbol3DLayer[0],fill:g,stroke:_}),i.push({shape:h.shapes.pathSymbol3DLayer[1],fill:m,stroke:_});d=Math.max(d,y),c=d}o.push(i)}})),u.resolve(y.renderSymbol(o,[c,d],{node:t&&t.node,scale:a,opacity:t&&t.opacity}))}(e,t);break;case"polygon-3d":case"mesh-3d":n=function(e,t){for(var n="mesh-3d"===e.type,i=e.symbolLayers,o=t&&t.size?p.pt2px(t.size):null,a=t&&t.maxSize?p.pt2px(t.maxSize):null,s=o||22,l=[],c=0,d=0,f=!1,m=0;m<i.length;m++){var g=i.getItemAt(m),v=[];if(!n||"fill"===g.type){var _=h.shapes.fill[0];switch(g.type){case"fill":var S=b(g),R=Math.min(s,a||120);c=Math.max(c,R),d=Math.max(d,R),f=!0,v.push({shape:_,fill:I(g,0),stroke:S});break;case"line":var T={stroke:C(g,0),shape:_};c=Math.max(c,22),d=Math.max(d,22),v.push(T);break;case"extrude":var P=r.__assign({join:"round"},C(g,-.4)),L=I(g,0),k=I(g,-.2),M=Math.min(s,a||120),O=h.getExtrudeSymbolShapes(M);P.width=1,v.push({shape:O[0],fill:k,stroke:P}),v.push({shape:O[1],fill:k,stroke:P}),v.push({shape:O[2],fill:L,stroke:P});var E=22*.7+.5*M;c=Math.max(c,22),d=Math.max(d,E);break;case"water":var A=x(g),D=(L=w(A),w(A,2)),N=w(A,3),F=h.getWaterSymbolShapes();f=!0,v.push({shape:F[0],fill:L}),v.push({shape:F[1],fill:D}),v.push({shape:F[2],fill:N}),R=Math.min(s,a||120),c=Math.max(c,R),d=Math.max(d,R)}l.push(v)}}return u.resolve(y.renderSymbol(l,[c,d],{node:t&&t.node,scale:f,opacity:t&&t.opacity}))}(e,t)}return n||u.reject(new a("symbolPreview: swatchInfo3D","symbol not supported."))}}.apply(null,n))||(e.exports=i)},504:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(396),r(183)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i="esri-relationship-ramp--diamond__middle-column--label",o="esri-relationship-ramp--square__table-row",a="esri-relationship-ramp--square__table-cell",s="esri-relationship-ramp--square__table-label";function l(e,t,r){var n=r+"_arrowStart",i=r+"_arrowEnd",o="left"===e,a={markerStart:null,markerEnd:null};switch(t){case"HL":o?a.markerStart="url(#"+i+")":a.markerEnd="url(#"+n+")";break;case"LL":a.markerStart="url(#"+i+")";break;case"LH":o?a.markerEnd="url(#"+n+")":a.markerStart="url(#"+i+")";break;default:a.markerEnd="url(#"+n+")"}return a}t.renderRelationshipRamp=function(e,t,u){var p=e.focus,c=e.labels,d=!!p,f=function(e,t,i,o){void 0===o&&(o=60);var s=e.focus,u=e.numClasses,p=e.colors,c=e.rotation,d=!!s,f=Math.sqrt(Math.pow(o,2)+Math.pow(o,2))+(d?0:5),h=null;null!=i&&(h="opacity: "+i);for(var y=[],m=[],g=[],v=(o||75)/u,_=0;_<u;_++)for(var b=_*v,w=0;w<u;w++){var S=w*v,x=r.generateFillAttributes(p[_][w]),I=r.generateStrokeAttributes(null),R={type:"rect",x:S,y:b,width:v,height:v};y.push(r.renderDef(x)),m.push(r.renderShape(R,x.fill,I,null)),g.push(r.getBoundingBox(R))}var T=null;d||(T="margin: -15px -15px -18px -15px");var C=l("left",s,t),P=l("right",s,t),L=r.computeBBox(g),k=r.getTransformMatrix(L,f,f,0,!1,c),M=r.getTransformMatrix(L,f,f,0,!1,d?-45:null);return n.tsx("div",{style:h,class:d?"esri-relationship-ramp--diamond__middle-column--ramp":a},n.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:f,height:f,style:T},n.tsx("defs",null,n.tsx("marker",{id:t+"_arrowStart",markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},n.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),n.tsx("marker",{id:t+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},n.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),y),n.tsx("g",{transform:k},m),n.tsx("g",{transform:M},n.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:-10,y1:o-15,x2:-10,y2:15}),n.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":P.markerStart,"marker-end":P.markerEnd,x1:15,y1:o+10,x2:o-15,y2:o+10}))))}(e,t,u);return d?n.tsx("div",{class:"esri-relationship-ramp--diamond__container"},n.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},c.left),n.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},n.tsx("div",{class:i},c.top),f,n.tsx("div",{class:i},c.bottom)),n.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},c.right)):n.tsx("div",{class:"esri-relationship-ramp--square__table"},n.tsx("div",{class:o},n.tsx("div",{class:n.classes(a,s,"esri-relationship-ramp--square__table-label--right-bottom")},c.left),n.tsx("div",{class:a}),n.tsx("div",{class:n.classes(a,s,"esri-relationship-ramp--square__table-label--left-bottom")},c.top)),n.tsx("div",{class:o},n.tsx("div",{class:a}),f,n.tsx("div",{class:a})),n.tsx("div",{class:o},n.tsx("div",{class:n.classes(a,s,"esri-relationship-ramp--square__table-label--right-top")},c.bottom),n.tsx("div",{class:a}),n.tsx("div",{class:n.classes(a,s,"esri-relationship-ramp--square__table-label--left-top")},c.right)))}}.apply(null,n))||(e.exports=i)},505:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(258)],void 0===(i=function(e,t,r){function n(e,t){return!t}Object.defineProperty(t,"__esModule",{value:!0}),t.attachToNode=function(e){e.appendChild(this)},t.getTitle=function(e,t,i){if(t){if("string"==typeof t)return t;if("value"in t||"unit"in t)return r.substitute(e.dotValue,t);if("colorName"in t||"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:null;var o=null;return function(e,t){return t}(0,i)?o=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:n(0,i)&&(o=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),o?r.substitute("showField"===o?"{field}":e[o],{field:t.field,normField:t.normField}):null}},t.isRendererTitle=n,t.isImageryStretchedLegend=function(e,t){return!!(t&&"Stretched"===t&&e.version>=10.3&&"esri.layers.ImageryLayer"===e.declaredClass)}}.apply(null,n))||(e.exports=i)},507:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(118),r(151)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){return e.call(this,t)||this}var n;return r.__extends(t,e),n=t,t.prototype.clone=function(){return new n({customLayerParameters:i.clone(this.customLayerParameters),customParameters:i.clone(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})},r.__decorate([o.property({json:{type:Object,write:!0}})],t.prototype,"customLayerParameters",void 0),r.__decorate([o.property({json:{type:Object,write:!0}})],t.prototype,"customParameters",void 0),r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"layerIdentifier",void 0),r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"tileMatrixSet",void 0),r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"url",void 0),n=r.__decorate([o.subclass("esri.layer.support.WMTSLayerInfo")],t)}(n.JSONSupport);t.WMTSLayerInfo=a,t.default=a}.apply(null,n))||(e.exports=i)},508:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(154),r(236),r(489),r(152),r(225),r(153),r(151),r(179),r(475),r(491),r(208),r(904),r(339),r(244),r(240),r(298),r(265),r(905),r(410),r(233),r(378),r(438),r(439)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b,w,S,x,I,R,T){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,t)||this;return n.alwaysRefetch=!1,n.dpi=96,n.gdbVersion=null,n.imageFormat="png24",n.imageMaxHeight=2048,n.imageMaxWidth=2048,n.imageTransparency=!0,n.labelsVisible=!1,n.isReference=null,n.operationalLayerType="ArcGISMapServiceLayer",n.sourceJSON=null,n.sublayers=null,n.type="map-image",n.url=null,n}return r.__extends(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?r.__assign({url:e},t):e},t.prototype.load=function(e){var t=this,r=s.isSome(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then((function(){return t._fetchService(r)}),(function(){return t._fetchService(r)}))),u.resolve(this)},t.prototype.readImageFormat=function(e,t){var r=t.supportedImageFormatTypes;return r&&r.indexOf("PNG32")>-1?"png32":"png24"},t.prototype.writeSublayers=function(e,t,n,i){if(this.loaded&&e){var o=e.slice().reverse().flatten((function(e){var t=e.sublayers;return t&&t.toArray().reverse()})).toArray(),a=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){var s=d.nameToId(i.origin);if(3===s){var l=this.createSublayersForOrigin("service").sublayers;a=T.shouldWriteSublayerStructure(o,l,2)}else if(s>3){var u=this.createSublayersForOrigin("portal-item");a=T.shouldWriteSublayerStructure(o,u.sublayers,d.nameToId(u.origin))}}var p=[],c=r.__assign({writeSublayerStructure:a},i),f=a;o.forEach((function(e){var t=e.write({},c);p.push(t),f=f||"user"===e.originOf("visible")})),p.some((function(e){return Object.keys(e).length>1}))&&(t.layers=p),f&&(t.visibleLayers=o.filter((function(e){return e.visible})).map((function(e){return e.id})))}},t.prototype.createExportImageParameters=function(e,t,n,i){var o=i&&i.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());var a=new I.ExportImageParameters({layer:this,scale:f.getScale({extent:e,width:t})*o}),s=a.toJSON();a.layer=null,a.destroy();var l=!i||!i.rotation||this.version<10.3?{}:{rotation:-i.rotation},u=e&&e.spatialReference,p=u.wkid||JSON.stringify(u.toJSON());s.dpi*=o;var c={};if(null==i?void 0:i.timeExtent){var d=i.timeExtent.toJSON(),h=d.start,y=d.end;c.time=h&&y&&h===y?""+h:(null==h?"null":h)+","+(null==y?"null":y)}else this.timeInfo&&!this.timeInfo.hasLiveData&&(c.time="null,null");return r.__assign(r.__assign(r.__assign({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:p,imageSR:p,size:t+","+n},s),l),c)},t.prototype.fetchImage=function(e,t,o,a){return r.__awaiter(this,void 0,void 0,(function(){var s,l,p;return r.__generator(this,(function(c){return s={responseType:"image"},a&&a.timestamp&&(s.query={_ts:a.timestamp}),a&&a.signal&&(s.signal=a.signal),l=this.parsedUrl.path+"/export",null==(p=r.__assign(r.__assign(r.__assign({},this.parsedUrl.query),this.createExportImageParameters(e,t,o,a)),{f:"image",_ts:this.alwaysRefetch?Date.now():null})).dynamicLayers||this.capabilities.exportMap.supportsDynamicLayers?(s.query?s.query=r.__assign(r.__assign({},p),s.query):s.query=p,[2,n(l,s).then((function(e){return e.data})).catch((function(e){if(u.isAbortError(e))throw e;throw new i("mapimagelayer:image-fetch-error","Unable to load image: "+l,{error:e})}))]):[2,u.reject(new i("mapimagelayer:dynamiclayer-not-supported","service "+this.url+" doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.",{query:p}))]}))}))},t.prototype.loadAll=function(){var e=this;return a.default(this,(function(t){t(e.allSublayers)}))},t.prototype._fetchService=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i;return r.__generator(this,(function(o){switch(o.label){case 0:return this.sourceJSON?(this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl}),[2]):[4,n(this.parsedUrl.path,{query:r.__assign({f:"json"},this.parsedUrl.query),signal:e})];case 1:return t=o.sent(),i=t.data,t.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=i,this.read(i,{origin:"service",url:this.parsedUrl}),[2]}}))}))},r.__decorate([p.property()],t.prototype,"alwaysRefetch",void 0),r.__decorate([p.property()],t.prototype,"dpi",void 0),r.__decorate([p.property()],t.prototype,"gdbVersion",void 0),r.__decorate([p.property({json:{read:!1,write:!1}})],t.prototype,"popupEnabled",void 0),r.__decorate([p.property()],t.prototype,"imageFormat",void 0),r.__decorate([p.reader("imageFormat",["supportedImageFormatTypes"])],t.prototype,"readImageFormat",null),r.__decorate([p.property({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],t.prototype,"imageMaxHeight",void 0),r.__decorate([p.property({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],t.prototype,"imageMaxWidth",void 0),r.__decorate([p.property()],t.prototype,"imageTransparency",void 0),r.__decorate([p.property({json:{read:!1,write:!1}})],t.prototype,"labelsVisible",void 0),r.__decorate([p.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],t.prototype,"isReference",void 0),r.__decorate([p.property({type:["ArcGISMapServiceLayer"]})],t.prototype,"operationalLayerType",void 0),r.__decorate([p.property()],t.prototype,"sourceJSON",void 0),r.__decorate([p.property({json:{write:{ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),r.__decorate([p.writer("sublayers",{layers:{type:[R]},visibleLayers:{type:[c.Integer]}})],t.prototype,"writeSublayers",null),r.__decorate([p.property({type:["show","hide","hide-children"]})],t.prototype,"listMode",void 0),r.__decorate([p.property({json:{read:!1},readOnly:!0,value:"map-image"})],t.prototype,"type",void 0),r.__decorate([p.property(x.url)],t.prototype,"url",void 0),r.__decorate([p.subclass("esri.layers.MapImageLayer")],t)}(S.TemporalLayer(b.ScaleRangeLayer(_.RefreshableLayer(w.SublayersOwner(y.ArcGISMapService(m.ArcGISService(g.OperationalLayer(v.PortalLayer(l.MultiOriginJSONMixin(o.HandleOwnerMixin(h)))))))))))}.apply(null,n))||(e.exports=i)},549:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(166)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.stretchTypeJSONDict=new r.default({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),t.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"}}.apply(null,n))||(e.exports=i)},550:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(154),r(153),r(305),r(267)],void 0===(i=function(e,t,r,n,i,o,a){return function(){function e(){this._workerThread=null,this._destroyed=!1}return e.prototype.initialize=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,o.open("RasterWorker")];case 1:return e=t.sent(),this._destroyed?e.close():this._workerThread=e,[2]}}))}))},e.prototype.destroy=function(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)},e.prototype.decode=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:if(!this._workerThread)throw new n("raster-jobhandler:no-connection","no available worker connection");return[4,this._workerThread.invoke("decode",e,t)];case 1:return[2,(i=r.sent())?new a(i):null]}}))}))},e.prototype.symbolize=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:if(!this._workerThread)throw new n("raster-jobhandler:no-connection","no available worker connection");return i={extent:e.extent&&e.extent.toJSON(),pixelBlock:e.pixelBlock.toJSON(),simpleStretchParams:e.simpleStretchParams,bandIds:e.bandIds},[4,this._workerThread.invoke("symbolize",i,t)];case 1:return[2,(o=r.sent())?new a(o):null]}}))}))},e.prototype.updateSymbolizer=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:if(!this._workerThread)throw new n("raster-jobhandler:no-connection","no available worker connection");return o=e&&e.renderer&&"raster-stretch"===e.renderer.type&&e.renderer.histograms,[4,i.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:e.toJSON(),histograms:o},t))];case 1:return r.sent(),[2]}}))}))},e.prototype.stretch=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:if(!this._workerThread)throw new n("raster-jobhandler:no-connection","no available worker connection");return e&&e.pixelBlock?(i={srcPixelBlock:e.pixelBlock.toJSON(),stretchParams:e.stretchParams},[4,this._workerThread.invoke("stretch",i,t)]):[2,null];case 1:return[2,(o=r.sent())?new a(o):null]}}))}))},e.prototype.mosaicAndTransform=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(s){switch(s.label){case 0:if(!this._workerThread)throw new n("raster-jobhandler:no-connection","no available worker connection");return e&&e.srcPixelBlocks&&e.srcPixelBlocks.length>0?(i=r.__assign(r.__assign({},e),{srcPixelBlocks:e.srcPixelBlocks.map((function(e){return e?e.toJSON():null}))}),[4,this._workerThread.invoke("mosaicAndTransform",i,t)]):[2,null];case 1:return[2,(o=s.sent())?new a(o):null]}}))}))},e}()}.apply(null,n))||(e.exports=i)},603:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(154),r(267),r(983),r(984),r(985),r(692),r(986),r(987),r(826)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){var d,f,h=(d=new ArrayBuffer(4),f=new Uint8Array(d),new Uint32Array(d)[0]=1,1===f[0]);function y(e,t){if(!h)throw new n("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,o,a=t.width,s=t.height,u=t.pixelType,p=x(u),c=p.pixelTypeCtor,d=null==t.noDataValue?p.noDataValue:t.noDataValue,f=0,y=0,m=e.byteLength-10;y<m;){var g=l.decode(e,{inputOffset:y,encodedMaskData:r,returnMask:0===f,returnEncodedMask:0===f,returnFileInfo:!0,pixelType:c,noDataValue:d});if(a&&s&&(g.width!==a||g.height!==s))throw new n("rasterCoded:decode","lerc decoded result has width or height different from specified in options");if(y=g.fileInfo.eofOffset,0===f&&(r=g.encodedMaskData,o=new i({width:g.width,height:g.height,pixels:[],pixelType:u,mask:g.maskData,statistics:[]})),f++,o.addData({pixels:g.pixelData,statistics:{minValue:g.minValue,maxValue:g.maxValue,noDataValue:g.noDataValue}}),m-y>10){var v=String.fromCharCode.apply(null,new Uint8Array(e,y,10));y=y+v.indexOf("CntZ")>-1?v.indexOf("CntZ"):0}}return o}function m(e,t){if(!h)throw new n("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,o,a,l=0,u=0,p=0,c=e.byteLength-10,d=[],f=t.width,y=t.height;u<c;){if(o=s.decode(e,{inputOffset:u,maskData:r,returnFileInfo:!0}),f&&y&&(o.width!==f||o.height!==y))throw new n("rasterCoded:decode","lerc2 decoded result has width or height different from what's specified in options");if(u=o.fileInfo.eofOffset,0===l&&(p=o.fileInfo.numValidPixel,r=o.maskData,a=new i({width:o.width,height:o.height,pixels:[],pixelType:o.fileInfo.pixelType,mask:o.maskData,statistics:[]})),o.fileInfo.mask&&o.fileInfo.mask.numBytes>0&&d.push(o.maskData),l++,a.addData({pixels:o.pixelData,statistics:{minValue:o.minValue,maxValue:o.maxValue}}),c-u>10){var m=String.fromCharCode.apply(null,new Uint8Array(e,u,10));u+=m.indexOf("Lerc")>-1?m.indexOf("Lerc"):0}}var g=0,v=0,_=0;if(d.length>1){for(_=a.width*a.height,(r=new Uint8Array(_)).set(d[0]),g=1;g<d.length;g++){var b=d[g];for(v=0;v<_;v++)r[v]=r[v]&b[v]}for(p=0,v=0;v<_;v++)p+=r[v];a.mask=r}return a.validPixelCount=p,a}function g(e){var t=c.decode(e),r=new i({width:t.width,height:t.height,pixels:t.pixels,pixelType:t.pixelType.toLowerCase(),mask:t.mask,statistics:null});return r.updateStatistics(),r}function v(e,t){var r=c.decodeTileOrStrip(e,t.customOptions),n=new i({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return n.updateStatistics(),n}function _(e){var t=a.decode(e),r=new i({width:t.width,height:t.height,pixels:t.pixels,pixelType:"U8",mask:t.mask,statistics:null});return r.updateStatistics(),r}function b(e,t){var r,n=new Uint8Array(e),o=new u(n),a=t.width,s=t.height,l=a*s,p=o.decode(),c=0,d=0,f=new Uint8Array(l);for(c=0;c<l;c++)f[c]=p[4*c+3];var h=new i({width:a,height:s,pixels:[],pixelType:"U8",mask:f,statistics:[]});for(c=0;c<3;c++){for(r=new Uint8Array(l),d=0;d<l;d++)r[d]=p[4*d+c];h.addData({pixels:r})}return h.updateStatistics(),h}function w(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var a,s,l,u;return r.__generator(this,(function(p){switch(p.label){case 0:return a=new o,s=r.__assign({applyJpegMask:!1},t),[4,a.decode(e,s,n)];case 1:return l=p.sent(),(u=new i(l)).updateStatistics(),[2,u]}}))}))}function S(e){if(null==e)throw new n("rasterCodec:decode","parameter encodeddata is required.");var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?r="png":67===t[0]&&110===t[1]&&116===t[2]&&90===t[3]&&73===t[4]&&109===t[5]&&97===t[6]&&103===t[7]&&101===t[8]&&32===t[9]?r="lerc":76===t[0]&&101===t[1]&&114===t[2]&&99===t[3]&&50===t[4]&&32===t[5]?r="lerc2":73===t[0]&&73===t[1]&&42===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&42===t[3]?r="tiff":String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1&&(r="error"),r}function x(e){var t=null,r=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":r=Math.pow(2,8)-1,t=Uint8Array;break;case"u16":r=r||Math.pow(2,16)-1,t=Uint16Array;break;case"u32":r=r||Math.pow(2,32)-1,t=Uint32Array;break;case"s8":r=r||0-Math.pow(2,7),t=Int8Array;break;case"s16":r=r||0-Math.pow(2,15),t=Int16Array;break;case"s32":r=r||0-Math.pow(2,31),t=Int32Array;break;default:t=Float32Array}return{pixelTypeCtor:t,noDataValue:r}}return function(){function e(){}return e.getFormat=function(e){var t=S(e);return"lerc2"===t?t="lerc":"error"===t&&(t=""),t},e.decode=function(e,t,o){return r.__awaiter(this,void 0,void 0,(function(){var a,s,l;return r.__generator(this,(function(u){switch(u.label){case 0:if(null==e)throw new n("rasterCodec:decode","missing encodeddata parameter.");if(null==t||null==t.width||null==t.height)throw new n("rasterCodec:decode","requires width and height in options parameter.");return"tiff"===(a=t.format&&t.format.toLowerCase())&&t.customOptions?[2,v(e,t)]:((!a||"bsq"!==a&&"bip"!==a)&&(a=S(e)),!t.useCanvas||"jpg"!==a&&"png"!==a?[3,2]:[4,w(e,t,o)]);case 1:return l=u.sent(),[3,3];case 2:s=function(e){var t=null;switch(e){case"lerc":t=y;break;case"lerc2":t=m;break;case"jpg":t=_;break;case"png":t=b;break;case"bsq":case"bip":t=function(t,r){return function(e,t,r){var n=x(t.pixelType).pixelTypeCtor,o=(0,p.decode)(e,{width:t.width,height:t.height,pixelType:n,format:r}),a=new i({width:t.width,height:t.height,pixels:o.pixels,pixelType:t.pixelType,mask:o.mask,statistics:null});return a.updateStatistics(),a}(t,r,e)};break;case"tiff":t=g;break;case"error":t=function(){throw new n("rasterCodec:decode","input data contains error")};break;default:t=function(){throw new n("rasterCodec:decode","unsupported raster format")}}return t}(a),t.isPoint&&((t=r.__assign({},t)).width++,t.height++),l=s(e,t),t.isPoint&&function(e,t){if(void 0===t&&(t=1),e){var r=e.pixels,n=e.width,o=e.height,a=e.mask;if(r&&0!==r.length){var s,l,u,p,c,d,f,h=r.length,y=n-1,m=o-1,g=[],v=i.getPixelArrayConstructor(e.pixelType);if(0===t){for(s=0;s<h;s++){for(c=r[s],d=new v(y*m),l=0;l<m;l++)for(p=l*n,u=0;u<y;u++)d[l*y+u]=c[p+u];g.push(d)}if(a)for(f=new Uint8Array(y*m),l=0;l<m;l++)for(p=l*n,u=0;u<y;u++)f[l*y+u]=a[p+u]}else{for(s=0;s<h;s++){for(c=r[s],d=new v(y*m),l=0;l<m;l++)for(p=l*n,u=0;u<y;u++)d[l*y+u]=(c[p+u]+c[p+u+1]+c[p+n+u]+c[p+n+u+1])/4;g.push(d)}if(a)for(f=new Uint8Array(y*m),l=0;l<m;l++)for(p=l*n,u=0;u<y;u++)f[l*y+u]=Math.min.apply(null,[a[p+u],a[p+u+1],a[p+n+u],a[p+n+u+1]])}e.width=y,e.height=m,e.mask=f,e.pixels=g}}}(l),u.label=3;case 3:return[2,l]}}))}))},e}()}.apply(null,n))||(e.exports=i)},604:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(399),r(360),r(155),r(156),r(151),r(423),r(376),r(988),r(461)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){var d=a.getLogger("esri.renderers.support.RasterSymbolizer");return function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.readRenderer=function(e,t,r){return n.read(e,r)},t.prototype.bind=function(){if(!this.renderer)return!1;var e;switch(this.lookup={rendererJson:{}},this.renderer.type){case"unique-value":e=this._updateUVRenderer(this.renderer);break;case"raster-colormap":e=this._updateColormapRenderer(this.renderer);break;case"raster-stretch":e=this._updateStretchRenderer(this.renderer);break;case"class-breaks":e=this._updateClassBreaksRenderer(this.renderer);break;case"raster-shaded-relief":e=this._updateShadedReliefRenderer(this.renderer)}return e},t.prototype.symbolize=function(e){var t=e&&e.pixelBlock;if(!this.isValidPixelBlock(t))return t;if(e.simpleStretchParams&&"raster-stretch"===this.renderer.type)return this.simpleStretch(t,e.simpleStretchParams);try{t.pixels.length>3&&(t=u.extractBands(t,[0,1,2]));var r=void 0;switch(this.renderer.type){case"unique-value":case"raster-colormap":r=this._symbolize_colormap(t);break;case"class-breaks":r=this._symbolize_classBreaks(t);break;case"raster-stretch":r=this._symbolize_stretch(t,e.bandIds);break;case"raster-shaded-relief":var n=e.extent,i=n.spatialReference.isGeographic,o={x:(n.xmax-n.xmin)/t.width,y:(n.ymax-n.ymin)/t.height};r=this._symbolize_shadedRelief(t,{isGCS:i,resolution:o})}return r}catch(e){return d.error("symbolize",e.message),t}},t.prototype.simpleStretch=function(e,t){if(!this.isValidPixelBlock(e))return e;try{return e.pixels.length>3&&(e=u.extractBands(e,[0,1,2])),u.stretch(e,t)}catch(t){return d.error("symbolize",t.message),e}},t.prototype.generateWebGLParameters=function(e){if(["unique-value","raster-colormap","class-breaks"].indexOf(this.renderer.type)>-1){var t=this.lookup.colormapLut;return{colormap:t.indexedColormap,colormapOffset:t.offset,type:"lut"}}var r=e.pixelBlock,n=e.isGCS,i=e.resolution,o=e.bandIds;return"raster-stretch"===this.renderer.type?this.generateStretchWebGLParams(r,this.renderer,o):"raster-shaded-relief"===this.renderer.type?this.generateShadedReliefWebGLParams(this.renderer,n,i):null},t.prototype._isLUTChanged=function(e){if(!this.lookup||!this.lookup.rendererJson)return!0;if("colorRamp"in this.renderer){var t=this.renderer.colorRamp;if(e)return JSON.stringify(t.toJSON())!==JSON.stringify(this.lookup.rendererJson.colorRamp);var n=r.__assign({},this.renderer.toJSON()),i=r.__assign({},this.lookup.rendererJson);return n.colorRamp=null,i.colorRamp=null,JSON.stringify(this.renderer.toJSON())!==JSON.stringify(this.lookup.rendererJson)}return JSON.stringify(this.renderer.toJSON())!==JSON.stringify(this.lookup.rendererJson)},t.prototype._symbolize_colormap=function(e){return this._isLUTChanged()&&!this.bind()?e:u.colorize(e,this.lookup.colormapLut)},t.prototype._symbolize_classBreaks=function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1;return this._isLUTChanged()&&!this.bind()?e:r?u.colorize(e,this.lookup.colormapLut):u.remapColor(e,this.lookup.remapLut)},t.prototype._symbolize_stretch=function(e,t){var n,i,o=this.rasterInfo,a=o.pixelType,s=o.bandCount,l=this.renderer,p=["u8","u16","s8","s16"].indexOf(a)>-1,c=l.gamma,d=l.useGamma;if(p){if(l.dynamicRangeAdjustment){var f=this.getStretchCutoff(l,e,t);n=u.createStretchLUT(r.__assign(r.__assign({pixelType:a},f),{gamma:d?c:null}))}else if(this._isLUTChanged()){if(!this.bind())return e;n=this.lookup?this.lookup.stretchLut:null}else n=this.lookup?this.lookup.stretchLut:null;if(!n)return e;s>1&&(null==t?void 0:t.length)===e.pixels.length&&(null==n?void 0:n.lut.length)===s&&(n={lut:t.map((function(e){return n.lut[e]})),offset:n.offset}),i=u.lookupPixels(e,n)}else f=this.getStretchCutoff(l,e,t),i=u.stretch(e,r.__assign(r.__assign({},f),{gamma:d?c:null}));if(l.colorRamp){if(this._isLUTChanged(!0)&&!this.bind())return e;i=u.colorize(i,this.lookup.colormapLut)}return i},t.prototype._symbolize_shadedRelief=function(e,t){var n,i=this.renderer,o=r.__assign(r.__assign({},i.toJSON()),t),a=p.hillshade(e,o);if(!i.colorRamp)return a;if(this._isLUTChanged(!0)){if(!this.bind())return a;n=this.lookup?this.lookup.hsvMap:null}else n=this.lookup?this.lookup.hsvMap:null;return n?(p.tintHillshade(a,e,n,this.rasterInfo.statistics[0]),a):a},t.prototype._updateUVRenderer=function(e){var t=this.rasterInfo,r=t.bandCount,n=t.attributeTable,i=t.statistics,o=t.pixelType,a=["u8","s8"].indexOf(o)>-1&&i&&null!=i[0].min&&null!=i[0].max;if(1!==r||!n&&!a)return!1;var s=e.field;if(!s)return!1;var l=[];if(n){var p=n.fields.filter((function(e){return"value"===e.name.toLowerCase()}))[0];if(!p)return!1;n.features.forEach((function(t){var r=e.uniqueValueInfos.filter((function(e){return String(e.value)===String(t.attributes[s])}))[0],n=r&&r.symbol&&r.symbol.color;n&&l.push([t.attributes[p.name],n.r,n.g,n.b,n.a>1?n.a:Math.round(255*n.a)])}))}else{if("value"!==s.toLowerCase())return!1;e.uniqueValueInfos.forEach((function(e){var t=e&&e.symbol&&e.symbol.color;t&&l.push([parseInt(e.value,10),t.r,t.g,t.b,t.a>1?t.a:Math.round(255*t.a)])}))}if(0===l.length)return!1;var c=u.createColormapLUT({colormap:l});return this.lookup={rendererJson:e.toJSON(),colormapLut:c},this.canRenderInWebGL=!0,!0},t.prototype._updateColormapRenderer=function(e){var t=e.extractColormap();if(!t||0===t.length)return!1;var r=u.createColormapLUT({colormap:t});return this.lookup={rendererJson:e.toJSON(),colormapLut:r},this.canRenderInWebGL=!0,!0},t.prototype._updateShadedReliefRenderer=function(e){if("elevation"!==this.rasterInfo.dataType)return!1;if(e.colorRamp){for(var t=c.convertColorRampToColormap(e.colorRamp,256),r=u.createColormapLUT({colormap:t}),n=[],o=r.indexedColormap,a=0;a<o.length;a+=4){var s=i.toHSV({r:o[a],g:o[a+1],b:o[a+2]});n.push([s.h/60,s.s/100,255*s.v/100])}this.lookup={rendererJson:e.toJSON(),colormapLut:r,hsvMap:n}}else this.lookup=null;return this.canRenderInWebGL=!0,!0},t.prototype._updateClassBreaksRenderer=function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1,n=e.classBreakInfos;if(!n||0===n.length)return!1;var i=n.sort((function(e,t){return e.minValue-t.minValue})),o=i[i.length-1];if(!r){var a=i.map((function(e){return{value:e.minValue,mappedColor:[e.symbol.color.r,e.symbol.color.g,e.symbol.color.b,e.symbol.color.a>1?e.symbol.color.a:Math.round(255*e.symbol.color.a)]}}));return a.push({value:o.maxValue,mappedColor:[o.symbol.color.g,o.symbol.color.b,o.symbol.color.a>1?o.symbol.color.a:Math.round(255*o.symbol.color.a)]}),this.lookup={rendererJson:e.toJSON(),remapLut:a},this.canRenderInWebGL=!1,!0}var s,l=[],p=0;i.forEach((function(e){s=Math.ceil(e.minValue),p=Math.floor(e.maxValue);for(var t=s;t<p;t++)l.push([t,e.symbol.color.r,e.symbol.color.g,e.symbol.color.b,e.symbol.color.a>1?e.symbol.color.a:Math.round(255*e.symbol.color.a)])})),l.push([o.maxValue,o.symbol.color.r,o.symbol.color.g,o.symbol.color.b,o.symbol.color.a>1?o.symbol.color.a:Math.round(255*o.symbol.color.a)]);var c=u.createColormapLUT({colormap:l,fillUnspecified:!1});return this.lookup={rendererJson:e.toJSON(),colormapLut:c},this.canRenderInWebGL=!0,!0},t.prototype._updateStretchRenderer=function(e){if(!(e.statistics||this.rasterInfo.statistics||e.dynamicRangeAdjustment))return!1;var t=e.histograms||this.rasterInfo.histograms;if(!e.dynamicRangeAdjustment&&"percent-clip"===e.stretchType&&!t)return!1;var n=e.gamma,i=e.useGamma,o=e.colorRamp,a=this.rasterInfo.pixelType;if(!e.dynamicRangeAdjustment&&["u8","u16","s8","s16"].indexOf(a)>-1){var s=this.getStretchCutoff(e),l=u.createStretchLUT(r.__assign(r.__assign({pixelType:a},s),{gamma:i?n:null}));this.lookup={rendererJson:e.toJSON(),stretchLut:l}}if(o){var p=c.convertColorRampToColormap(o,256);this.lookup||(this.lookup={rendererJson:e.toJSON()}),this.lookup.colormapLut=u.createColormapLUT({colormap:p}),this.lookup.rendererJson=e.toJSON()}return this.canRenderInWebGL=!0,!0},t.prototype.getStretchCutoff=function(e,t,r){var n,i,o=e.stretchType;if(e.dynamicRangeAdjustment)if("min-max"===o&&t.statistics)n=t.statistics.map((function(e){return[e.minValue,e.maxValue,0,0]}));else{var a=u.estimateStatisticsHistograms(t);n=a.statistics,i=a.histograms}else n=e.statistics&&e.statistics.length>0?e.statistics:this.rasterInfo.statistics,i=e.histograms||this.rasterInfo.histograms;var s,l,p,c,d,f,h,y,m,g=n||i?(n||i).length:this.rasterInfo.bandCount,v=[],_=[];switch(n[0]instanceof Array||(n=n.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),o){case"none":for(y=0;y<g;y++)v[y]="u8"===this.rasterInfo.pixelType?0:n?n[y][0]:0,_[y]="u8"===this.rasterInfo.pixelType?255:n?n[y][1]:255;break;case"min-max":for(y=0;y<g;y++)v[y]=n[y][0],_[y]=n[y][1];break;case"standard-deviation":for(y=0;y<g;y++)v[y]=n[y][2]-e.numberOfStandardDeviations*n[y][3],_[y]=n[y][2]+e.numberOfStandardDeviations*n[y][3],v[y]<n[y][0]&&(v[y]=n[y][0]),_[y]>n[y][1]&&(_[y]=n[y][1]);break;case"percent-clip":for(y=0;y<i.length;y++){for(s=i[y],d=new Uint32Array(s.size),c=s.counts,p=0,l=(s.max-s.min)/s.size,h=-.5===s.min&&1===l?.5:0,m=0;m<s.size;m++)p+=c[m],d[m]=p;for(f=e.minPercent*p/100,m=0;m<s.size;m++)if(d[m]>f){v[y]=s.min+l*(m+h);break}for(f=(1-e.maxPercent/100)*p,m=s.size-2;m>=0;m--)if(d[m]<f){_[y]=s.min+l*(m+2-h);break}}break;default:for(y=0;y<g;y++)v[y]=n[y][0],_[y]=n[y][1]}var b={minCutOff:v,maxCutOff:_,outMax:e.outputMax||255,outMin:e.outputMin||0};return this.getSelectedBandCutoffs(b,r)},t.prototype.getSelectedBandCutoffs=function(e,t){if(null==t||0===t.length)return e;var r=Math.max.apply(null,t),n=e.minCutOff,i=e.maxCutOff,o=e.outMin,a=e.outMax;return n.length===t.length||n.length<=r?e:{minCutOff:t.map((function(e){return n[e]})),maxCutOff:t.map((function(e){return i[e]})),outMin:o,outMax:a}},t.prototype.generateStretchWebGLParams=function(e,t,r){var n=null,i=null,o=this.lookup&&this.lookup.colormapLut;t.colorRamp&&o&&(n=o.indexedColormap,i=o.offset);var a=t.gamma,s=!!(t.useGamma&&a&&a.some((function(e){return 1!==e}))),l=this.getStretchCutoff(t,e,r),u=l.minCutOff,p=l.maxCutOff,c=l.outMin,d=l.outMax;e&&e.pixels&&2===e.pixels.length&&((e=e.clone()).statistics=[e.statistics[0]],e.pixels=[e.pixels[0]]);var f,h=Math.min(3,r&&r.length||e&&e.getPlaneCount()||this.rasterInfo.bandCount),y=new Float32Array(h),m=n||s?1:255;for(f=0;f<h;f++)y[f]=(d-c)/(p[f]-u[f])/m;var g=new Float32Array(h);if(s)for(f=0;f<h;f++)a[f]>1?a[f]>2?g[f]=6.5+Math.pow(a[f]-2,2.5):g[f]=6.5+100*Math.pow(2-a[f],4):g[f]=1;return{bandCount:h,outMin:c/m,outMax:d/m,minCutOff:u,maxCutOff:p,factor:y,useGamma:s,gamma:s?a:[1,1,1],gammaCorrection:s?g:[1,1,1],colormap:n,colormapOffset:i,type:"stretch"}},t.prototype.generateShadedReliefWebGLParams=function(e,t,n){var i=null,o=null,a=this.lookup&&this.lookup.colormapLut;e.colorRamp&&a&&(i=a.indexedColormap,o=a.offset);var s=r.__assign(r.__assign({},e.toJSON()),{isGCS:t,resolution:n}),l=p.calculateHillshadeParams(s),u=this.rasterInfo.statistics[0];return r.__assign(r.__assign({},l),{minValue:u.min,maxValue:u.max,hillshadeType:"traditional"===e.hillshadeType?0:1,type:"hillshade",colormap:i,colormapOffset:o})},t.prototype.isValidPixelBlock=function(e){return!!(e&&e.pixels&&e.pixels.length>0&&0!==e.validPixelCount)},r.__decorate([s.property({types:n.rasterRendererTypes,json:{write:!0}})],t.prototype,"renderer",void 0),r.__decorate([s.reader("renderer")],t.prototype,"readRenderer",null),r.__decorate([s.property({type:l,json:{write:!0}})],t.prototype,"rasterInfo",void 0),r.__decorate([s.property({json:{write:!0}})],t.prototype,"lookup",void 0),r.__decorate([s.property({})],t.prototype,"canRenderInWebGL",void 0),r.__decorate([s.subclass("esri.renderers.support.RasterSymbolizer")],t)}(o.JSONSupport)}.apply(null,n))||(e.exports=i)},668:function(e,t,r){"use strict";var n=r(167),i=r.n(n),o=r(669),a=r.n(o),s=r(291),l=r(232),u=r.n(l),p=r(157),c=a.a.createSubclass({constructor:function(){this.tileContexts=new window.Map,this.watchHandles=new i.a,this.needsImageUpdate=!1},attach:function(){var e=s.load(),t=this,r=t.layer;this.watchHandles.add([p.init(this,"layer.geometry",(function(){if(!r.geometry)return t.projectedGeometry=null,t.needsImageUpdate=!0,void t.requestRender();e.then((function(){t.projectedGeometry=s.project(r.geometry,r.tileInfo.spatialReference,s.getTransformation(r.geometry.spatialReference,r.tileInfo.spatialReference)),t.needsImageUpdate=!0,t.requestRender()}))})),p.init(this,"layer.distance",(function(){t.needsImageUpdate=!0,t.requestRender()})),p.init(this,"layer.color",(function(){t.needsImageUpdate=!0,t.requestRender()}))])},drawGeometry:function(e,t){e.globalCompositeOperation="source-over";var r=e.canvas.width,n=e.canvas.height;if(this.projectedGeometry){if(0!==this.layer.distance){var i=this.layer.color;e.fillStyle="rgba("+i[0]+", "+i[1]+", "+i[2]+", "+(i[3]||.75)+")",e.fillRect(0,0,r,n);var o=3/this.layer.distance;if(e.globalCompositeOperation="destination-out","polygon"===this.projectedGeometry.type||"polyline"===this.projectedGeometry.type||"extent"===this.projectedGeometry.type){var a=("extent"===this.projectedGeometry.type?u.a.fromExtent(this.projectedGeometry).rings:this.projectedGeometry.rings||this.projectedGeometry.paths).map((function(e){return e.map((function(e){return[Math.round(r*(e[0]-t[0])/(t[2]-t[0])),Math.round(n*(1-(e[1]-t[1])/(t[3]-t[1])))]}))}));e.lineJoin="round";for(var s=1;s<=this.layer.distance;++s){e.strokeStyle="rgba(0, 0, 0, "+o+")",e.lineWidth=this.layer.distance+1-s;for(var l=0;l<a.length;++l){var p=a[l];e.beginPath(),e.moveTo(p[0][0],p[0][1]);for(var c=1;c<p.length;++c)e.lineTo(p[c][0],p[c][1]);"polyline"!==this.projectedGeometry.type&&e.closePath(),e.stroke()}}if("polyline"!==this.projectedGeometry.type){e.fillStyle="rgba(0, 0, 0, 1)";for(l=0;l<a.length;++l){p=a[l];e.beginPath(),e.moveTo(p[0][0],p[0][1]);for(c=1;c<p.length;++c)e.lineTo(p[c][0],p[c][1]);e.closePath(),e.fill()}}}else if("point"===this.projectedGeometry.type||"multipoint"===this.projectedGeometry.type)for(a=("multipoint"===this.projectedGeometry.type?this.projectedGeometry.points:[[this.projectedGeometry.x,this.projectedGeometry.y]]).map((function(e){return[Math.round(r*(e[0]-t[0])/(t[2]-t[0])),Math.round(n*(1-(e[1]-t[1])/(t[3]-t[1])))]})),s=1;s<=this.layer.distance;++s){var d=this.layer.distance+1-s;e.fillStyle="rgba(0, 0, 0, "+o+")";for(l=0;l<a.length;++l){var f=a[l];e.beginPath(),e.arc(f[0],f[1],Math.round(d/2),0,360),e.fill()}}}}else e.clearRect(0,0,r,n)},manageTileImages:function(){this.context;for(var e=new Set,t=0;t<this.tiles.length;++t){var r=this.tiles[t];e.add(r.id);var n=this.tileContexts.get(r.id);if(n)this.needsImageUpdate&&this.drawGeometry(n,r.bounds);else{var i=document.createElement("canvas");i.width=this.layer.tileInfo.size[0],i.height=this.layer.tileInfo.size[1],n=i.getContext("2d"),this.tileContexts.set(r.id,n),this.drawGeometry(n,r.bounds)}}this.tileContexts.forEach(function(t,r){e.has(r)||this.tileContexts.delete(r)}.bind(this)),this.needsImageUpdate=!1},render:function(e){this.manageTileImages();var t=this.layer.tileInfo.size[0],r=e.state,n=r.pixelRatio,i=r.size[0],o=r.size[1],a=e.context,s=[0,0];a.clearRect(0,0,i*n,o*n),0!==r.rotation&&(a.translate(i*n*.5,o*n*.5),a.rotate(r.rotation*Math.PI/180),a.translate(-i*n*.5,-o*n*.5)),a.globalAlpha=this.layer.color[3];for(var l=0;l<this.tiles.length;++l){var u=this.tiles[l],p=this.tileContexts.get(u.id),c=u.resolution/r.resolution*n;r.toScreenNoRotation(s,u.coords),a.drawImage(p.canvas,s[0],s[1],t*c,t*c)}},detach:function(){this.watchHandles.removeAll()},tilesChanged:function(){}});t.a=c},669:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(151),r(173),r(585),r(219),r(675),r(218),r(285)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){var p=new Set,c=[],d=[],f=function(e,t,r,n,o,a,s,l,u){void 0===l&&(l=[0,0]),void 0===u&&(u=i.create()),this.id=e,this.level=t,this.row=r,this.col=n,this.world=o,this.resolution=a,this.scale=s,this.coords=l,this.bounds=u};return function(e){function t(t){var r=e.call(this,t)||this;return r._tileMap=new Map,r.container=new s.default(r),r.layer=null,r.tiles=[],r}return r.__extends(t,e),Object.defineProperty(t.prototype,"_tileInfoView",{get:function(){var e=this.layer&&this.layer.tileInfo;return e?new o.TileInfoView(e):null},enumerable:!0,configurable:!0}),t.prototype.attach=function(){},t.prototype.detach=function(){},t.prototype.requestRender=function(){this.container.requestRender()},t.prototype.tilesChanged=function(e,t){},t.prototype.doRefresh=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2]}))}))},t.prototype.isUpdating=function(){return!1},t.prototype.update=function(e){var t=this._tileInfoView,r=this.tiles;if(t){var n=t.getTileCoverage(e.state,0),i=n.spans,o=n.lodInfo,a=o.level;if(i.length)for(var s=0,l=i;s<l.length;s++)for(var u=l[s],h=u.row,y=u.colFrom,m=u.colTo,g=y;g<=m;g++){var v=o.normalizeCol(g),_=o.getWorldForColumn(g),b=a+"/"+h+"/"+v+"/"+_;if(!this._tileMap.has(b)){var w=new f(b,a,h,v,_,o.resolution,o.scale);o.getTileCoords(w.coords,w,!1),o.getTileBounds(w.bounds,w,!0),this._tileMap.set(b,w),r.push(w),c.push(w)}p.add(b)}}for(var S=r.length-1;S>=0;S--)w=r[S],p.has(w.id)||(r.splice(S,1),d.push(w),this._tileMap.delete(w.id));(c.length||d.length)&&(this.tilesChanged(c,d),c.length=d.length=0),p.clear(),this.requestRender()},t.prototype.moveStart=function(){},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){},r.__decorate([n.property({dependsOn:["layer.loaded"]})],t.prototype,"_tileInfoView",null),r.__decorate([n.property()],t.prototype,"layer",void 0),r.__decorate([n.subclass("esri.views.2d.layers.BaseLayerView2D")],t)}(u.RefreshableLayerView(a.LayerView2DMixin(l)))}.apply(null,n))||(e.exports=i)},675:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(186),r(544)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this)||this;return r.requestRender=r.requestRender.bind(r),r._layerView=t,r._canvas=document.createElement("canvas"),r._context=r._canvas.getContext("2d"),r._bitmap=new n.Bitmap(null,!1),r.addChild(r._bitmap),r}return r.__extends(t,e),t.prototype.doRender=function(t){var n=t.state,i=this._createCustomRenderParams(t),o=this._canvas,a=this._bitmap,s=window.devicePixelRatio;o.width=n.size[0]*s,o.height=n.size[1]*s,a.resolution=n.resolution;var l=n.clone();l.pixelRatio=s,a.pixelRatio=s,i.state=l,a.x=n.viewpoint.targetGeometry.x-n.extent.width/2,a.y=n.viewpoint.targetGeometry.y+n.extent.height/2,this._layerView.render(i),a.source=o,a.rotation=n.rotation,e.prototype.doRender.call(this,r.__assign(r.__assign({},t),{state:l}))},t.prototype._createCustomRenderParams=function(e){return{globalOpacity:e.globalOpacity,state:e.state,stationary:e.stationary,pixelRatio:window.devicePixelRatio,context:this._context}},t}(i.BitmapContainer);t.Display=o,t.default=o}.apply(null,n))||(e.exports=i)},676:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(258),r(158),r(169),r(167),r(157),r(151),r(677)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){var p="state",c="all-layer-views",d="legend-properties",f=o.ofType(u),h=["esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.TileLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer"],y=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(e){function t(t){var r=e.call(this,t)||this;return r._handles=new a,r._layerViewByLayerId={},r._layerInfosByLayerViewId={},r._activeLayerInfosByLayerViewId={},r.activeLayerInfos=new f,r.basemapLegendVisible=!1,r.groundLegendVisible=!1,r.keepCacheOnDestroy=!1,r.respectLayerVisibility=!0,r.layerInfos=[],r.view=null,r}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this._handles.add(s.init(this,"view",this._viewHandles),"view"),this._handles.add(n.onLocaleChange((function(){return e._refresh()})))},t.prototype.destroy=function(){this._destroyViewActiveLayerInfos(),this._handles.destroy(),this._handles=null,this.view=null},Object.defineProperty(t.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0}),t.prototype._viewHandles=function(){this._handles.remove(p),this.view&&this._handles.add(s.init(this,"state",this._stateHandles),p)},t.prototype._stateHandles=function(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()},t.prototype._resetAll=function(){this._handles.remove([c,d]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()},t.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)},t.prototype._destroyViewActiveLayerInfo=function(e){this._handles.remove(e);var t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],t&&t.parent&&t.parent.children.remove(t)},t.prototype._watchPropertiesAndAllLayerViews=function(){var e=this.view.allLayerViews;e.length&&this._refresh(),this._handles.add(e.on("change",this._allLayerViewsChangeHandle.bind(this)),c),this._handles.add(s.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),d)},t.prototype._allLayerViewsChangeHandle=function(e){var t=this;e.removed.forEach((function(e){return t._destroyViewActiveLayerInfo(e.uid)})),this._refresh()},t.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos(),this._refresh()},t.prototype._refresh=function(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)},t.prototype._sortActiveLayerInfos=function(e){var t=this;if(!(e.length<2)){var r=[];e.forEach((function(n){if(!n.parent){var i=n.layer.parent,o=i&&"uid"in i&&t._layerViewByLayerId[i.uid],a=o&&t._activeLayerInfosByLayerViewId[o.uid];a&&-1!==e.indexOf(a)&&(r.push(n),n.parent=a,a.children.add(n),t._sortActiveLayerInfos(a.children))}})),e.removeMany(r);var n={};this.view.allLayerViews.forEach((function(e,t){return n[e.layer.uid]=t})),e.sort((function(e,t){var r=n[e.layer.uid]||0;return(n[t.layer.uid]||0)-r}))}},t.prototype._generateLayerViews=function(){var e=[];return y.filter(this._filterLayerViews,this).map(this.get,this).filter((function(e){return null!=e})).forEach(this._collectLayerViews("layerViews",e)),e},t.prototype._filterLayerViews=function(e){var t=!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===e||"view.basemapView.referenceLayerViews"===e),r=!this.groundLegendVisible&&"view.groundView.layerViews"===e;return!t&&!r},t.prototype._collectLayerViews=function(e,t){var r=function(n){return n&&n.forEach((function(n){t.push(n),r(n[e])})),t};return r},t.prototype._filterLayerViewsByLayerInfos=function(e){var t=this,r=this.layerInfos;return!r||!r.length||r.some((function(r){return t._hasLayerInfo(r,e)}))},t.prototype._hasLayerInfo=function(e,t){var r=this._isLayerUIDMatching(e.layer,t.layer.uid);return r&&(this._layerInfosByLayerViewId[t.uid]=e),r},t.prototype._isLayerUIDMatching=function(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))},t.prototype._hasLayerUID=function(e,t){var r=this;return e&&e.some((function(e){return r._isLayerUIDMatching(e,t)}))},t.prototype._isLayerViewSupported=function(e){return h.indexOf(e.layer.declaredClass)>-1&&(this._layerViewByLayerId[e.layer.uid]=e,!0)},t.prototype._generateActiveLayerInfo=function(e){var t=this;this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this._handles.remove(e.uid),this._handles.add(s.watch(e,"suspended, layer.legendEnabled",(function(){return t._layerActiveHandle(e)})),e.uid))},t.prototype._layerActiveHandle=function(e){this._isLayerActive(e)&&(this._handles.remove(e.uid),this._buildActiveLayerInfo(e))},t.prototype._isLayerActive=function(e){return!this.respectLayerVisibility||!e.suspended&&e.get("layer.legendEnabled")},t.prototype._buildActiveLayerInfo=function(e){var t=this,r=e.layer,n=e.uid,i=this._layerInfosByLayerViewId[n],o=this._activeLayerInfosByLayerViewId[n];if(!o){var a=i&&void 0!==i.title;o=new u({layer:r,layerView:e,title:a?i.title:r.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:i&&i.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[n]=o}if(!o.parent){var l=r.parent,p=l&&this._layerViewByLayerId[l.uid];o.parent=p&&this._activeLayerInfosByLayerViewId[p.uid]}if(!this._handles.has(n)){var c=[s.watch(r,"title",(function(r){return t._titleHandle(r,o,e)})),s.watch(r,"renderer?, opacity",(function(){return t._constructLegendElements(o,e)})),s.whenTrue(this.view,"stationary",(function(){return t._scaleHandle(o,e)})),s.watch(e,"_effectiveRenderer",(function(){return t._constructLegendElements(o,e)}))];if(this.respectLayerVisibility){var d=s.watch(e,"suspended",(function(r){return t._suspendedHandle(r,o,e)})),f=s.watch(r,"legendEnabled",(function(r){return t._legendEnabledHandle(r,o,e)}));c.push(d,f)}this._handles.add(c,n)}o.isScaleDriven||this._constructLegendElements(o,e),this._addActiveLayerInfo(o,e)},t.prototype._titleHandle=function(e,t,r){t.title=e,this._constructLegendElements(t,r)},t.prototype._legendEnabledHandle=function(e,t,r){e?this._addActiveLayerInfo(t,r):this._removeActiveLayerInfo(t)},t.prototype._suspendedHandle=function(e,t,r){e?this._removeActiveLayerInfo(t):this._addActiveLayerInfo(t,r)},t.prototype._scaleHandle=function(e,t){e.isScaleDriven&&this._constructLegendElements(e,t)},t.prototype._addActiveLayerInfo=function(e,t){if(this._isLayerActive(t)&&-1===this.activeLayerInfos.indexOf(e)){var r=e.parent;r?(-1===r.children.indexOf(e)&&r.children.push(e),this._sortActiveLayerInfos(r.children)):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}},t.prototype._removeActiveLayerInfo=function(e){var t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)},t.prototype._constructLegendElements=function(e,t){var r=t.layer;r.featureCollections?e.buildLegendElementsForFeatureCollections(r.featureCollections):r.renderer?e.buildLegendElementsForRenderer(r.renderer):r.url&&e.buildLegendElementsForTools()},r.__decorate([l.property({type:f})],t.prototype,"activeLayerInfos",void 0),r.__decorate([l.property()],t.prototype,"basemapLegendVisible",void 0),r.__decorate([l.property()],t.prototype,"groundLegendVisible",void 0),r.__decorate([l.property()],t.prototype,"keepCacheOnDestroy",void 0),r.__decorate([l.property()],t.prototype,"respectLayerVisibility",void 0),r.__decorate([l.property()],t.prototype,"layerInfos",void 0),r.__decorate([l.property({dependsOn:["view.ready"],readOnly:!0})],t.prototype,"state",null),r.__decorate([l.property()],t.prototype,"view",void 0),r.__decorate([l.subclass("esri.widgets.Legend.LegendViewModel")],t)}(i)}.apply(null,n))||(e.exports=i)},677:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(182),r(165),r(239),r(158),r(180),r(169),r(167),r(156),r(152),r(153),r(172),r(157),r(151),r(378),r(191),r(316),r(781),r(678),r(357),r(266),r(682),r(683),r(684),r(685),r(686),r(397),r(161)],void 0===(i=function(e,t,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b,w,S,x,I,R,T,C,P,L){var k=c.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),M=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,O=new a.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),E=new a.SimpleFillSymbol({style:"solid"});function A(e){return"raster-colormap"===e.type}function D(e){return"raster-stretch"===e.type}function N(e){return"raster-shaded-relief"===e.type}function F(e){return"esri.renderers.SimpleRenderer"===e.declaredClass}function j(e){return"esri.renderers.ClassBreaksRenderer"===e.declaredClass}function V(e){return"esri.renderers.UniqueValueRenderer"===e.declaredClass}function U(e){return"esri.renderers.HeatmapRenderer"===e.declaredClass}function B(e){return"esri.renderers.PointCloudClassBreaksRenderer"===e.declaredClass}function G(e){return"esri.renderers.PointCloudStretchRenderer"===e.declaredClass}function z(e){return"esri.renderers.PointCloudUniqueValueRenderer"===e.declaredClass}function J(e){return"esri.renderers.DotDensityRenderer"===e.declaredClass}function q(e){return"esri.layers.MapImageLayer"===e.declaredClass}function H(e){return"esri.layers.ImageryLayer"===e.declaredClass}var W=new a.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}}),Z={};return function(e){function t(t){var r=e.call(this,t)||this;return r._handles=new p,r._hasColorRamp=!1,r._hasOpacityRamp=!1,r._hasSizeRamp=!1,r._webStyleSymbolCache=new Map,r._dotDensityUrlCache=new Map,r._scaleDrivenSizeVariable=null,r._hasClusterSizeVariable=!1,r.children=new u,r.layerView=null,r.layer=null,r.legendElements=[],r.parent=null,r.keepCacheOnDestroy=!1,r.respectLayerVisibility=!0,r.sublayerIds=[],r.title=null,r.view=null,r}return n.__extends(t,e),t.prototype.initialize=function(){var e=this,t=function(){return e.notifyChange("ready")};this._handles.add([y.on(this,"children","change",(function(r){var n=r.added,i=r.removed,o=e._handles;n.map((function(e){var r="activeLayerInfo-ready-watcher-"+e.layer.uid;o.add(y.init(e,"ready",t),r)})),i.forEach((function(e){return o.remove(e.layer.uid)})),t()}))]),this.keepCacheOnDestroy||(Z={})},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null,this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(Z=null)},Object.defineProperty(t.prototype,"ready",{get:function(){return null===this.layer||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.view&&this.view.scale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isScaleDriven",{get:function(){var e=this,t=this.layer;if(null===t)return!1;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type)return!0;if("renderer"in t&&t.renderer){if("dot-density"===t.renderer.type)return!0;var r=t.get("renderer.valueExpression");if(M.test(r))return!0;var n=t.get("renderer.visualVariables");if(n)return n.some((function(t){return e._isScaleDrivenSizeVariable(t)}))}return this._isLayerScaleDriven(this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0}),t.prototype.buildLegendElementsForFeatureCollections=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r=this;return n.__generator(this,(function(n){return this.legendElements=[],t=e.map((function(e){if("esri.layers.FeatureLayer"===e.declaredClass)return r._buildRendererLegendElements(e.renderer,{title:e.title,mode:0});if(e.featureSet&&e.featureSet.features.length){var t=e.layerDefinition,n=t&&t.drawingInfo,i=n&&_.fromJSON(n.renderer);return i?r._buildRendererLegendElements(i,{title:e.name,mode:0}):(k.warn("drawingInfo not available!"),null)}return null})),[2,f.eachAlways(t).then((function(){}))]}))}))},t.prototype.buildLegendElementsForRenderer=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){return[2,this._buildRendererLegendElements(e)]}))}))},t.prototype.buildLegendElementsForTools=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t=this;return n.__generator(this,(function(r){switch(r.label){case 0:return function(e){return"esri.layers.WMTSLayer"===e.declaredClass}(e=this.layer)?(this._constructLegendElementsForWMTSlayer(),[3,6]):[3,1];case 1:return function(e){return"esri.layers.WMSLayer"===e.declaredClass}(e)?(this._constructLegendElementsForWMSSublayers(),[3,6]):[3,2];case 2:return q(e)||function(e){return"esri.layers.TileLayer"===e.declaredClass}(e)?[4,this._constructLegendElementsForSublayers()]:[3,4];case 3:return r.sent(),[3,6];case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then((function(r){t.legendElements=[],r.forEach((function(r){if(H(e)){var n=e.watch("renderingRule, bandIds",(function(){Z.default=null,t.buildLegendElementsForTools()}));t._handles.add(n,"imageryLayers-watcher")}var i=t._generateSymbolTableElementForLegendLayer(r);i&&i.infos.length&&(H(e)&&(i.title=e.title),t.legendElements.push(i)),t.notifyChange("ready")})),t.notifyChange("ready")})).catch((function(e){k.warn("Request to server for legend has failed!",e)}))];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))},t.prototype._isGroupActive=function(){var e=this.children;return!!e.length&&e.some((function(e){return e.ready}))},t.prototype._isScaleDrivenSizeVariable=function(e){if(e&&"size"!==e.type)return!1;var t=e,r=t.minSize,n=t.maxSize;return"object"==typeof r&&r?this._isScaleDrivenSizeVariable(r):"object"==typeof n&&n?this._isScaleDrivenSizeVariable(n):!!t.expression||M.test(t.valueExpression)},t.prototype._isLayerScaleDriven=function(e){var t=this;if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some((function(e){return t._isLayerScaleDriven(e)}));var r=e.parent;if(!1===e.loaded&&q(r)&&"source"in e&&e.source&&"map-layer"===e.source.type)for(var n=0,i=r.sourceJSON.layers;n<i.length;n++){var o=i[n];if(o.id===e.source.mapLayerId&&(o.minScale>0||o.maxScale>0))return!0}return!1},t.prototype._buildRendererLegendElements=function(e,t){return void 0===t&&(t={}),n.__awaiter(this,void 0,void 0,(function(){var r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._getRendererLegendElements(e,{title:t.title})];case 1:return r=n.sent(),0===t.mode?Array.prototype.push.apply(this.legendElements,r):this.legendElements=r,this.notifyChange("ready"),[3,3];case 2:return i=n.sent(),k.warn("error while building legend for layer!",i),[3,3];case 3:return[2]}}))}))},t.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[],this._handles.remove("wmts-activeLayer-watcher");var e=this.layer,t=e.activeLayer;if(this._handles.add(y.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher"),t.styleId&&t.styles){var r=null;t.styles.some((function(e){return t.styleId===e.id&&(r=e.legendUrl,!0)})),r&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:r,opacity:e.opacity}]}])}this.notifyChange("ready")},t.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[],this._handles.remove("wms-sublayers-watcher");var e=this.layer,t=null;(e.customParameters||e.customLayerParameters)&&(t=n.__assign(n.__assign({},e.customParameters),e.customLayerParameters)),this._handles.add(y.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher"),this.legendElements=this._generateLegendElementsForWMSSublayers(e.sublayers,t),this.notifyChange("ready")},t.prototype._generateLegendElementsForWMSSublayers=function(e,t){var r=this,n=[];return this._handles.add(e.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher"),e.forEach((function(e){var i=e.watch("title, visible, legendEnabled",(function(){return r._constructLegendElementsForWMSSublayers()}));if(r._handles.add(i,"wms-sublayers-watcher"),e.visible&&e.legendEnabled){var o=r._generateSymbolTableElementForWMSSublayer(e,t);o&&o.infos.length&&n.unshift(o)}})),n},t.prototype._generateSymbolTableElementForWMSSublayer=function(e,t){if(!e.legendUrl&&e.sublayers){var r=this._generateLegendElementsForWMSSublayers(e.sublayers,t).filter((function(e){return e}));return{type:"symbol-table",title:e.title,infos:r}}return this._generateSymbolTableElementForLegendUrl(e,t)},t.prototype._generateSymbolTableElementForLegendUrl=function(e,t){var r=e.legendUrl;if(r){var n={type:"symbol-table",title:e.title||e.name||e.id&&e.id+"",infos:[]};return t&&(r+="?"+h.objectToQuery(t)),n.infos.push({src:r,opacity:e.layer&&e.layer.opacity}),n}},t.prototype._getLegendLayers=function(e){var t=e&&e.hasDynamicLayers?e.dynamicLayers:null,r=t||"default",n=Z&&Z[r];return n?f.resolve(n):this._legendRequest(t).then((function(e){var t=e.layers;return Z[r]=t,t}))},t.prototype._legendRequest=function(e){var t=this.layer,r={f:"json",dynamicLayers:e};if(H(t)){var i=t;if(i.renderingRule&&(r.renderingRule=JSON.stringify(i.renderingRule.toJSON())),i.bandIds&&(r.bandIds=i.bandIds.join()),i.raster||i.viewId){var a=i.raster,s=i.viewId;r=n.__assign({raster:a,viewId:s},r)}}var l=t.url.replace(/(\/)+$/,"");if("version"in t&&t.version>=10.01){var u=l.indexOf("?");u>-1?l=l.substring(0,u)+"/legend"+l.substring(u):l+="/legend"}else{var p=l.toLowerCase().indexOf("/rest/"),c=l.substring(0,p)+l.substring(p+5,l.length);l="https://utility.arcgis.com/sharing/tools/legend?soapUrl="+encodeURI(c)+"&returnbytes=true"}return o(l,{query:r}).then((function(e){return e.data}))},t.prototype._constructLegendElementsForSublayers=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t,r;return n.__generator(this,(function(n){switch(n.label){case 0:this.legendElements=[],this._handles.remove("sublayers-watcher"),e=this.layer,this._handles.add(y.watch(e,"sublayers",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher"),n.label=1;case 1:return n.trys.push([1,3,,4]),t=this,[4,this._generateLegendElementsForSublayers(e.sublayers,e.opacity)];case 2:return t.legendElements=n.sent(),this.notifyChange("ready"),[3,4];case 3:return r=n.sent(),k.warn("Request to server for legend has failed!",r),[3,4];case 4:return[2]}}))}))},t.prototype._generateLegendElementsForSublayers=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,l,u,p,c,d,f,h,y=this;return n.__generator(this,(function(n){switch(n.label){case 0:i=[],this._handles.add(e.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher"),o=e.toArray(),!r&&this.sublayerIds&&this.sublayerIds.length&&(a=this.layer,o=this.sublayerIds.map((function(e){return a.findSublayerById(e)})).filter(Boolean)),s=0,l=o,n.label=1;case 1:return s<l.length?(u=l[s],p=u.watch("renderer, opacity, title, visible, legendEnabled",(function(){return y._constructLegendElementsForSublayers()})),this._handles.add(p,"sublayers-watcher"),u.visible&&u.legendEnabled?(c=u&&null!=u.opacity?u.opacity:null,d=null!=c?c*t:t,!u.renderer||u.sublayers?[3,5]:this.respectLayerVisibility&&!this._isSublayerInScale(u)?[3,4]:[4,u.load()]):[3,7]):[3,8];case 2:return n.sent(),[4,this._getRendererLegendElements(u.renderer,{title:u.title,opacity:d,sublayer:u})];case 3:f=n.sent(),Array.prototype.unshift.apply(i,f),n.label=4;case 4:return[3,7];case 5:return[4,this._generateSymbolTableElementForSublayer(u,d,r)];case 6:(h=n.sent())&&i.unshift(h),n.label=7;case 7:return s++,[3,1];case 8:return[2,i.filter((function(e){return!!e&&(!("infos"in e)||e.infos.length>0)}))]}}))}))},t.prototype._generateSymbolTableElementForSublayer=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var i,o,a;return n.__generator(this,(function(n){switch(n.label){case 0:if(r)return[3,4];r=new Map,i=new g.ExportImageParameters({layer:this.layer}),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this._getLegendLayers(i)];case 2:return n.sent().forEach((function(e){return r.set(e.layerId,e)})),[3,4];case 3:return i.destroy(),[7];case 4:return(o=r.get(e.id))||!e.sublayers?[3,6]:[4,this._generateLegendElementsForSublayers(e.sublayers,t,r)];case 5:return a=n.sent(),[2,{type:"symbol-table",title:e.title,infos:a}];case 6:return[2,this._generateSymbolTableElementForLegendLayer(o,e,t)]}}))}))},t.prototype._generateSymbolTableElementForLegendLayer=function(e,t,r){var n=this;if(!e||!e.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,t))return null;var i=t&&t.renderer,o=t&&t.title||e.layerName;if(i){var a=t&&t.title||this._getRendererTitle(i,t);a&&(o&&(a.title=o),o=a)}var s={type:"symbol-table",title:o,infos:[]};e.legendType&&(s.legendType=e.legendType);var l=t?this._sanitizeLegendForSublayer(e.legend.slice(),t):e.legend;return s.infos=l.map((function(t){var i=t.url;if(t.imageData&&t.imageData.length>0)i="data:image/png;base64,"+t.imageData;else{if(0===i.indexOf("http"))return null;i=h.addTokenParameter(n.layer.url+"/"+e.layerId+"/images/"+i)}return{label:t.label,src:i,opacity:null==r?n.layer.opacity:r,width:t.width,height:t.height}})).filter((function(e){return!!e})),s.infos.length?s:null},t.prototype._isSublayerInScale=function(e){var t=e.minScale||0,r=e.maxScale||0;return!(t>0&&t<this.scale||r>this.scale)},t.prototype._isLegendLayerInScale=function(e,t){var r=t||this.layer,n=null,i=null,o=!0;return!r.minScale&&0!==r.minScale||!r.maxScale&&0!==r.maxScale?(0===e.minScale&&r.tileInfo&&(n=r.tileInfo.lods[0].scale),0===e.maxScale&&r.tileInfo&&(i=r.tileInfo.lods[r.tileInfo.lods.length-1].scale)):(n=Math.min(r.minScale,e.minScale)||r.minScale||e.minScale,i=Math.max(r.maxScale,e.maxScale)),(n>0&&n<this.scale||i>this.scale)&&(o=!1),o},t.prototype._sanitizeLegendForSublayer=function(e,t){if("version"in this.layer&&this.layer.version<10.1||0===e.length)return e;var r=t.renderer,n=e.some((function(e){return e.values})),i=null,o=null;return n&&e.some((function(e,t){return e.values||(i=t,(o=e).label||(o.label="others")),null!=o})),r?"unique-value"===r.type?o&&(e.splice(i,1),e.push(o)):"class-breaks"===r.type&&(o&&e.splice(i,1),e.reverse(),o&&e.push(o)):o&&(e.splice(i,1),e.push(o)),e},t.prototype._getRendererLegendElements=function(e,t){return void 0===t&&(t={}),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){return function(e){return F(e)||j(e)||V(e)||D(e)||A(e)||U(e)||B(e)||G(e)||z(e)||J(e)||N(e)}(e)?function(e){return B(e)||G(e)||z(e)||function(e){return"esri.renderers.PointCloudRGBRenderer"===e.declaredClass}(e)}(e)?[2,this._constructPointCloudRendererLegendElements(e,t)]:J(e)?[2,this._constructDotDensityRendererLegendElements(e)]:[2,this._constructRendererLegendElements(e,t)]:(k.warn("Renderer not supported!"),[2,[]])}))}))},t.prototype._getPointCloudRendererTitle=function(e){return e.legendOptions&&e.legendOptions.title||e.field},t.prototype._constructPointCloudRendererLegendElements=function(e,t){var r=this;void 0===t&&(t={});var n=t.title,i=[],o=null,a=null;if(B(e))o={type:"symbol-table",title:n||this._getPointCloudRendererTitle(e),infos:[]},e.colorClassBreakInfos.forEach((function(e){o.infos.unshift({label:e.label||e.minValue+" - "+e.maxValue,value:[e.minValue,e.maxValue],symbol:r._getAppliedCloneSymbol(O,e.color)})}));else if(G(e)){var s=e.stops,l=null;if(s.length&&(1===s.length&&(l=s[0].color),!l)){var u=s[0].value,p=s[s.length-1].value;if(null!=u&&null!=p){var c=u+(p-u)/2;l=R.getColorFromPointCloudStops(c,s)}}o={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(O,l||O.color)}]};var d=R.getRampStopsForPointCloud(e.stops);a={type:"color-ramp",title:n||this._getPointCloudRendererTitle(e),infos:d,preview:w.renderColorRampPreviewHTML(d.map((function(e){return e.color})))}}else z(e)&&(o={type:"symbol-table",title:n||this._getPointCloudRendererTitle(e),infos:[]},e.colorUniqueValueInfos.forEach((function(e){o.infos.push({label:e.label||e.values.join(", "),value:e.values.join(", "),symbol:r._getAppliedCloneSymbol(O,e.color)})})));o&&o.infos.length&&i.push(o),a&&a.infos.length&&i.push(a);var h=i.reduce((function(e,t){return e.concat(t.infos)}),[]).filter((function(e){return!!e.symbol})).map((function(e){return r._getSymbolPreview(e,r.layer.opacity)}));return f.eachAlways(h).then((function(){return i}))},t.prototype._getElementInfoForDotDensity=function(e,t){var r=e.backgroundColor,n=e.outline,i=e.dotSize+"-"+t+"-"+r+"-"+(n&&JSON.stringify(n.toJSON())),o=this._dotDensityUrlCache,a=o.has(i)?o.get(i):w.renderDotDensityPreviewHTML(e,t);return o.set(i,a),{opacity:1,src:a.src,preview:a,width:a.width,height:a.height}},t.prototype._constructDotDensityRendererLegendElements=function(e){var t=this,r=e.calculateDotValue(this.view.scale),n=e.legendOptions&&e.legendOptions.unit,i={type:"symbol-table",title:{value:r&&Math.round(r),unit:n||""},infos:[]};return e.attributes.forEach((function(r){var n=t._getElementInfoForDotDensity(e,r.color);n.label=r.label||r.valueExpressionTitle||r.field,i.infos.push(n)})),f.resolve([i])},t.prototype._constructRendererLegendElements=function(e,t){return void 0===t&&(t={}),n.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,l,u,p,c,h,y,m,g,v,_,b,S,x,I,R,P,L,k,M,O,B,G,z,J,q,Z,Y,Q,X,K,$,ee,te,re,ne,ie,oe=this;return n.__generator(this,(function(n){switch(n.label){case 0:return r=t.title,i=t.sublayer,o=i||this.layer,[4,this._loadRenderer(e)];case 1:return s=n.sent(),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null,[4,this._getVisualVariableLegendElements(s,o)];case 2:return l=n.sent()||[],u={type:"symbol-table",title:r||this._getRendererTitle(s,o),infos:[]},p=null,c=!1,h=new Set,U(s)?(y=T.getHeatmapRampStops(s),l.push({type:"heatmap-ramp",title:r,infos:y,preview:w.renderColorRampPreviewHTML(y.map((function(e){return e.color})))}),[3,12]):[3,3];case 3:if(!V(s))return[3,4];if((m=s&&s.authoringInfo)&&"relationship"===m.type){if(g=m.focus,v=m.numClasses,_=m.field1,b=m.field2,v&&_&&b){for(S=[_,b],x=C.getRotationAngleForFocus(g)||0,I=0,R=S;I<R.length;I++)L=(P=R[I]).field,k=P.normalizationField,M=P.label,O=M||{field:this._getFieldAlias(L,o),normField:k&&this._getFieldAlias(k,o)},(B=W.clone()).angle=x,u.infos.push({label:O,symbol:B}),h.add(B),x+=90;G=C.getRelationshipRampElement({focus:g,numClasses:v,infos:s.uniqueValueInfos}),l.unshift(G)}}else z=s.field,s.uniqueValueInfos.forEach((function(e){if(e.symbol){var t=e.symbol.clone();H(oe.layer)&&(t=a.SimpleMarkerSymbol.fromJSON({color:t.color,style:"square"})),u.infos.push({label:e.label||oe._getDomainName(z,e.value,o)||e.value,value:e.value,symbol:t})}}));return s.defaultSymbol&&(u.infos.push({label:s.defaultLabel||"others",symbol:s.defaultSymbol}),c=!0),[3,12];case 4:return j(s)?((!(p=this._isUnclassedRenderer(s))||!this._hasSizeRamp)&&(s.classBreakInfos.forEach((function(e){if(e.symbol){var t=e.symbol.clone();H(oe.layer)&&(t=a.SimpleMarkerSymbol.fromJSON({color:t.color,style:"square"})),u.infos.unshift({label:e.label||(p?null:e.minValue+" - "+e.maxValue),value:[e.minValue,e.maxValue],symbol:t})}})),p&&(u.title=null),this._updateInfosforClassedSizeRenderer(s,u.infos)),s.defaultSymbol&&!p&&(u.infos.push({label:s.defaultLabel||"others",symbol:s.defaultSymbol}),c=!0),[3,12]):[3,5];case 5:return D(s)?function(e){return"esri.layers.ImageryTileLayer"===e.declaredClass}(this.layer)?("stretch-ramp"===(J=this._constructTileImageryStretchRendererElements(s)).type?l.push(J):u.infos=J,[3,10]):[3,6]:[3,11];case 6:return q=this.layer,Z=void 0,Y=void 0,s.statistics&&s.statistics.length&&(Z=s.statistics[0].min||s.statistics[0][0],Y=s.statistics[0].max||s.statistics[0][1]),Q=[],K=d.unwrap,q.renderingRule?[4,q.generateRasterInfo(q.renderingRule)]:[3,8];case 7:return $=n.sent(),[3,9];case 8:$=q.serviceRasterInfo,n.label=9;case 9:X=K.apply(void 0,[$]),ee=X.keyProperties.BandProperties,1===X.bandCount?(Z=Z||X.statistics&&X.statistics[0].min,Y=Y||X.statistics&&X.statistics[0].max,Z||Y?l.push(this._getStretchLegendElements(s,{min:Z,max:Y})):this.buildLegendElementsForTools()):q.bandIds&&1===q.bandIds.length?(Z=Z||X.statistics&&X.statistics[q.bandIds[0]].min,Y=Y||X.statistics&&X.statistics[q.bandIds[0]].max,Z||Y?l.push(this._getStretchLegendElements(s,{min:Z,max:Y})):this.buildLegendElementsForTools()):X.bandCount>=3?ee&&ee.length>=X.bandCount?q.bandIds&&3===q.bandIds.length?(Q=q.bandIds.map((function(e){return ee[e].BandName})),u.infos=this._createSymbolTableElementMultiBand(Q)):"lerc"===q.format?(Q=[0,1,2].map((function(e){return ee[e].BandName})),u.infos=this._createSymbolTableElementMultiBand(Q)):this.buildLegendElementsForTools():"lerc"===q.format?(Q=["band0","band1","band2"],u.infos=this._createSymbolTableElementMultiBand(Q)):this.buildLegendElementsForTools():this.buildLegendElementsForTools(),n.label=10;case 10:return[3,12];case 11:A(s)?s.colormapInfos.forEach((function(e){u.infos.push({label:e.label,value:e.value,symbol:oe._getAppliedCloneSymbol(E,e.color)})})):F(s)?s.symbol&&!this._hasSizeRamp&&u.infos.push({label:s.label,symbol:s.symbol}):N(s)&&l.push(this._getStretchLegendElements(s,{min:0,max:255})),n.label=12;case 12:return!(te=s.defaultSymbol)||c||F(s)||p&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||l.push({type:"symbol-table",infos:[{label:s.defaultLabel||"others",symbol:te}]}),u.infos.length&&l.unshift(u),re=null==t.opacity?o.opacity:t.opacity,ne=this._getSymbolConfig("visualVariables"in s&&s.visualVariables),ie=l.reduce((function(e,t){return e.concat(t.infos)}),[]).filter((function(e){return!(!e||!e.symbol)})).map((function(e){return oe._getSymbolPreview(e,re,{applyScaleDrivenSize:!h.has(e.symbol),symbolConfig:ne})})),s=null,[4,f.eachAlways(ie)];case 13:return n.sent(),[2,l]}}))}))},t.prototype._constructTileImageryStretchRendererElements=function(e){var t,r,n,i=this.layer,o=i.rasterInfo,a=o.bandCount||e.statistics.length,s=o.keyProperties&&o.keyProperties.BandProperties;if(e.statistics&&e.statistics.length&&(t=void 0!==e.statistics[0].min?e.statistics[0].min:e.statistics[0][0],r=e.statistics[0].max||e.statistics[0][1]),1===o.bandCount)return this._getStretchLegendElements(e,{min:t,max:r});function l(e){var t=(i.bandIds&&i.bandIds.length?i.bandIds:[0,1,2]).map((function(t){return e&&e[t]&&e[t].BandName||"band"+t}));return t.length<3?t.push(t[1]):t.length>3&&t.splice(3),t}return n=s&&s.length>=a?l(s):l(),this._createSymbolTableElementMultiBand(n)},t.prototype._getStretchLegendElements=function(e,t){var r=e.colorRamp,n=R.getStrectchRampStops(r,t);return{type:"stretch-ramp",title:"",infos:n,preview:w.renderColorRampPreviewHTML(n.map((function(e){return e.color})))}},t.prototype._createSymbolTableElementMultiBand=function(e){var t=[],r=["red","green","blue"];return e.forEach((function(e,n){t.push({label:{colorName:r[n],bandName:e},src:L.RGB_IMG_SOURCE[n],opacity:1})})),t},t.prototype._updateInfosforClassedSizeRenderer=function(e,t){var r=e.authoringInfo&&"class-breaks-size"===e.authoringInfo.type,n=e.classBreakInfos.some((function(e){return S.isVolumetricSymbol(e.symbol)}));if(r&&n){var i=P.REAL_WORLD_MAX_SIZE,o=P.REAL_WORLD_MIN_SIZE,a=e.classBreakInfos.length,s=(i-o)/(a>1?a-1:a);t.forEach((function(e,t){e.size=i-s*t}))}},t.prototype._getSymbolConfig=function(e){var t=!1,r=!1;if(e)for(var n=0;n<e.length&&(!t||!r);n++){var i=e[n];"size"===i.type&&("height"===i.axis&&(t=!0),"width-and-depth"===i.axis&&(r=!0))}return t&&r?"tall":null},t.prototype._getSymbolPreview=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){var o,a;return n.__generator(this,(function(n){switch(n.label){case 0:return o=e.size,this._scaleDrivenSizeVariable&&(null==i?void 0:i.applyScaleDrivenSize)?[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))]:[3,2];case 1:a=n.sent().getSize,o=a(this._scaleDrivenSizeVariable,null,{view:this.view,scale:this.scale,shape:"simple-marker"===e.symbol.type?e.symbol.style:null}),n.label=2;case 2:return[2,w.renderPreviewHTML(e.symbol,{size:o,opacity:t,symbolConfig:null==i?void 0:i.symbolConfig,rotation:e.symbol.angle}).then((function(t){return e.preview=t,e})).catch((function(){return e.preview=null,e}))]}}))}))},t.prototype._loadRenderer=function(e){var t,r;return n.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,l,u,p,c,h,y,m,g,v=this;return n.__generator(this,(function(n){switch(n.label){case 0:return i=[],o=this.layer,e=e.clone(),this._hasClusterSizeVariable=!1,a="visualVariables"in e&&(null===(t=e.visualVariables)||void 0===t?void 0:t.some((function(e){return"size"===e.type&&"outline"!==e.target&&!M.test(e.valueExpression)}))),e&&"visualVariables"in e&&!a&&"featureReduction"in o&&"cluster"===(null===(r=o.featureReduction)||void 0===r?void 0:r.type)&&(s=this.layerView._effectiveRenderer,(l=d.unwrap(I.getClusterSizeVariable(s,this.view)))&&("clusterMinSize"in(u=o.featureReduction)&&"clusterMaxSize"in u&&(p=u.clusterMinSize,c=u.clusterMaxSize,l.legendOptions=new b({showLegend:p!==c})),h=e.visualVariables||[],e.visualVariables=h.concat([l]),this._hasClusterSizeVariable=!0)),[4,this._getMedianColor(e)];case 1:return y=n.sent(),(j(e)||V(e))&&(m=e.classBreakInfos||e.uniqueValueInfos,g=m.map((function(e){return v._fetchSymbol(e.symbol,y).then((function(t){e.symbol=t})).catch((function(){e.symbol=null}))})),Array.prototype.push.apply(i,g)),i.push(this._fetchSymbol(e.symbol||e.defaultSymbol,e.defaultSymbol?null:y).then((function(t){v._applySymbolToRenderer(e,t,F(e))})).catch((function(){v._applySymbolToRenderer(e,null,F(e))}))),[2,f.eachAlways(i).then((function(){return e}))]}}))}))},t.prototype._applySymbolToRenderer=function(e,t,r){r?e.symbol=t:e.defaultSymbol=t},t.prototype._getMedianColor=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,i,o,a;return n.__generator(this,(function(n){switch(n.label){case 0:if(!("visualVariables"in e)||!e.visualVariables)return[2,null];if(!(t=l.find(e.visualVariables,(function(e){return"color"===e.type}))))return[2,null];if(i=null,o=null,t.stops){if(1===t.stops.length)return[2,t.stops[0].color];i=t.stops[0].value,o=t.stops[t.stops.length-1].value}return a=i+(o-i)/2,[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return[2,(0,n.sent().getColor)(t,a)]}}))}))},t.prototype._fetchSymbol=function(e,t){var r=this;if(!e)return f.reject();if("web-style"===e.type){var n=e.portal,i=n&&n.url,o=n&&n.user&&n.user.username,a=e.name+"-"+e.styleName+"-"+e.styleUrl+"-"+i+"-"+o,s=this._webStyleSymbolCache;return s.has(a)||(this.view instanceof x?s.set(a,e.fetchCIMSymbol()):s.set(a,e.fetchSymbol())),s.get(a).then((function(e){return r._getAppliedCloneSymbol(e,t)})).catch((function(){return k.warn("Fetching web-style failed!"),f.reject()}))}return f.resolve(this._getAppliedCloneSymbol(e,t))},t.prototype._getAppliedCloneSymbol=function(e,t){if(!e)return e;var r=e.clone(),n=r.type.indexOf("3d")>-1,o=t&&t.toRgba();return n?this._applyColorTo3dSymbol(r,o):r.color&&(r.color=new i(o||r.color)),r},t.prototype._applyColorTo3dSymbol=function(e,t){t&&e.symbolLayers.forEach((function(e){e&&(e.material||(e.material={}),e.material.color=new i(t))}))},t.prototype._getVisualVariableLegendElements=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,s,l,u,p,c,h,y,m,g=this;return n.__generator(this,(function(_){switch(_.label){case 0:if(!("visualVariables"in e)||!e.visualVariables)return[2,null];for(r=e.visualVariables,i=[],o=[],a=[],s=0,l=r;s<l.length;s++)"color"===(u=l[s]).type?i.push(u):"size"===u.type?o.push(u):"opacity"===u.type&&a.push(u);return p=n.__spreadArrays(i,o,a),0===i.length&&j(e)&&e.classBreakInfos&&1===e.classBreakInfos.length&&(y=e.classBreakInfos[0],c=y&&y.symbol),0===i.length&&F(e)&&(c=e.symbol),c&&(c.type.indexOf("3d")>-1?"water"===(m=c.symbolLayers.getItemAt(0)).type?d.isSome(m.color)&&(h=m.color):d.isSome(m.material)&&d.isSome(m.material.color)&&(h=m.material.color):c.url||(h=c.color)),[4,f.all(p.map((function(r){return n.__awaiter(g,void 0,void 0,(function(){var i,o,a,s,l,u,p,c;return n.__generator(this,(function(n){switch(n.label){case 0:return r.legendOptions&&!1===r.legendOptions.showLegend?[3,10]:(i=this._getRampTitle(r,t),o=null,a="getField"in t&&t.getField&&t.getField(r.field),s=a&&v.isDateField(a),"color"!==r.type?[3,2]:[4,R.getRampStops(r,null,s)]);case 1:return c=n.sent(),o={type:"color-ramp",title:i,infos:c,preview:w.renderColorRampPreviewHTML(c.map((function(e){return e.color})))},this._hasColorRamp||(this._hasColorRamp=!(null==o.infos||!o.infos.length)),[3,9];case 2:return"size"!==r.type||"outline"===r.target?[3,7]:M.test(r.valueExpression)?(this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=r),[3,6]):[3,3];case 3:return l={type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(r):i},u=P.getRampStops,p=[e,r],[4,this._getMedianColor(e)];case 4:return[4,u.apply(void 0,p.concat([n.sent(),this.scale,this.view,s]))];case 5:l.infos=n.sent(),o=l,this._hasSizeRamp||(this._hasSizeRamp=!(null==o.infos||!o.infos.length)),n.label=6;case 6:return[3,9];case 7:return"opacity"!==r.type?[3,9]:[4,R.getRampStops(r,h,s)];case 8:c=n.sent(),o={type:"opacity-ramp",title:i,infos:c,preview:w.renderColorRampPreviewHTML(c.map((function(e){return e.color})))},this._hasOpacityRamp||(this._hasOpacityRamp=!(null==o.infos||!o.infos.length)),n.label=9;case 9:return[2,o&&o.infos?o:null];case 10:return[2,void 0]}}))}))})))];case 1:return[2,_.sent().filter((function(e){return!!e}))]}}))}))},t.prototype._getDomainName=function(e,t,r){if(e&&"function"!=typeof e){var n="getField"in r&&r.getField&&r.getField(e),i=n&&"getFieldDomain"in r&&r.getFieldDomain?r.getFieldDomain(n.name):null;return i&&"coded-value"===i.type?i.getName(t):null}return null},t.prototype._getClusterTitle=function(e){var t=this.layer,r=e.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type){var n=t.featureReduction,i="popupTemplate"in n&&n.popupTemplate,o=i&&i.fieldInfos;if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(l.fieldName===r)return"cluster_count"===r?l.label||{showCount:!0}:l.label}}return{showCount:!0}},t.prototype._getRampTitle=function(e,t){var r=e.field,n=e.normalizationField,i=!1,o=!1,a=!1,s=null;r="function"==typeof r?null:r,n="function"==typeof n?null:n;var l=e.legendOptions&&e.legendOptions.title;if(null!=l)s=l;else if(e.valueExpressionTitle)s=e.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo&&t.renderer.authoringInfo.visualVariables)for(var u=t.renderer.authoringInfo.visualVariables,p=0;p<u.length;p++){var c=u[p];if("color"===c.type){if("ratio"===c.style){i=!0;break}if("percent"===c.style){o=!0;break}if("percent-of-total"===c.style){a=!0;break}}}s={field:r&&this._getFieldAlias(r,t),normField:n&&this._getFieldAlias(n,t),ratio:i,ratioPercent:o,ratioPercentTotal:a}}return s},t.prototype._getRendererTitle=function(e,t){var r=e;if(r.legendOptions&&r.legendOptions.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;var n=r.field,i=null,o=null;j(r)&&(i=r.normalizationField,o="percent-of-total"===r.normalizationType),i="function"==typeof i?null:i;var a=null;return((n="function"==typeof n?null:n)||i)&&(a={field:n&&this._getFieldAlias(n,t),normField:i&&this._getFieldAlias(i,t),normByPct:o}),a},t.prototype._getFieldAlias=function(e,t){var r="popupTemplate"in t&&t.popupTemplate,n=r&&r.fieldInfos,i=null;n&&n.some((function(t){return e===t.fieldName&&(i=t,!0)}));var o=null;"getField"in t&&t.getField?o=t.getField(e):"fieldsIndex"in t&&t.fieldsIndex&&(o=t.fieldsIndex.get(e));var a=i||o,s=null;return a&&(s=i&&i.label||o&&o.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName),s},t.prototype._isUnclassedRenderer=function(e){var t=e.visualVariables,r=!1;return j(e)&&e.classBreakInfos&&1===e.classBreakInfos.length&&t&&(r=e.field?t.some((function(t){return!(!t||e.field!==t.field||(e.normalizationField||t.normalizationField)&&e.normalizationField!==t.normalizationField)})):!!t.length),r},n.__decorate([m.property()],t.prototype,"children",void 0),n.__decorate([m.property()],t.prototype,"layerView",void 0),n.__decorate([m.property()],t.prototype,"layer",void 0),n.__decorate([m.property()],t.prototype,"legendElements",void 0),n.__decorate([m.property()],t.prototype,"parent",void 0),n.__decorate([m.property({readOnly:!0})],t.prototype,"ready",null),n.__decorate([m.property()],t.prototype,"keepCacheOnDestroy",void 0),n.__decorate([m.property()],t.prototype,"respectLayerVisibility",void 0),n.__decorate([m.property({dependsOn:["view.scale"],readOnly:!0})],t.prototype,"scale",null),n.__decorate([m.property()],t.prototype,"sublayerIds",void 0),n.__decorate([m.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?","layer.featureReduction?","scale"],readOnly:!0})],t.prototype,"isScaleDriven",null),n.__decorate([m.property()],t.prototype,"title",void 0),n.__decorate([m.property({dependsOn:["ready"],readOnly:!0,value:0})],t.prototype,"version",null),n.__decorate([m.property()],t.prototype,"view",void 0),n.__decorate([m.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],t)}(s)}.apply(null,n))||(e.exports=i)},678:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(177),r(152),r(246),r(679),r(680),r(503),r(681),r(357),r(161)],void 0===(i=function(e,t,n,i,o,a,s,l,u,p,c){Object.defineProperty(t,"__esModule",{value:!0});var d=null;function f(e,t){return Math.floor(Math.random()*(t-e+1)+e)}t.renderDotDensityPreviewHTML=function(e,t,r){var n=e.backgroundColor,i=e.outline,o=e.dotSize,a=r&&r.swatchSize||22,s=Math.round(a*a/Math.pow(o,2)*.8),l=window.devicePixelRatio,u=document.createElement("canvas"),p=a*l;u.width=p,u.height=p,u.style.width=u.width/l+"px",u.style.height=u.height/l+"px";var c=u.getContext("2d");if(n&&(c.fillStyle=n.toCss(!0),c.fillRect(0,0,p,p),c.fill()),c.fillStyle=t.toCss(!0),d&&d.length/2===s)for(var h=0;h<2*s;h+=2){var y=d[h],m=d[h+1];c.fillRect(y,m,o*l,o*l),c.fill()}else for(d=[],h=0;h<2*s;h+=2)y=f(0,p),m=f(0,p),d.push(y,m),c.fillRect(y,m,o*l,o*l),c.fill();i&&(i.color&&(c.strokeStyle=i.color.toCss(!0)),c.lineWidth=i.width,c.strokeRect(0,0,p,p));var g=new Image(a,a);return g.src=u.toDataURL(),g},t.renderColorRampPreviewHTML=function(e,t){void 0===t&&(t={});var r="horizontal"===t.align,n=r?75:24,i=r?24:75,o=t.width,a=void 0===o?n:o,s=t.height,l=void 0===s?i:s,u=t.gradient,p=void 0===u||u,c=window.devicePixelRatio,d=a*c,f=l*c,h=document.createElement("canvas");h.width=d,h.height=f,h.style.width=a+"px",h.style.height=l+"px";var y=h.getContext("2d"),m=r?d:0,g=r?0:f;if(p){var v=y.createLinearGradient(0,0,m,g),_=1/(e.length-1);e.forEach((function(e,t){return v.addColorStop(t*_,e.toString())})),y.fillStyle=v,y.fillRect(0,0,d,f)}else for(var b=r?d/e.length:d,w=r?f:f/e.length,S=0,x=0,I=0,R=e;I<R.length;I++){var T=R[I];y.fillStyle=T.toString(),y.fillRect(S,x,b,w),S=r?S+b:0,x=r?0:x+w}var C=document.createElement("div");return C.style.width=a+"px",C.style.height=l+"px",C.appendChild(h),C},t.renderPreviewHTML=function e(t,r){switch(t.type){case"web-style":return p.previewWebStyleSymbol(t,e,r);case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return u.previewSymbol3D(t,r);case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":return l.previewSymbol2D(t,r);case"cim":return s.previewCIMSymbol(t,r);default:return void i.neverReached(t)}},t.getDisplayedSymbol=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var i,s,l,u,p,d,f,h,y,m,g,v,_,b,w,S,x,I,R,T,C,P,L;return n.__generator(this,(function(k){switch(k.label){case 0:return e?(i=function e(t){return t&&"opacity"in t?t.opacity*e(t.parent):1}(e.layer||e.sourceLayer),!o.isSome(e.symbol)||o.isSome(t)&&!0===t.ignoreGraphicSymbol?[3,4]:"web-style"!==e.symbol.type?[3,2]:[4,e.symbol.fetchSymbol(o.isSome(t)?t.abortOptions:null)]):[2,void 0];case 1:return l=k.sent(),[3,3];case 2:l=e.symbol.clone(),k.label=3;case 3:return s=l,c.applyColorToSymbol(s,null,i),[2,s];case 4:return[4,(u=o.isSome(t)&&t.renderer||e.get("layer.renderer")||e.get("sourceLayer.renderer")).getSymbolAsync(e)];case 5:return(p=k.sent())?"web-style"!==p.type?[3,7]:[4,p.fetchSymbol(o.isSome(t)?t.abortOptions:null)]:[2,void 0];case 6:return p=k.sent(),[3,8];case 7:p=p.clone(),k.label=8;case 8:return!("visualVariables"in u)||"visualVariables"in u&&!u.visualVariables||"visualVariables"in u&&u.visualVariables&&!u.visualVariables.length?[2,p]:u.arcadeRequiredForVisualVariables&&(o.isNone(t)||o.isNone(t.arcade))?(d=n.__assign({},o.unwrap(t)),f=d,[4,a.loadArcade()]):[3,10];case 9:f.arcade=k.sent(),t=d,k.label=10;case 10:return[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 11:for(h=k.sent(),y=[],m=[],g=[],v=[],_=0,b=u.visualVariables;_<b.length;_++)switch((w=b[_]).type){case"color":y.push(w);break;case"opacity":m.push(w);break;case"rotation":v.push(w);break;case"size":w.target||g.push(w)}return S=!!y.length&&y[y.length-1],x=S?h.getColor(S,e,t):null,I=!!m.length&&m[m.length-1],R=I?h.getOpacity(I,e,t):null,null!=i&&(R=null!=R?R*i:i),c.applyColorToSymbol(p,x,R),g.length?(T=h.getAllSizes(g,e,t),[4,c.applySizesToSymbol(p,T)]):[3,13];case 12:k.sent(),k.label=13;case 13:for(C=0,P=v;C<P.length;C++)L=P[C],c.applyRotationToSymbol(p,h.getRotationAngle(L,e,t),L.axis);return[2,p]}}))}))}}.apply(null,n))||(e.exports=i)},679:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(813)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=new n.CIMSymbolRasterizer(null,!0);t.previewCIMSymbol=function(e,t){return void 0===t&&(t={}),r.__awaiter(this,void 0,void 0,(function(){var n,o,a,s,l,u,p,c,d,f,h;return r.__generator(this,(function(r){switch(r.label){case 0:return n=t.size,o=t.maxSize,a=t.feature,s=t.fieldMap,l=t.geometryType,u=t.style,p=Math.min(n||22,o||120),c=3,e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(c=1),[4,i.rasterizeCIMSymbolAsync(e,a,s,l,{targetSize:p*c,style:u})];case 1:return d=r.sent(),(f=document.createElement("canvas")).width=d.imageData.width,f.height=d.imageData.height,f.getContext("2d").putImageData(d.imageData,0,0),(h=new Image(f.width/c,f.height/c)).src=f.toDataURL(),[2,h]}}))}))}}.apply(null,n))||(e.exports=i)},680:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(154),r(153),r(171),r(420),r(501),r(502)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=document.createElement("canvas");t.previewSymbol2D=function(e,t){var u=t&&t.size?i.pt2px(t.size):null,p=t&&t.maxSize?i.pt2px(t.maxSize):null,c=t&&null!=t.opacity?t.opacity:null,d=t&&null!=t.rotation?t.rotation:null,f=o.getStroke(e),h={shape:null,fill:null,stroke:f};f&&f.width&&(f.width=Math.min(f.width,80));var y=0,m=0;switch(e.type){case"simple-marker":var g=e.style,v=i.pt2px(e.size);switch(y=Math.min(u||v||22,p||120),m=Math.min(u||v||22,p||120),g){case"circle":h.shape={type:"circle",cx:.5*v,cy:.5*v,r:.5*v};break;case"cross":h.shape={type:"path",path:[{command:"M",values:[0,.5*m]},{command:"L",values:[y,.5*m]},{command:"M",values:[.5*y,0]},{command:"L",values:[.5*y,m]}]};break;case"diamond":h.shape={type:"path",path:[{command:"M",values:[0,.5*m]},{command:"L",values:[.5*y,0]},{command:"L",values:[y,.5*m]},{command:"L",values:[.5*y,m]},{command:"Z",values:[]}]};break;case"square":h.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[y,0]},{command:"L",values:[y,m]},{command:"L",values:[0,m]},{command:"Z",values:[]}]};break;case"triangle":h.shape={type:"path",path:[{command:"M",values:[.5*y,0]},{command:"L",values:[y,m]},{command:"L",values:[0,m]},{command:"Z",values:[]}]};break;case"x":h.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[y,m]},{command:"M",values:[y,0]},{command:"L",values:[0,m]}]};break;case"path":h.shape={type:"path",path:e.path||""}}break;case"simple-line":var _=Math.min(u||f&&f.width||22,p||80),b=_>22?2*_:40;f.width=_,y=b,m=_,h.shape={type:"path",path:[{command:"M",values:[0,m]},{command:"L",values:[y,m]}]};break;case"picture-fill":case"simple-fill":y=Math.min(u||22,p||120),m=Math.min(u||22,p||120),h.shape=a.shapes.fill[0];break;case"picture-marker":var w=i.pt2px(e.width),S=i.pt2px(e.height),x=Math.max(w,S),I=w/S;w=I<=1?Math.ceil(x*I):x,S=I<=1?x:Math.ceil(x/I),y=Math.min(u||w||22,p||120),m=Math.min(u||S||22,p||120),h.shape={type:"image",x:-Math.round(y/2),y:-Math.round(m/2),width:y,height:m,src:e.url||""};break;case"text":var R=e,T=R.text||"Aa",C=R.font,P=Math.min(u||i.pt2px(C.size),p||120),L=function(e,t){var r=l.getContext("2d"),n=[];return t&&(t.weight&&n.push(t.weight),t.size&&n.push(t.size+"px"),t.family&&n.push(t.family)),r.font=n.join(" "),r.measureText(e).width}(T,{weight:C.weight,size:P,family:C.family}),k=/[\uE600-\uE6FF]/.test(T);y=k?P:L,m=P;var M=.25*function(e){if(0===e.length)return 0;if(e.length>2){var t=i.px2pt(1),r=parseFloat(e);switch(e.slice(-2)){case"px":return r;case"pt":return r*t;case"in":return 72*r*t;case"pc":return 12*r*t;case"mm":return r*(7.2/2.54)*t;case"cm":return r*(72/2.54)*t}}return parseFloat(e)}((C?P:0).toString());k&&(M+=5),h.shape={type:"text",text:T,x:0,y:M,align:"middle",decoration:C&&C.decoration,rotated:R.rotated,kerning:R.kerning},h.font=C&&{size:P,style:C.style,decoration:C.decoration,weight:C.weight,family:C.family}}if(!h.shape)return n.reject(new r("symbolPreview: renderPreviewHTML2D","symbol not supported."));var O=o.getFill(e),E=O,A=e.color,D=null;return E&&"pattern"===E.type&&A&&"picture-fill"!==e.type?D=o.getPatternUrlWithColor(E.src,A.toCss(!0)).then((function(e){return E.src=e,h.fill=E,h})):(h.fill=O,D=n.resolve(h)),D.then((function(e){return s.renderSymbol([[e]],[y,m],{node:t&&t.node,scale:!0,opacity:c,rotation:d})}))}}.apply(null,n))||(e.exports=i)},681:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(165),r(171)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.previewWebStyleSymbol=function(e,t,i){var o=e.thumbnail&&e.thumbnail.url;return o?r(o,{responseType:"image"}).then((function(e){var t=function(e,t){var r=!/\\.svg$/i.test(e.src)&&t&&t.disableUpsampling,i=Math.max(e.width,e.height),o=t&&null!=t.maxSize?n.pt2px(t.maxSize):120;r&&(o=Math.min(i,o));var a=Math.min(o,t&&null!=t.size?n.pt2px(t.size):i);if(a!==i){var s=0!==e.width&&0!==e.height?e.width/e.height:1;s>=1?(e.width=a,e.height=a/s):(e.width=a*s,e.height=a)}return e}(e.data,i);return i&&i.node?(i.node.appendChild(t),i.node):t})):e.fetchSymbol().then((function(e){return t(e,i)}))}}.apply(null,n))||(e.exports=i)},682:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(180),r(433)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getClusterSizeVariable=function(e,t){if(!(e&&"visualVariables"in e&&e.visualVariables))return null;var i=r.find(e.visualVariables,(function(e){return"size"===e.type})),o=function(e,t){var r=e.featuresTilingScheme.getClosestInfoForScale(e.scale).level;return t.levels?t.levels[r]:null}(t,i);return o?new n({field:i.field,minSize:o[2].size,minDataValue:o[2].value,maxSize:o[3].size,maxDataValue:o[3].value}):null}}.apply(null,n))||(e.exports=i)},683:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(182),r(153),r(397),r(161)],void 0===(i=function(e,t,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=new i([64,64,64]);function l(e,t){var r=[],n=e.length-1;return 5===e.length?r.push(0,2,4):r.push(0,n),e.map((function(e,i){return r.indexOf(i)>-1?a.createStopLabel(e,i,n,t):null}))}function u(e,t,o){return void 0===o&&(o=s),n.__awaiter(this,void 0,void 0,(function(){var a,s;return n.__generator(this,(function(n){switch(n.label){case 0:return a=new i(o),[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return null!=(s=n.sent().getOpacity(t,e))&&(a.a=s),[2,a]}}))}))}function p(e,t){var r=function(e,t){var r=0,n=t.length-1;return t.some((function(t,i){return e<t.value?(n=i,!0):(r=i,!1)})),{startIndex:r,endIndex:n,weight:(e-t[r].value)/(t[n].value-t[r].value)}}(e,t),n=r.startIndex,o=r.endIndex,a=r.weight;if(n===o)return t[n].color;var s=i.blendColors(t[n].color,t[o].color,a);return new i(s)}t.getRampStops=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){var a,s,p,c,d,f,h,y=this;return n.__generator(this,(function(m){switch(m.label){case 0:return a=!1,s=[],p=[],e.stops&&(c=e.stops,s=c.map((function(e){return e.value})),(a=c.some((function(e){return!!e.label})))&&(p=c.map((function(e){return e.label})))),d=s[0],f=s[s.length-1],null==d&&null==f?[2,null]:(h=a?null:l(s,i),[4,o.all(s.map((function(i,o){return n.__awaiter(y,void 0,void 0,(function(){var s,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return"opacity"!==e.type?[3,2]:[4,u(i,e,t)];case 1:return l=n.sent(),[3,4];case 2:return[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 3:l=n.sent().getColor(e,i),n.label=4;case 4:return s=l,c=a?p[o]:h[o],[2,{value:i,color:s,label:c}]}}))}))})))]);case 1:return[2,m.sent().reverse()]}}))}))},t.getRampStopsForPointCloud=function(e){var t,r=[],n=[];r=e.map((function(e){return e.value})),(t=e.some((function(e){return!!e.label})))&&(n=e.map((function(e){return e.label})));var i=r[0],o=r[r.length-1];if(null==i&&null==o)return null;var a=t?null:l(r,!1);return r.map((function(r,i){return{value:r,color:p(r,e),label:t?n[i]:a[i]}})).reverse()},t.getColorFromPointCloudStops=p,t.getStrectchRampStops=function(e,t){var r=[];if(e&&"multipart"===e.type)e.colorRamps.reverse().forEach((function(n,o){0===o?r.push({value:t.max,color:new i(n.toColor),label:"high"}):r.push({value:null,color:new i(n.toColor),label:""}),o===e.colorRamps.length-1?r.push({value:t.min,color:new i(n.fromColor),label:"low"}):r.push({value:null,color:new i(n.fromColor),label:""})}));else{var n=void 0,o=void 0;e&&"algorithmic"===e.type?(n=e.fromColor,o=e.toColor):(n=[0,0,0,1],o=[255,255,255,1]),r=[{value:t.max,color:new i(o),label:"high"},{value:t.min,color:new i(n),label:"low"}]}return r}}.apply(null,n))||(e.exports=i)},684:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(783)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getHeatmapRampStops=function(e){var t=e.colorStops,n=t.length-1;if(t&&t[0]){var i=t[n];i&&1!==i.ratio&&((t=t.slice(0)).push(new r({ratio:1,color:i.color})),n++)}return t.map((function(e,t){var r="";return 0===t?r="low":t===n&&(r="high"),{color:e.color,label:r,ratio:e.ratio}})).reverse()}}.apply(null,n))||(e.exports=i)},685:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(420),r(503)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i={HH:315,HL:45,LL:135,LH:225},o={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function a(e){if(e){var t,i=e.type;return i.indexOf("3d")>-1?n.getSymbolLayerFill(e.symbolLayers.getItemAt(0)):"simple-line"===i?(t=r.getStroke(e))&&t.color:"simple-marker"!==e.type||"x"!==e.style&&"cross"!==e.style?r.getFill(e):(t=r.getStroke(e))&&t.color}}function s(e){var t=i[e];return e&&null==t&&(t=i.HH),t||0}t.getRelationshipRampElement=function(e){var t=e.focus,r=e.infos,n=e.numClasses,i=o[n],l={};r.forEach((function(e){l[e.value]={label:e.label,fill:a(e.symbol)}}));for(var u=[],p=0;p<n;p++){for(var c=[],d=0;d<n;d++){var f=l[i[p][d]];c.push(f.fill)}u.push(c)}return{type:"relationship-ramp",numClasses:n,focus:t,colors:u,labels:function(e,t){var r=t.HH.label,n=t.LL.label,i=t.HL.label,o=t.LH.label;switch(e){case"HH":return{top:r,bottom:n,left:i,right:o};case"HL":return{top:i,bottom:o,left:n,right:r};case"LL":return{top:n,bottom:r,left:o,right:i};case"LH":return{top:o,bottom:i,left:r,right:n};default:return{top:r,bottom:n,left:i,right:o}}}(t,l),rotation:s(t)}},t.getRotationAngleForFocus=s}.apply(null,n))||(e.exports=i)},686:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(239),r(153),r(434),r(357),r(397),r(161)],void 0===(i=function(e,t,n,i,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0}),t.REAL_WORLD_MAX_SIZE=30,t.REAL_WORLD_MIN_SIZE=12;var u=[255,255,255],p=[200,200,200],c=[128,128,128];function d(e,t,i,o){return n.__awaiter(this,void 0,void 0,(function(){var s,l,u,p,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:if(s=n.sent().getSizeRangeAtScale(e,i,o),l=s&&function(e){for(var t=e.minSize,r=(e.maxSize-t)/4,n=[],i=0;i<5;i++)n.push(t+r*i);return n}(s),!s&&!l)return[2,void 0];u=l.map((function(t){return function(e,t,r){var n=r.minSize,i=r.maxSize,o=t.minDataValue,a=t.maxDataValue;return e<=n?o:e>=i?a:(e-n)/(i-n)*(a-o)+o}(t,e,s)})),u=a.round(u),p=1,n.label=2;case 2:return p<u.length-1?[4,f(e,t,u[p],u[p-1],i,o)]:[3,5];case 3:(c=n.sent())&&(u[p]=c[0],l[p]=c[1]),n.label=4;case 4:return p++,[3,2];case 5:return[2,u]}}))}))}function f(e,t,r,i,o,s){return n.__awaiter(this,void 0,void 0,(function(){var l,u,p,c,d,f,y,m,g,v,_,b,w,S,x,I,R,T,C,P,L,k;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,h(e,t,r,o,s)];case 1:return l=n.sent(),[4,h(e,t,i,o,s)];case 2:u=n.sent(),p=a.numDigits(r),c=p.fractional,d=20,f=p.integer,y=null,m=null,r>0&&r<1&&(y=Math.pow(10,c),r*=y,f=a.numDigits(r).integer),g=f-1,n.label=3;case 3:return g>=0?(v=Math.pow(10,g),_=Math.floor(r/v)*v,b=Math.ceil(r/v)*v,null!=y&&(_/=y,b/=y),w=(_+b)/2,k=a.round([_,w,b],{indexes:[1]}),w=k[1],[4,h(e,t,_,o,s)]):[3,8];case 4:return S=n.sent(),[4,h(e,t,b,o,s)];case 5:return x=n.sent(),[4,h(e,t,w,o,s)];case 6:if(I=n.sent(),R=a.percentChange(l,S,u,null),T=a.percentChange(l,x,u,null),C=a.percentChange(l,I,u,null),P=R.previous<=d,L=T.previous<=d,P&&L&&(R.previous<=T.previous?(P=!0,L=!1):(L=!0,P=!1)),P?m=[_,S]:L?m=[b,x]:C.previous<=d&&(m=[w,I]),m)return[3,8];n.label=7;case 7:return g--,[3,3];case 8:return[2,m]}}))}))}function h(e,t,i,o,a){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return[2,(0,n.sent().getSize)(e,i,{scale:o,view:a,shape:"simple-marker"===t.type?t.style:null})]}}))}))}t.getRampStops=function(e,r,f,y,m,g){return n.__awaiter(this,void 0,void 0,(function(){var v,_,b,w,S,x,I,R,T,C,P,L,k,M,O,E,A=this;return n.__generator(this,(function(D){switch(D.label){case 0:return v=r.legendOptions,_=v&&v.customValues,b=function(e,t){var r=null,n=null;if("simple"===e.type)r=e.symbol;else if("class-breaks"===e.type){var o=e.classBreakInfos;r=o&&o[0]&&o[0].symbol,n=o.length>1}else"unique-value"===e.type&&(r=(o=e.uniqueValueInfos)&&o[0]&&o[0].symbol,n=o.length>1);return!r||function(e){return!!e&&(i.isSymbol3D(e)?!!e.symbolLayers&&e.symbolLayers.some((function(e){return e&&"fill"===e.type})):-1!==e.type.indexOf("fill"))}(r)?null:(r=r.clone(),(t||n)&&(r.type.indexOf("3d")>-1?function(e){s.isVolumetricSymbol(e)||("line-3d"===e.type?e.symbolLayers.forEach((function(e){e.material={color:c}})):e.symbolLayers.forEach((function(e){"icon"!==e.type||e.resource&&e.resource.href?e.material={color:p}:(e.material={color:u},e.outline={color:c,size:1.5})})))}(r):function(e){-1!==e.type.indexOf("line")?e.color=c:(e.color=u,"simple-marker"===e.type&&(e.outline={color:c,width:1.5}))}(r)),r)}(e,f),w=!!b,S=!!_,x=null!=r.minSize&&null!=r.maxSize,I=r.stops&&r.stops.length>1,R=!!r.target,w&&(S||x||I&&!R)?(T=s.isVolumetricSymbol(b),C=null,P=null,L=null,!T||I?[3,1]:(P=a.round([r.minDataValue,r.maxDataValue]),[3,4])):[2,void 0];case 1:return(k=_)?[3,3]:[4,d(r,b,y,m)];case 2:k=D.sent(),D.label=3;case 3:P=k,D.label=4;case 4:return!P&&I&&(P=r.stops.map((function(e){return e.value})),(C=r.stops.some((function(e){return!!e.label})))&&(L=r.stops.map((function(e){return e.label})))),T&&P&&P.length>2&&(P=[P[0],P[P.length-1]]),P?(M=[t.REAL_WORLD_MIN_SIZE,t.REAL_WORLD_MAX_SIZE],O=s.getSymbolOutlineSize(b),E=C?null:function(e,t){var r=e.length-1;return e.map((function(e,n){return l.createStopLabel(e,n,r,t)}))}(P,g),[4,o.all(P.map((function(e,t){return n.__awaiter(A,void 0,void 0,(function(){var o,a,l,u;return n.__generator(this,(function(n){switch(n.label){case 0:return T?(l=M[t],[3,3]):[3,1];case 1:return[4,h(r,b,e,y,m)];case 2:l=n.sent(),n.label=3;case 3:return a=function(e,t){var r=e.clone();if(i.isSymbol3D(r))s.isVolumetricSymbol(r)||r.symbolLayers.forEach((function(e){"fill"!==e.type&&(e.size=t)}));else if("esri.symbols.SimpleMarkerSymbol"===r.declaredClass)r.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(r)){var n=r.width,o=r.height;r.height=t,r.width=t*(n/o)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(r)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(r)&&r.font&&(r.font.size=t):r.width=t;return r}(b,o=l),u=C?L[t]:E[t],[2,{value:e,symbol:a,label:u,size:o,outlineSize:O}]}}))}))})))]):[2,null];case 5:return[2,D.sent().reverse()]}}))}))}}.apply(null,n))||(e.exports=i)},687:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(258),r(167),r(171),r(151),r(396),r(188),r(504),r(505),r(183)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){var d="esri-legend--card__image-label",f="esri-legend--card__layer-caption",h="esri-legend--card__layer-row",y="esri-legend--card__ramp-label",m="esri-legend--card__section",g="esri-legend--card__service",v="esri-legend--card__symbol-row",_="esri-legend--card__service-caption-container",b="esri-legend--card__size-ramp-container",w="esri-widget__heading",S="esri-legend--card__",x=window.devicePixelRatio;return function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._handles=new i,n._hasIndicators=!1,n._selectedSectionName=null,n._sectionNames=[],n._sectionMap=new Map,n.activeLayerInfos=null,n.layout="stack",n.messages=null,n.messagesCommon=null,n.type="card",n.view=null,n}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this.own([this.watch("activeLayerInfos",(function(t){e._handles.removeAll(),e._watchForSectionChanges(t)}))])},t.prototype.destroy=function(){this._handles.destroy(),this._handles=null},t.prototype.render=function(){var e,t=this;this._hasIndicators="auto"===this.layout&&this.view.container.clientWidth<=768||"stack"===this.layout;var r=this.activeLayerInfos,i=r&&r.toArray().map((function(e){return t._renderLegendForLayer(e)})).filter((function(e){return!!e}));this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;var o=this._sectionNames.length,a=this._sectionNames.map((function(e,r){var i,a=n.substitute(t.messagesCommon.pagination.pageText,{index:r+1,total:o});return c.tsx("div",{key:e,"aria-label":a,title:a,tabIndex:0,onclick:t._selectSection,onkeydown:t._selectSection,bind:t,class:t.classes("esri-legend--card__carousel-indicator",(i={},i["esri-legend--card__carousel-indicator--activated"]=t._selectedSectionName===e,i)),"data-section-name":e})})),s=this._hasIndicators&&o>1?c.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation"},a):null,l=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):i&&i.length?i:null,u=((e={})["esri-legend--stacked"]=this._hasIndicators,e);return c.tsx("div",{class:this.classes("esri-legend--card",u)},s,l||c.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend))},t.prototype._selectSection=function(e){var t=e.target.getAttribute("data-section-name");t&&(this._selectedSectionName=t)},t.prototype._watchForSectionChanges=function(e){var t=this;if(this._generateSectionNames(),e){e.forEach((function(e){var r="activeLayerInfo-"+e.layer.uid+"-version-change";t._handles.remove(r),t._watchForSectionChanges(e.children),t._handles.add(e.watch("version",(function(){return t._generateSectionNames()})),r)}));var r="activeLayerInfos-collection-change";this._handles.remove(r),this._handles.add(e.on("change",(function(){return t._watchForSectionChanges(e)})),r)}},t.prototype._generateSectionNames=function(){this._sectionNames.length=0,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)},t.prototype._generateSectionNamesForActiveLayerInfo=function(e){var t=this;e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((function(r,n){t._sectionNames.push(""+S+e.layer.uid+"-type-"+r.type+"-"+n)}))},t.prototype._renderLegendForLayer=function(e){var t,r=this;if(!e.ready)return null;if(e.children.length){var n=e.children.map((function(e){return r._renderLegendForLayer(e)})).toArray();return c.tsx("div",{key:e.layer.uid,class:this.classes(g,"esri-legend--card__group-layer")},c.tsx("div",{class:_},e.title),n)}var i=e.legendElements;if(i&&!i.length)return null;var o=i.some((function(e){return"relationship-ramp"===e.type})),a=i.map((function(t,n){return r._renderLegendForElement(t,e,n,o)})).filter((function(e){return!!e}));if(!a.length)return null;var s=((t={})["esri-legend--card__group-layer-child"]=!!e.parent,t);return c.tsx("div",{key:e.layer.uid,class:this.classes(g,s)},c.tsx("div",{class:_},c.tsx("div",{class:"esri-legend--card__service-caption-text"},e.title)),c.tsx("div",{class:"esri-legend--card__service-content"},a))},t.prototype._renderLegendForElement=function(e,t,r,n){var i,o=this;void 0===n&&(n=!1);var a="color-ramp"===e.type,s="opacity-ramp"===e.type,l="size-ramp"===e.type,d=t.layer,h=e.title,y=null;if("string"==typeof h)y=h;else if(h){var g=p.getTitle(this.messages,h,a||s);y=h.title?h.title+" ("+g+")":g}var _=""+S+d.uid+"-type-"+e.type+"-"+r,b=this._hasIndicators?c.tsx("div",null,c.tsx("h3",{class:this.classes(w,"esri-legend--card__carousel-title")},t.title),c.tsx("h4",{class:this.classes(w,f)},y)):y?c.tsx("h4",{class:this.classes(w,f)},y):null,x=null;if("symbol-table"===e.type){var I=e.infos.map((function(r,n){return o._renderLegendForElementInfo(r,t,e.legendType,n)})).filter((function(e){return!!e}));if(I.length){var R=I[0].properties.classes&&I[0].properties.classes[v],T=((i={})["esri-legend--card__label-container"]=!R&&!n,i["esri-legend--card__relationship-label-container"]=n,i);x=c.tsx("div",{key:_,class:m},b,c.tsx("div",{class:this.classes(T)},I))}}else"color-ramp"===e.type||"opacity-ramp"===e.type||"heatmap-ramp"===e.type?x=c.tsx("div",{key:_,class:m},b,this._renderLegendForRamp(e,d.opacity)):l?x=c.tsx("div",{key:_,class:m},b,this._renderSizeRamp(e,d.opacity)):"relationship-ramp"===e.type&&(x=c.tsx("div",{key:_,class:this.classes(m,"esri-legend--card__relationship-section")},b,u.renderRelationshipRamp(e,this.id,d.opacity)));return x?(this._sectionMap.set(_,x),x):null},t.prototype._renderLegendForElementInfo=function(e,t,r,n){var i,o,a,s,l,u=t.layer;if(e.type)return this._renderLegendForElement(e,t,n);var f=p.isImageryStretchedLegend(u,r);if(e.symbol&&e.preview){if(-1===e.symbol.type.indexOf("simple-fill")){if(!e.label)return c.tsx("div",{key:n,bind:e.preview,afterCreate:p.attachToNode});var y=((i={})["esri-legend--card__symbol-cell"]=this._hasIndicators,i);return c.tsx("div",{key:n,class:this.classes(h,(o={},o[v]=this._hasIndicators,o))},c.tsx("div",{class:this.classes(y),bind:e.preview,afterCreate:p.attachToNode}),c.tsx("div",{class:this.classes(d,(a={},a["esri-legend--card__label-cell"]=this._hasIndicators,a))},p.getTitle(this.messages,e.label,!1)||""))}var m=255,g=255,_=255,b=0,w=255,S=255,x=255,I=0,R=e.symbol.color&&e.symbol.color.a,T=e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color.a;R&&(m=e.symbol.color.r,g=e.symbol.color.g,_=e.symbol.color.b,b=e.symbol.color.a*u.opacity),T&&(w=e.symbol.outline.color.r,S=e.symbol.outline.color.g,x=e.symbol.outline.color.b,I=e.symbol.outline.color.a*u.opacity);var C=null===(l=null===(s=e.symbol.color)||void 0===s?void 0:s.isBright)||void 0===l||l,P=C?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",L={background:R?"rgba("+m+", "+g+", "+_+", "+b+")":"none",color:C?"black":"white",textShadow:"-1px -1px 0 "+P+",\n                                              1px -1px 0 "+P+",\n                                              -1px 1px 0 "+P+",\n                                              1px 1px 0 "+P,border:T?"1px solid rgba("+w+", "+S+", "+x+", "+I+")":"none"};return c.tsx("div",{key:n,class:h},c.tsx("div",{class:"esri-legend--card__label-element",styles:L}," ",e.label," "))}if(e.src){var k=this._renderImage(e,u,f);return c.tsx("div",{key:n,class:h},k,c.tsx("div",{class:d},e.label||""))}},t.prototype._renderImage=function(e,t,r){var n,i=e.label,o=e.src,a=e.opacity,s=((n={})["esri-legend--card__imagery-layer-image--stretched"]=r,n["esri-legend--card__symbol"]=!r,n),l={opacity:""+(null!=a?a:t.opacity)};return c.tsx("img",{alt:p.getTitle(this.messages,i,!1),src:o,border:0,width:e.width,height:e.height,class:this.classes(s),styles:l})},t.prototype._renderSizeRampLines=function(e){var t=e.infos,r=t[0],n=t[t.length-1],i=r.symbol,a=this._hasIndicators,s=o.pt2px(r.size+r.outlineSize)*x,l=o.pt2px(n.size+n.outlineSize)*x,u=a?s:s+50*x,d=a?s/2+50*x:s,f=function(e){if(e){if(e.type.indexOf("3d")>-1){var t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;var r=e.symbolLayers.getItemAt(t-1).get("resource.primitive");return"triangle"===r||"cone"===r||"tetrahedron"===r}return"triangle"===e.style}}(i),h=function(e){if(e){if(e.type.indexOf("3d")>-1){var t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;var r=e.symbolLayers.getItemAt(t-1),n=r.resource&&r.resource.primitive;return"circle"===n||"cross"===n||"kite"===n||"sphere"===n||"cube"===n||"diamond"===n}var i=e.style;return"circle"===i||"diamond"===i||"cross"===i}}(i),y=document.createElement("canvas");y.width=u,y.height=d,y.style.width=y.width/x+"px",y.style.height=y.height/x+"px";var m=y.getContext("2d");if(a){m.beginPath();var g=u/2-l/2,v=d;m.moveTo(0,0),m.lineTo(g,v);var _=u,b=u/2+l/2,w=d;m.moveTo(_,0),m.lineTo(b,w)}else{m.beginPath();var S=d/2-l/2,I=u;m.moveTo(0,S),m.lineTo(I,0);var R=d/2+l/2,T=u,C=d;m.moveTo(0,R),m.lineTo(T,C)}return m.strokeStyle="#ddd",m.stroke(),c.tsx("div",{bind:y,afterCreate:p.attachToNode,styles:a?{display:"flex",marginTop:"-"+(f?0:h?s/2:0)+"px",marginBottom:"-"+(f?l:h?l/2:0)+"px"}:{display:"flex",marginRight:"-"+(f?0:h?s/2:0)+"px",marginLeft:"-"+(f?0:h?l/2:0)+"px"}})},t.prototype._renderSizeRamp=function(e,t){var r,n=e.infos,i=n[0].label,o=n[n.length-1].label,a=n[0].preview,s=n[n.length-1].preview,l=this._hasIndicators,u={"flex-direction":l?"column":"row-reverse"};a&&((a=a.cloneNode(!0)).style.display="flex"),s&&((s=s.cloneNode(!0)).style.display="flex");var d={opacity:null!=t?""+t:""};return c.tsx("div",{class:this.classes(h,(r={},r["esri-legend--card__size-ramp-row"]=l,r))},c.tsx("div",{class:y},l?i:o),c.tsx("div",{class:b,styles:u},c.tsx("div",{bind:a,afterCreate:p.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:d}),this._renderSizeRampLines(e),c.tsx("div",{bind:s,afterCreate:p.attachToNode,class:b,styles:d})),c.tsx("div",{class:y},l?o:i))},t.prototype._renderLegendForRamp=function(e,t){var r=e.infos,n="heatmap-ramp"===e.type,i=r.length-1,o=i>2&&!n?25*i:100,a=o+20,l=r.slice(0).reverse();l.forEach((function(e,t){e.offset=n?e.ratio:t/i}));var u=l.length-1,p=l.length%2!=0&&l[l.length/2|0],d=p&&c.tsx("div",{class:"esri-legend--card__interval-separators-container"},c.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),c.tsx("div",{class:y},p.label)),f=r[r.length-1].label,m=r[0].label,g=null;null!=t&&(g="opacity: "+t);var v=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:l[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:o,height:25},fill:{type:"linear",x1:10,y1:0,x2:o+10,y2:0,colors:l},stroke:{width:0}},{shape:{type:"path",path:"M"+(o+10)+" 0 L"+a+" 12.5 L"+(o+10)+" 25 Z"},fill:l[u].color,stroke:{width:0}}]],_=s.renderSVG(v,a,25),b=this.messages;return c.tsx("div",{class:h},c.tsx("div",{class:y},n?b[f]:f),c.tsx("div",{class:"esri-legend--card__symbol-container"},c.tsx("div",{style:g},_),d),c.tsx("div",{class:y},n?b[m]:m))},r.__decorate([c.renderable(),a.property()],t.prototype,"activeLayerInfos",void 0),r.__decorate([a.property()],t.prototype,"layout",void 0),r.__decorate([a.property(),c.renderable(),c.messageBundle("esri/widgets/Legend/t9n/Legend")],t.prototype,"messages",void 0),r.__decorate([a.property(),c.renderable(),c.messageBundle("esri/t9n/common")],t.prototype,"messagesCommon",void 0),r.__decorate([a.property({readOnly:!0})],t.prototype,"type",void 0),r.__decorate([a.property()],t.prototype,"view",void 0),r.__decorate([c.accessibleHandler()],t.prototype,"_selectSection",null),r.__decorate([a.subclass("esri.widgets.Legend.styles.Card")],t)}(l)}.apply(null,n))||(e.exports=i)},688:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(258),r(151),r(188),r(504),r(505),r(183)],void 0===(i=function(e,t,r,n,i,o,a,s,l){var u="esri-legend__service",p="esri-legend__layer-row",c="esri-legend__layer-cell esri-legend__layer-cell--info",d="esri-legend__imagery-layer-info--stretched",f="esri-legend__layer-cell esri-legend__layer-cell--symbols",h="esri-legend__symbol";return function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.activeLayerInfos=null,n.messages=null,n.type="classic",n}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.activeLayerInfos,r=t&&t.toArray().map((function(t){return e._renderLegendForLayer(t)})).filter((function(e){return!!e}));return l.tsx("div",null,r&&r.length?r:l.tsx("div",{class:"esri-legend__message"},this.messages.noLegend))},t.prototype._renderLegendForLayer=function(e){var t,r=this;if(!e.ready)return null;var n=!!e.children.length,i="esri-legend__"+e.layer.uid+"-version-"+e.version,o=e.title?l.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},e.title):null;if(n){var a=e.children.map((function(e){return r._renderLegendForLayer(e)})).toArray();return l.tsx("div",{key:i,class:this.classes(u,"esri-legend__group-layer")},o,a)}var s=e.legendElements;if(s&&!s.length)return null;var p=s.map((function(t){return r._renderLegendForElement(t,e.layer)})).filter((function(e){return!!e}));if(!p.length)return null;var c=((t={})["esri-legend__group-layer-child"]=!!e.parent,t);return l.tsx("div",{key:i,class:this.classes(u,c)},o,l.tsx("div",{class:"esri-legend__layer"},p))},t.prototype._renderLegendForElement=function(e,t,r){var n,i=this,o="color-ramp"===e.type,u="opacity-ramp"===e.type,p="size-ramp"===e.type,c=null;if("symbol-table"===e.type||p){var d=e.infos.map((function(r){return i._renderLegendForElementInfo(r,t,p,e.legendType)})).filter((function(e){return!!e}));d.length&&(c=l.tsx("div",{class:"esri-legend__layer-body"},d))}else"color-ramp"===e.type||"opacity-ramp"===e.type||"heatmap-ramp"===e.type||"stretch-ramp"===e.type?c=this._renderLegendForRamp(e,t.opacity):"relationship-ramp"===e.type&&(c=a.renderRelationshipRamp(e,this.id,t.opacity));if(!c)return null;var f=e.title,h=null;if("string"==typeof f)h=f;else if(f){var y=s.getTitle(this.messages,f,o||u);h=s.isRendererTitle(f,o||u)&&f.title?f.title+" ("+y+")":y}var m=r?"esri-legend__layer-child-table":"esri-legend__layer-table",g=h?l.tsx("div",{class:"esri-legend__layer-caption"},h):null,v=((n={})["esri-legend__layer-table--size-ramp"]=p||!r,n);return l.tsx("div",{class:this.classes(m,v)},g,c)},t.prototype._renderLegendForRamp=function(e,t){var r=this,n=e.infos,i="opacity-ramp"===e.type,o="heatmap-ramp"===e.type,a="stretch-ramp"===e.type,u=e.preview,d=i?"esri-legend__opacity-ramp":"";u.className="esri-legend__color-ramp "+d,null!=t&&(u.style.opacity=t.toString());var h=n.map((function(e){return l.tsx("div",{class:e.label?"esri-legend__ramp-label":null},o?r.messages[e.label]:a?r._getStretchStopLabel(e):e.label)})),y={height:u.style.height};return l.tsx("div",{class:p},l.tsx("div",{class:f,styles:{width:"24px"}},l.tsx("div",{class:"esri-legend__ramps",bind:u,afterCreate:s.attachToNode})),l.tsx("div",{class:c},l.tsx("div",{class:"esri-legend__ramp-labels",styles:y},h)))},t.prototype._getStretchStopLabel=function(e){return e.label?this.messages[e.label]+": "+n.formatNumber(e.value,{style:"decimal"}):""},t.prototype._renderLegendForElementInfo=function(e,t,r,n){var i,o;if(e.type)return this._renderLegendForElement(e,t,!0);var a=null,u=s.isImageryStretchedLegend(t,n);if(e.symbol&&e.preview?a=l.tsx("div",{class:h,bind:e.preview,afterCreate:s.attachToNode}):e.src&&(a=this._renderImage(e,t,u)),!a)return null;var y=((i={})[d]=u,i),m=((o={})[d]=u,o["esri-legend__size-ramp"]=!u&&r,o);return l.tsx("div",{class:p},l.tsx("div",{class:this.classes(f,m)},a),l.tsx("div",{class:this.classes(c,y)},s.getTitle(this.messages,e.label,!1)||""))},t.prototype._renderImage=function(e,t,r){var n,i=e.label,o=e.src,a=e.opacity,u=((n={})["esri-legend__imagery-layer-image--stretched"]=r,n[h]=!r,n),p={opacity:""+(null!=a?a:t.opacity)};return l.tsx("img",{alt:s.getTitle(this.messages,i,!1),src:o,border:0,width:e.width,height:e.height,class:this.classes(u),styles:p})},r.__decorate([l.renderable(),i.property()],t.prototype,"activeLayerInfos",void 0),r.__decorate([i.property(),l.renderable(),l.messageBundle("esri/widgets/Legend/t9n/Legend")],t.prototype,"messages",void 0),r.__decorate([i.property({readOnly:!0})],t.prototype,"type",void 0),r.__decorate([i.subclass("esri.widgets.Legend.styles.Classic")],t)}(o)}.apply(null,n))||(e.exports=i)},689:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(159),r(174),r(399),r(165),r(154),r(166),r(118),r(156),r(152),r(153),r(172),r(151),r(179),r(233),r(421),r(690),r(194),r(255),r(422),r(400),r(267),r(313),r(423),r(550),r(603),r(604),r(693),r(463),r(187),r(696),r(199)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b,w,S,x,I,R,T,C,P,L,k,M,O,E){Object.defineProperty(t,"__esModule",{value:!0});var A=p.getLogger("esri.layers.mixins.ArcGISImageService"),D=l.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),N=l.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),F=l.strict()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});t.ArcGISImageService=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._functionRasterInfos={},t._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},t._symbolizer=null,t._defaultServiceMosaicRule=null,t.rasterAttributeTableFieldPrefix="Raster.",t.adjustAspectRatio=null,t.bandCount=null,t.bandIds=void 0,t.capabilities=null,t.compressionQuality=void 0,t.compressionTolerance=.01,t.copyright=null,t.definitionExpression=null,t.exportImageServiceParameters=null,t.rasterInfo=null,t.fields=null,t.fullExtent=null,t.hasMultidimensions=!1,t.imageMaxHeight=4100,t.imageMaxWidth=4100,t.interpolation=void 0,t.multidimensionalInfo=null,t.noData=null,t.noDataInterpretation=void 0,t.objectIdField=null,t.pixelSizeX=null,t.pixelSizeY=null,t.pixelFilter=null,t.raster=void 0,t.viewId=void 0,t.renderer=null,t.rasterAttributeTable=null,t.rasterFunctionInfos=null,t.serviceDataType=null,t.spatialReference=null,t.pixelType=null,t.serviceRasterInfo=null,t.sourceJSON=null,t.url=null,t.version=null,t}return r.__extends(t,e),t.prototype.initialize=function(){this._set("exportImageServiceParameters",new v.ExportImageServiceParameters({layer:this}))},t.prototype.readDefaultServiceMosaicRule=function(e,t){return S.fromJSON(t)},Object.defineProperty(t.prototype,"rasterFunctionNamesIndex",{get:function(){var e=new Map;return!this.rasterFunctionInfos||this.rasterFunctionInfos.length<1||this.rasterFunctionInfos.forEach((function(t){e.set(t.name.toLowerCase().replace(/ /gi,"_"),t.name)})),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryTask",{get:function(){return new k({url:this.url})},enumerable:!0,configurable:!0}),t.prototype.readBandIds=function(e,t){if(Array.isArray(e)&&e.length>0&&e.every((function(e){return"number"==typeof e})))return e},t.prototype.readCapabilities=function(e,t){return this._readCapabilities(t)},t.prototype.writeCompressionQuality=function(e,t,r){null!=e&&"lerc"!==this.format&&(t[r]=e)},t.prototype.writeCompressionTolerance=function(e,t,r){"lerc"===this.format&&null!=e&&(t[r]=e)},Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return this.fields?new b(this.fields):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._get("format")||(null!=this.pixelFilter?"lerc":"jpgpng")},set:function(e){e&&["png","png8","png24","png32","jpg","bmp","jpgpng","lerc","tiff"].indexOf(e.toLowerCase())>-1&&this._set("format",e.toLowerCase())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mosaicRule",{set:function(e){var t=e;t&&t.mosaicMethod&&(t=S.fromJSON(r.__assign(r.__assign({},t.toJSON()),{mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation}))),this._set("mosaicRule",t)},enumerable:!0,configurable:!0}),t.prototype.readMosaicRule=function(e,t){return S.fromJSON(e||t.mosaicRule||t)},t.prototype.writeMosaicRule=function(e,t,r){var n=this.mosaicRule,i=this.definitionExpression;n?i&&i!==n.where&&((n=n.clone()).where=i):i&&(n=new S({where:i})),this._isValidCustomizedMosaicRule(n)&&(t[r]=n.toJSON())},t.prototype.writeNoData=function(e,t,r){null!=e&&"number"==typeof e&&(t[r]=e)},t.prototype.readObjectIdField=function(e,t){if(!e){var r=t.fields.filter((function(e){return"esriFieldTypeOID"===e.type||"oid"===e.type}));e=r&&r[0]&&r[0].name}return e},Object.defineProperty(t.prototype,"parsedUrl",{get:function(){return this.url?f.urlToObject(this.url):null},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){var n=t&&t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.renderer,i=o.read(n,r)||void 0;if(null!=i)return w.isSupportedRendererType(i)||A.warn("ArcGISImageService","Imagery layer doesn't support given renderer type."),i},Object.defineProperty(t.prototype,"rasterFields",{get:function(){var e=this.rasterAttributeTableFieldPrefix||"Raster.",t=new _({name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"}),r=new _({name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"}),n=new _({name:"Raster.ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"string"}),i=this.fields?u.clone(this.fields):[];i.push(r),this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0&&i.push(t),this.version>=10.4&&this.rasterFunctionInfos&&this.rasterFunctionInfos.some((function(e){return"none"===e.name.toLowerCase()}))&&i.push(n),this.rasterFunctionInfos&&this.rasterFunctionInfos.filter((function(e){return"none"!==e.name.toLowerCase()})).forEach((function(e){i.push(new _({name:"Raster.ServicePixelValue."+e.name,alias:e.name,domain:null,editable:!1,length:50,type:"string"}))})),null==this.pixelFilter||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType||(i.push(new _({name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"})),i.push(new _({name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"})));var o=this.rasterInfo.attributeTable&&this.rasterInfo.attributeTable.fields||null;if(o&&o.length>0){var a=o.filter((function(e){return"esriFieldTypeOID"!==e.type&&"value"!==e.name.toLowerCase()})).map((function(t){var r=u.clone(t);return r.name=e+t.name,r}));i=i.concat(a)}return i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingRule",{set:function(e){var t=e;t&&t.rasterFunction&&(t=I.fromJSON(r.__assign(r.__assign({},t.toJSON()),{rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments}))),this._set("renderingRule",t)},enumerable:!0,configurable:!0}),t.prototype.readRenderingRule=function(e,t){var r=t.rasterFunctionInfos;return t.renderingRule||r&&r.length&&"None"!==r[0].name?I.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null},t.prototype.writeRenderingRule=function(e,t,r){this._isRFTJson(e)||(t[r]=e.toJSON())},t.prototype.readSpatialReference=function(e,t){var r=e||t.extent.spatialReference;return r?n.SpatialReference.fromJSON(r):null},t.prototype.readPixelType=function(e){return F.fromJSON(e)||e},t.prototype.writePixelType=function(e,t,r){(c.isNone(this.serviceRasterInfo)||this.pixelType!==this.serviceRasterInfo.pixelType)&&(t[r]=F.toJSON(e))},t.prototype.readVersion=function(e,t){var r=t.currentVersion;return r||(r=t.hasOwnProperty("fields")||t.hasOwnProperty("timeInfo")?10:9.3),r},t.prototype.applyFilter=function(e){var t=e;return this.pixelFilter&&(t=this._clonePixelData(e),this.pixelFilter(t)),t},t.prototype.applyRenderer=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s;return r.__generator(this,(function(l){switch(l.label){case 0:return n=e,this._isPicture()||!this.renderer||!this._symbolizer||this.pixelFilter?[3,5]:(i=JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer.toJSON()),o=this._rasterJobHandler.instance,a=this.bandIds,o?i?(this._symbolizer.bind(),[4,o.updateSymbolizer(this._symbolizer,t)]):[3,2]:[3,4]);case 1:l.sent(),this._cachedRendererJson=this.renderer.toJSON(),l.label=2;case 2:return[4,o.symbolize(r.__assign({bandIds:a},e),t)];case 3:return s=l.sent(),n={extent:e.extent,pixelBlock:s},[3,5];case 4:n={extent:e.extent,pixelBlock:this._symbolizer.symbolize(r.__assign({bandIds:a},e))},l.label=5;case 5:return[2,n]}}))}))},t.prototype.destroy=function(){this._shutdownJobHandler()},t.prototype.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++},t.prototype.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()},t.prototype.fetchImage=function(e,t,r,n){var i=this;if(void 0===n&&(n={}),null==e||null==t||null==r)return d.reject(new s("imagery-layer:fetch-image","Insufficient parameters for requesting an image. A valid extent, width and height values are required."));var o=this.renderer||this._symbolizer?this.generateRasterInfo(this.renderingRule,{signal:n.signal}):null;return d.when(o).then((function(o){o&&(i.rasterInfo=o);var a={imageServiceParameters:i.getExportImageServiceParameters(e,t,r,n.timeExtent),imageProps:{extent:e,width:t,height:r,format:i.format},requestAsImageElement:n.requestAsImageElement&&!i.pixelFilter||!1,signal:n.signal};return i._requestArrayBuffer(a)}))},t.prototype.fetchKeyProperties=function(e){var t=e&&e.renderingRule&&e.renderingRule.toJSON();return a(this.parsedUrl.path+"/keyProperties",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then((function(e){return e.data}))},t.prototype.fetchRasterAttributeTable=function(e){var t=e&&e.renderingRule&&e.renderingRule.toJSON();return this.version<10.1?d.reject(new s("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable")):a(this.parsedUrl.path+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then((function(e){return M.fromJSON(e.data)}))},t.prototype.getCatalogItemRasterInfo=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,l,u;return r.__generator(this,(function(p){switch(p.label){case 0:return i=a(this.parsedUrl.path+"/"+e+"/info",r.__assign({query:this._getQueryParams()},t)).then((function(e){return e.data})),o=a(this.parsedUrl.path+"/"+e+"/info/keyProperties",r.__assign({query:this._getQueryParams()},t)).then((function(e){return e.data})).catch((function(){})),[4,d.all([i,o])];case 1:return(s=p.sent())[0]?(l=n.Extent.fromJSON(s[0].extent),u=s[0].statistics?s[0].statistics.map((function(e){return{min:e[0],max:e[1],avg:e[2],stddev:e[3]}})):null,[2,new R({bandCount:s[0].bandCount,extent:l,spatialReference:l.sr,pixelSize:new n.Point({x:s[0].pixelSizeX,y:s[0].pixelSizeY,spatialReference:l.sr}),pixelType:s[0].pixelType.toLowerCase(),statistics:u,histograms:s[0].histograms,keyProperties:s[1]})]):[2,void 0]}}))}))},t.prototype.getCatalogItemICSInfo=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,l,u,p,c,f,h,y,m,g,v,_,b,w,S,x,I,R,T,C,P,L,k,M,O,E,A,D;return r.__generator(this,(function(N){switch(N.label){case 0:return[4,a(this.parsedUrl.path+"/"+e+"/info/ics",r.__assign({query:this._getQueryParams()},t))];case 1:if(i=N.sent().data,!(o=i&&i.ics))return[2,void 0];s=null,N.label=2;case 2:return N.trys.push([2,4,,5]),[4,a(this.parsedUrl.path+"/"+e+"/info",r.__assign({query:this._getQueryParams()},t))];case 3:return l=N.sent(),s=l.data.extent,[3,5];case 4:return N.sent(),[3,5];case 5:if(!s||!s.spatialReference)return[2,{ics:o,icsToPixelTransform:null,icsExtent:null,northDirection:null}];for(u=this.version>=10.7?a(this.parsedUrl.path+"/"+e+"/info/icstopixel",r.__assign({query:this._getQueryParams()},t)).then((function(e){return e.data})).catch((function(){return{}})):{},p=s.spatialReference,c={geometries:JSON.stringify({geometryType:"esriGeometryEnvelope",geometries:[s]}),inSR:p.wkid||p,outSR:"0:"+e},f=a(this.parsedUrl.path+"/project",r.__assign({query:this._getQueryParams(c)},t)).then((function(e){return e.data})).catch((function(){return{}})),h=5,y=(s.xmin+s.xmax)/2,m=(s.ymax-s.ymin)/(h+1),g=s.ymin+m,v=[],M=0;M<h;M++)v.push({x:y,y:g+m*M});return _={geometries:JSON.stringify({geometryType:"esriGeometryPoint",geometries:v}),inSR:p.wkid||p,outSR:"0:"+e},b=a(this.parsedUrl.path+"/project",r.__assign({query:this._getQueryParams(_)},t)).then((function(e){return e.data})).catch((function(){return{}})),[4,d.all([u,f,b])];case 6:if(w=N.sent(),null==(S=w[0].ipxf)&&(x=o.geodataXform&&o.geodataXform.xf_0)&&"topup"===x.name.toLowerCase()&&(S={affine:{name:"ics [sensor: Frame] to pixel (column, row) transformation",coefficients:x.coefficients,cellsizeRatio:0,type:"GeometricXform"}}),(I=n.Extent.fromJSON(w[1]&&w[1].geometries&&w[1].geometries[0]))&&(I.spatialReference=new n.SpatialReference({wkid:0,imageCoordinateSystem:o})),R=w[2].geometries?w[2].geometries.filter((function(e){return null!=e})):[],(T=R.length)<3)return[2,{ics:o,icsToPixelTransform:S,icsExtent:I,northDirection:null}];for(C=0,P=0,L=0,k=0,M=0;M<T;M++)C+=R[M].x,P+=R[M].y,L+=R[M].x*R[M].x,k+=R[M].x*R[M].y;return O=(T*k-C*P)/(T*L-C*C),E=0,A=R[h-1].x>R[0].x,D=R[h-1].y>R[0].y,O===1/0?E=D?90:270:0===O?E=A?0:180:O>0?E=A?180*Math.atan(O)/Math.PI:180*Math.atan(O)/Math.PI+180:O<0&&(E=D?180+180*Math.atan(O)/Math.PI:360+180*Math.atan(O)/Math.PI),[2,{ics:o,icsToPixelTransform:S,icsExtent:I,northDirection:E}]}}))}))},t.prototype.generateRasterInfo=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:if((!e||"none"===e.functionName.toLowerCase())&&c.isSome(this.serviceRasterInfo))return[2,this.serviceRasterInfo];if(n=function(e){if(!e)return null;var t=JSON.stringify(e).match(/"rasterFunction":"(.*?")/gi),r=null==t?void 0:t.map((function(e){return e.replace('"rasterFunction":"',"").replace('"',"")}));return r?r.join("/"):null}(e),this._functionRasterInfos[n])return[2,this._functionRasterInfos[n]];i=this._generateRasterInfo(e,t),this._functionRasterInfos[n]=i,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i];case 2:return[2,r.sent()];case 3:return r.sent(),this._functionRasterInfos[n]=null,[2,null];case 4:return[2]}}))}))},t.prototype.getExportImageServiceParameters=function(e,t,n,i){var o,a=(e=e.clone().shiftCentralMeridian()).spatialReference;if(a.imageCoordinateSystem){var s=a.imageCoordinateSystem,l=s.id,u=s.referenceServiceName;o=null!=l?u?this.parsedUrl.path.toLowerCase().indexOf("/"+u.toLowerCase()+"/")>-1?"0:"+l:JSON.stringify({icsid:l,icsns:u}):"0:"+l:JSON.stringify({ics:a.imageCoordinateSystem})}else o=a.wkid||JSON.stringify(a.toJSON());c.isSome(this.serviceRasterInfo)&&this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);var p=this.exportImageServiceParameters.toJSON(),d=p.bandIds,f=p.noData,h=p.mosaicRule,y=p.renderingRule;d instanceof Array&&d.length>0&&(p.bandIds=d.join(",")),f instanceof Array&&f.length>0&&(p.noData=f.join(","));var m=this.timeInfo;h&&h.multidimensionalDefinition&&i&&m&&m.startField&&(h.multidimensionalDefinition=h.multidimensionalDefinition.filter((function(e){return e.dimensionName!==m.startField}))),p.mosaicRule=h&&JSON.stringify(h),p.renderingRule=y&&JSON.stringify(y);var g={};if(i){var v=i.toJSON(),_=v.start,b=v.end;_&&b&&_===b?g.time=""+_:null==_&&null==b||(g.time=(null==_?"null":_)+","+(null==b?"null":b))}return r.__assign(r.__assign({bbox:e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:o,imageSR:o,size:t+","+n},p),g)},t.prototype.queryRasters=function(e){return this.queryTask.execute(e)},t.prototype.queryVisibleRasters=function(e,t){var r=this;if(!e)return d.reject(new s("imagery-layer: query-visible-rasters","missing query parameter"));var i=t||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1},o=i.pixelSize,a=i.returnDomainValues,l=i.returnTopmostRaster,u=i.showNoDataRecords,p=!1,c=null,f=null,h=this.rasterFunctionNamesIndex;if(e.outFields&&(p=e.outFields.some((function(e){return-1===e.toLowerCase().indexOf("raster.servicepixelvalue")})),this.version>=10.4)){var y=e.outFields.filter((function(e){return e.toLowerCase().indexOf("raster.servicepixelvalue")>-1&&e.length>"raster.servicepixelvalue".length})).map((function(e){var t=e.slice("raster.servicepixelvalue".length+1);return[r._updateRenderingRulesFunctionName(t,h),t]}));c=y.map((function(e){return new I({functionName:e[0]})})),f=y.map((function(e){return e[1]})),0===c.length?this.renderingRule?(c.push(this.renderingRule),f.push(this.renderingRule.functionName)):c=null:this.renderingRule&&!c.some((function(e){return e.functionName===r.renderingRule.functionName}))&&(c.push(this.renderingRule),f.push(this.renderingRule.functionName))}var m=!e.outSpatialReference||e.outSpatialReference.equals(this.spatialReference),g=this._getQueryParams({geometry:e.geometry,timeExtent:e.timeExtent,mosaicRule:this.exportImageServiceParameters.mosaicRule,renderingRule:this.version<10.4?this.renderingRule:null,renderingRules:c,pixelSize:o,returnCatalogItems:p,returnGeometry:m,maxItemCount:l?1:null});delete g.f;var v=new O(g),_=new L({url:this.url}),b=this.generateRasterInfo(this.renderingRule);return d.create((function(t){b.then((function(){_.execute(v).then((function(i){var o=e.outFields;if(p&&!m&&i.catalogItems&&i.catalogItems.features&&i.catalogItems.features.length>0){var l=r.objectIdField||"ObjectId",c=i.catalogItems.features,d=c.map((function(e){return e.attributes&&e.attributes[l]})),h=new E({objectIds:d,returnGeometry:!0,outSpatialReference:e.outSpatialReference,outFields:[l]});return r.queryRasters(h).then((function(s){s&&s.features&&s.features.length>0&&s.features.forEach((function(t){c.forEach((function(r){r.attributes[l]===t.attributes[l]&&(r.geometry=new n.Polygon(t.geometry),r.geometry.spatialReference=e.outSpatialReference)}))})),t(r._processVisibleRastersResponse(i,{returnDomainValues:a,templateRRFunctionNames:f,showNoDataRecords:u,templateFields:o}))})).catch((function(){throw new s("imagery-layer:query-visible-rasters","encountered error when querying visible rasters geometry")}))}t(r._processVisibleRastersResponse(i,{returnDomainValues:a,templateRRFunctionNames:f,showNoDataRecords:u,templateFields:o}))})).catch((function(){throw new s("imagery-layer:query-visible-rasters","encountered error when querying visible rasters")}))}))}))},t.prototype._fetchService=function(e){var t;return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,l,u,p,f=this;return r.__generator(this,(function(r){switch(r.label){case 0:return(n=this.sourceJSON)?[3,2]:[4,a(this.parsedUrl.path,{query:this._getQueryParams(),signal:e})];case 1:i=r.sent(),o=i.data,l=i.ssl,n=o,this.sourceJSON=n,l&&(this.url=this.url.replace(/^http:/i,"https:")),r.label=2;case 2:if((null===(t=n.capabilities)||void 0===t?void 0:t.toLowerCase().split(",").map((function(e){return e.trim()})).indexOf("tilesonly"))>-1)throw new s("imagery-layer:fetch-metadata","use ImageryTileLayer to open tiles-only image services");return this.read(n,{origin:"service",url:this.parsedUrl}),c.isSome(this.serviceRasterInfo)&&!this.rasterInfo&&(this.rasterInfo=this.serviceRasterInfo),u=c.isSome(this.serviceRasterInfo)?d.resolve(this.serviceRasterInfo):this._fetchAuxiliaryRasterInfo({serviceInfo:n,signal:e}).then((function(e){return f._set("serviceRasterInfo",e),e})),p=this.renderingRule&&"none"!==this.renderingRule.functionName.toLowerCase()?this.generateRasterInfo(this.renderingRule,{signal:e}):null,[2,d.all([u,p]).then((function(e){e[1]?f._set("rasterInfo",e[1]):f._set("rasterInfo",e[0]),f._configDefaultRenderer(),f.watch("renderer",(function(){return f._configDefaultRenderer()})),f.watch("renderingRule",(function(e){(f.renderer||f._symbolizer||f.popupEnabled&&f.popupTemplate)&&f.generateRasterInfo(e).then((function(e){e&&(f.rasterInfo=e)}))}));var t=c.isSome(f.serviceRasterInfo)&&f.serviceRasterInfo.multidimensionalInfo;t&&f._updateMultidimensionalDefinition(t)}))]}}))}))},t.prototype._initJobHandler=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t=this;return r.__generator(this,(function(r){switch(r.label){case 0:return null!=this._rasterJobHandler.connectionPromise?[2,this._rasterJobHandler.connectionPromise]:(e=new T,this._rasterJobHandler.connectionPromise=e.initialize().then((function(){t._rasterJobHandler.instance=e}),(function(){return null})),[4,this._rasterJobHandler.connectionPromise]);case 1:return r.sent(),[2]}}))}))},t.prototype._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0},t.prototype._isPicture=function(){return!this.format||this.format.indexOf("jpg")>-1||this.format.indexOf("png")>-1},t.prototype._configDefaultRenderer=function(){if(!this._isPicture()&&!this.pixelFilter){if(!this.bandIds&&this.rasterInfo.bandCount>=3){var e=w.getDefaultBandCombination(this.rasterInfo);!e||3===this.rasterInfo.bandCount&&0===e[0]&&1===e[1]&&2===e[2]||(this.bandIds=e)}this.renderer||(this.renderer=w.createDefaultRenderer(this.rasterInfo,this.bandIds)),this._symbolizer?(this._symbolizer.renderer=this.renderer,this._symbolizer.rasterInfo=this.rasterInfo):this._symbolizer=new P({renderer:this.renderer,rasterInfo:this.rasterInfo}),this._symbolizer.bind()||(this._symbolizer=null)}},t.prototype._clonePixelData=function(e){return null==e?e:{extent:e.extent&&e.extent.clone(),pixelBlock:e.pixelBlock&&e.pixelBlock.clone()}},t.prototype._getQueryParams=function(e){var t=this.raster,n=this.viewId;return r.__assign({raster:t,viewId:n,f:"json"},e)},t.prototype._decodePixelBlock=function(e,t,r){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:e,options:t}):C.decode(e,t,r)},t.prototype._fetchAuxiliaryRasterInfo=function(e){var t=e&&e.serviceInfo;if(!t)return d.reject(new s("imagery-layer:fetch-metadata","valid serviceInfo is required"));var r=e.renderingRule?JSON.stringify(e.renderingRule.toJSON()):null,i=e.signal,o=!!(t.hasRasterAttributeTable&&this.version>=10.1)&&a(this.parsedUrl.path+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then((function(e){return M.fromJSON(e.data)})).catch((function(){return null})),l=!!(t.hasColormap&&this.version>=10.1)&&a(this.parsedUrl.path+"/colormap",{query:this._getQueryParams({renderingRule:this.version>=10.6?r:null}),signal:i}).then((function(e){return e.data&&e.data.colormap})),u=!!(t.hasHistograms&&this.version>=10.1)&&a(this.parsedUrl.path+"/histograms",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then((function(e){return e.data&&e.data.histograms})),p=this.version>=10.3&&a(this.parsedUrl.path+"/keyProperties",{query:this._getQueryParams({renderingRule:r}),signal:i}).then((function(e){return e.data})).catch((function(){})),c=!!(t.hasMultidimensions&&this.version>=10.3)&&a(this.parsedUrl.path+"/multidimensionalInfo",{query:this._getQueryParams(),signal:i}).then((function(e){return e.data&&e.data.multidimensionalInfo}));return d.all([o,l,u,p,c]).then((function(e){var r=null;if(t.minValues&&t.minValues.length===t.bandCount){r=[];for(var i=0;i<t.minValues.length;i++)r.push({min:t.minValues[i],max:t.maxValues[i],avg:t.meanValues[i],stddev:t.stdvValues[i]})}var o=Math.ceil((t.extent.xmax-t.extent.xmin)/t.pixelSizeX-.1),a=Math.ceil((t.extent.ymax-t.extent.ymin)/t.pixelSizeY-.1),s=n.SpatialReference.fromJSON(t.spatialReference||t.extent.spatialReference);return new R({width:o,height:a,bandCount:t.bandCount,extent:n.Extent.fromJSON(t.extent),spatialReference:s,pixelSize:new n.Point({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:s}),pixelType:t.pixelType.toLowerCase(),statistics:r,attributeTable:e[0]||null,colormap:e[1]||null,histograms:e[2]||null,keyProperties:e[3]||null,multidimensionalInfo:e[4]||null})}))},t.prototype._requestArrayBuffer=function(e){var t=this,n=e.imageProps,i=e.requestAsImageElement,o=e.signal;if(i&&!this.pixelFilter&&n.format&&n.format.indexOf("png")>-1)return a(this.parsedUrl.path+"/exportImage",{responseType:"image",query:this._getQueryParams(r.__assign({f:"image"},e.imageServiceParameters)),signal:o}).then((function(e){return{imageElement:e.data,params:n}}));var l=this._initJobHandler(),u=a(this.parsedUrl.path+"/exportImage",{responseType:"array-buffer",query:this._getQueryParams(r.__assign({f:"image"},e.imageServiceParameters)),signal:o});return d.all([u,l]).then((function(e){var i=e[0].data,a=n.format||"jpgpng",l=a;if("bsq"!==l&&"bip"!==l&&(l=C.getFormat(i)),!l)throw new s("imagery-layer:fetch-image","unsupported format signature "+String.fromCharCode.apply(null,new Uint8Array(i)));var u=a.indexOf("png")>-1&&("png"===l||"jpg"===l),p={signal:o};return u?C.decode(i,r.__assign({useCanvas:!0},n),p).then((function(e){return{pixelData:{pixelBlock:e,extent:n.extent},params:n}})):t._decodePixelBlock(i,{width:n.width,height:n.height,planes:null,pixelType:null,noDataValue:null,format:a},p).then((function(e){return{pixelData:{pixelBlock:e,extent:n.extent},params:n}}))}))},t.prototype._generateRasterInfo=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,a(this.parsedUrl.path,r.__assign({query:this._getQueryParams({renderingRule:e})},t))];case 1:return n=i.sent().data,[4,this._fetchAuxiliaryRasterInfo(r.__assign({serviceInfo:n,renderingRule:e},t))];case 2:return[2,i.sent()]}}))}))},t.prototype._isValidCustomizedMosaicRule=function(e){return e&&JSON.stringify(e.toJSON())!==JSON.stringify(this._defaultServiceMosaicRule&&this._defaultServiceMosaicRule.toJSON())},t.prototype._updateMultidimensionalDefinition=function(e){if(!this._isValidCustomizedMosaicRule(this.mosaicRule)){var t=e.variables[0].dimensions,r=[];for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],o=i.extent,a=!0,s=[o[0]];i.hasRanges&&!0===i.hasRanges?(a=!1,s=[i.values[0]]):"stdz"===i.name.toLowerCase()&&Math.abs(o[1])<=Math.abs(o[0])&&(s=[o[1]]),r.push(new g({variableName:"",dimensionName:t[n].name,isSlice:a,values:s}))}if(r.length>0){this.mosaicRule=this.mosaicRule||new S;var l=this.mosaicRule.multidimensionalDefinition;(!l||l&&l.length<=0)&&(this.mosaicRule.multidimensionalDefinition=r)}}},t.prototype._formatAttributeValue=function(e,t){if("string"==typeof e){var r=this.popupTemplate&&this.popupTemplate.fieldInfos,n=this._getFieldInfo(r,t),i=n&&n.format;if(i){var o=void 0,a=void 0;return e.trim().indexOf(",")>-1?(a=(o=",")+" ",this._formatDelimitedString(e,o,a,i)):e.trim().indexOf(" ")>-1?(o=a=" ",this._formatDelimitedString(e,o,a,i)):this._formatNumberFromString(e,i)}}return e},t.prototype._getFieldInfo=function(e,t){if(e&&e.length&&t){var r=t.toLowerCase(),n=void 0;return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,"_")||(n=e,0))})),n}},t.prototype._formatDelimitedString=function(e,t,r,n){var i=this;return e&&t&&r&&n?e.trim().split(t).map((function(e){return i._formatNumberFromString(e,n)})).join(r):e},t.prototype._formatNumberFromString=function(e,t){if(!e||!t)return e;var r=Number(e);return isNaN(r)?e:t.format(r)},t.prototype._processVisibleRastersResponse=function(e,t){t=t||{};var r,n,o,a=e.value,s=t.templateRRFunctionNames,l=t.showNoDataRecords,u=t.returnDomainValues,p=t.templateFields,d=e.processedValues,f=e.catalogItems&&e.catalogItems.features,h=e.properties&&e.properties.Values&&e.properties.Values.map((function(e){return e.replace(/ /gi,", ")}))||[],y=this.objectIdField||"ObjectId",m="string"==typeof a&&a.toLowerCase().indexOf("nodata")>-1,g=[];if(a&&!f&&!m){var v={};v[y]=0,h=[a],f=[new i(this.fullExtent,null,v)]}if(!f)return[];this._updateResponseFieldNames(f,p);for(var _=0;_<f.length;_++){if(r=f[_],null!=a&&!m){if(n=h[_],o=this.renderingRule&&d&&d.length>0&&s&&s.length>0&&s.indexOf(this.renderingRule.functionName)>-1?d[s.indexOf(this.renderingRule.functionName)]:a,"nodata"===n.toLowerCase()&&!l)continue;r.attributes["Raster.ItemPixelValue"]=this._formatAttributeValue(n,"Raster.ItemPixelValue"),r.attributes["Raster.ServicePixelValue"]=this._formatAttributeValue(o,"Raster.ServicePixelValue"),this._updateFeatureWithMagDirValues(r,n);var b=this.fields&&this.fields.length>0,w=this.renderingRule&&c.isSome(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable?b?n:a:o;this.renderingRule||(w=b?n:a),this._updateFeatureWithRasterAttributeTableValues(r,w)}if(r.sourceLayer=this,u&&this._updateFeatureWithDomainValues(r),s&&d&&s.length===d.length)for(var S=0;S<s.length;S++){var x="Raster.ServicePixelValue."+s[S];r.attributes[x]=this._formatAttributeValue(d[S],x)}g.push(f[_])}return g},t.prototype._updateFeatureWithRasterAttributeTableValues=function(e,t){var r=this,n=this.rasterInfo&&this.rasterInfo.attributeTable||c.isSome(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable,i=n&&n.features;if(i){var o=n.fields,a=o.map((function(e){return e.name})).filter((function(e){return"value"===e.toLowerCase()})),s=a&&a[0];if(s){var l=i.filter((function(e){return e.attributes[s]===(null!=t?parseInt(t,10):null)}));l&&l[0]&&o.forEach((function(t){var n=r.rasterAttributeTableFieldPrefix+t.name;e.attributes[n]=r._formatAttributeValue(l[0].attributes[t.name],n)}))}}},t.prototype._updateFeatureWithMagDirValues=function(e,t){if(this.pixelFilter&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)){var r=t.replace(" ",",").split(",").map((function(e){return parseFloat(e)})),i=r.map((function(e){return[e]})),o=r.map((function(e){return{minValue:e,maxValue:e,noDataValue:null}})),a=new x({height:1,width:1,pixelType:"f32",pixels:i,statistics:o});this.pixelFilter({pixelBlock:a,extent:new n.Extent(0,0,0,0,this.spatialReference)}),e.attributes["Raster.Magnitude"]=a.pixels[0][0],e.attributes["Raster.Direction"]=a.pixels[1][0]}},t.prototype._updateFeatureWithDomainValues=function(e){var t=this.fields&&this.fields.filter((function(e){return e.domain&&"coded-value"===e.domain.type}));null!=t&&t.forEach((function(t){var r=e.attributes[t.name];if(null!=r){var n=t.domain.codedValues.filter((function(e){return e.code===r}))[0];n&&(e.attributes[t.name]=n.name)}}))},t.prototype._updateResponseFieldNames=function(e,t){if(t&&!(t.length<1)){var r=this.fieldsIndex;r&&e.forEach((function(e){if(e&&e.attributes)for(var n=0,i=t;n<i.length;n++){var o=i[n];if(r.has(o)){var a=r.get(o).name;a!==o&&(e.attributes[o]=e.attributes[a],delete e.attributes[a])}}}))}},t.prototype._updateRenderingRulesFunctionName=function(e,t){if(e&&!(e.length<1)){if("Raw"===e)return e.replace("Raw","None");var r=e.toLowerCase().replace(/ /gi,"_");return t.has(r)?t.get(r):e}},t.prototype._isRFTJson=function(e){return e.name&&e.arguments&&e.function&&e.hasOwnProperty("functionType")},t.prototype._readCapabilities=function(e){var t=e.capabilities?e.capabilities.toLowerCase().split(",").map((function(e){return e.trim()})):["image","catalog"],r=e.currentVersion,n=e.advancedQueryCapabilities,i=e.maxRecordCount,o=t.indexOf("image")>-1,a="esriImageServiceDataTypeElevation"===e.serviceDataType,s=!!(e.spatialReference||e.extent&&e.extent.spatialReference);return{operations:{supportsComputeHistograms:o,supportsExportImage:o,supportsIdentify:o,supportsMeasure:t.indexOf("mensuration")>-1&&s,supportsDownload:t.indexOf("download")>-1,supportsQuery:t.indexOf("catalog")>-1&&e.fields&&e.fields.length>0,supportsGetSamples:r>=10.2&&o,supportsProject:r>=10.3&&o,supportsComputeStatisticsHistograms:r>=10.4&&o,supportsQueryBoundary:r>=10.6&&o,supportsCalculateVolume:r>=10.7&&a,supportsComputePixelLocation:r>=10.7&&t.indexOf("catalog")>-1},query:{supportsStatistics:!(!n||!n.supportsStatistics),supportsOrderBy:!(!n||!n.supportsOrderBy),supportsDistinct:!(!n||!n.supportsDistinct),supportsPagination:!(!n||!n.supportsPagination),supportsStandardizedQueriesOnly:!(!n||!n.useStandardizedQueries),maxRecordCount:i}}},r.__decorate([h.property()],t.prototype,"_functionRasterInfos",void 0),r.__decorate([h.property()],t.prototype,"_rasterJobHandler",void 0),r.__decorate([h.property()],t.prototype,"_symbolizer",void 0),r.__decorate([h.property()],t.prototype,"_defaultServiceMosaicRule",void 0),r.__decorate([h.reader("_defaultServiceMosaicRule",["defaultMosaicMethod"])],t.prototype,"readDefaultServiceMosaicRule",null),r.__decorate([h.property()],t.prototype,"_cachedRendererJson",void 0),r.__decorate([h.property()],t.prototype,"rasterAttributeTableFieldPrefix",void 0),r.__decorate([h.property({readOnly:!0,dependsOn:["rasterFunctionInfos"]})],t.prototype,"rasterFunctionNamesIndex",null),r.__decorate([h.property({readOnly:!0,dependsOn:["url"]})],t.prototype,"queryTask",null),r.__decorate([h.property()],t.prototype,"adjustAspectRatio",void 0),r.__decorate([h.property({readOnly:!0}),h.aliasOf("serviceRasterInfo.bandCount")],t.prototype,"bandCount",void 0),r.__decorate([h.property({type:[y.Integer],json:{write:!0}})],t.prototype,"bandIds",void 0),r.__decorate([h.reader("bandIds")],t.prototype,"readBandIds",null),r.__decorate([h.property({readOnly:!0,json:{read:!1}})],t.prototype,"capabilities",void 0),r.__decorate([h.reader("service","capabilities",["capabilities","currentVersion","serviceDataType"])],t.prototype,"readCapabilities",null),r.__decorate([h.property({type:Number})],t.prototype,"compressionQuality",void 0),r.__decorate([h.writer("compressionQuality")],t.prototype,"writeCompressionQuality",null),r.__decorate([h.property({type:Number})],t.prototype,"compressionTolerance",void 0),r.__decorate([h.writer("compressionTolerance")],t.prototype,"writeCompressionTolerance",null),r.__decorate([h.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),r.__decorate([h.property({type:String,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),r.__decorate([h.property({readOnly:!0,constructOnly:!0})],t.prototype,"exportImageServiceParameters",void 0),r.__decorate([h.property()],t.prototype,"rasterInfo",void 0),r.__decorate([h.property({readOnly:!0,type:[_]})],t.prototype,"fields",void 0),r.__decorate([h.property({readOnly:!0,dependsOn:["fields"]})],t.prototype,"fieldsIndex",null),r.__decorate([h.property({type:String,json:{write:!0}})],t.prototype,"format",null),r.__decorate([h.property({type:n.Extent})],t.prototype,"fullExtent",void 0),r.__decorate([h.property({readOnly:!0})],t.prototype,"hasMultidimensions",void 0),r.__decorate([h.property({json:{read:{source:"maxImageHeight"}}})],t.prototype,"imageMaxHeight",void 0),r.__decorate([h.property({json:{read:{source:"maxImageWidth"}}})],t.prototype,"imageMaxWidth",void 0),r.__decorate([h.property({type:String,json:{read:{reader:D.read},write:{writer:D.write}}})],t.prototype,"interpolation",void 0),r.__decorate([h.property({type:S})],t.prototype,"mosaicRule",null),r.__decorate([h.reader("mosaicRule",["mosaicRule","defaultMosaicMethod"])],t.prototype,"readMosaicRule",null),r.__decorate([h.writer("mosaicRule")],t.prototype,"writeMosaicRule",null),r.__decorate([h.property({readOnly:!0}),h.aliasOf("serviceRasterInfo.multidimensionalInfo")],t.prototype,"multidimensionalInfo",void 0),r.__decorate([h.property()],t.prototype,"noData",void 0),r.__decorate([h.writer("noData")],t.prototype,"writeNoData",null),r.__decorate([h.property({type:String,json:{read:{reader:N.read},write:{writer:N.write}}})],t.prototype,"noDataInterpretation",void 0),r.__decorate([h.property({type:String,readOnly:!0,json:{read:{source:["fields"]}}})],t.prototype,"objectIdField",void 0),r.__decorate([h.reader("objectIdField")],t.prototype,"readObjectIdField",null),r.__decorate([h.property({readOnly:!0,dependsOn:["url"]})],t.prototype,"parsedUrl",null),r.__decorate([h.property({readOnly:!0}),h.aliasOf("serviceRasterInfo.pixelSize.x")],t.prototype,"pixelSizeX",void 0),r.__decorate([h.property({readOnly:!0}),h.aliasOf("serviceRasterInfo.pixelSize.y")],t.prototype,"pixelSizeY",void 0),r.__decorate([h.property({type:Function})],t.prototype,"pixelFilter",void 0),r.__decorate([h.property()],t.prototype,"raster",void 0),r.__decorate([h.property()],t.prototype,"viewId",void 0),r.__decorate([h.property({types:o.rasterRendererTypes,json:{read:{source:"layerDefinition.drawingInfo.renderer"},write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",void 0),r.__decorate([h.reader("renderer")],t.prototype,"readRenderer",null),r.__decorate([h.property(m.opacityDrawingInfo)],t.prototype,"opacity",void 0),r.__decorate([h.property({readOnly:!0}),h.aliasOf("serviceRasterInfo.attributeTable")],t.prototype,"rasterAttributeTable",void 0),r.__decorate([h.property({readOnly:!0,dependsOn:["fields","rasterInfo","capabilities"]})],t.prototype,"rasterFields",null),r.__decorate([h.property({readOnly:!0})],t.prototype,"rasterFunctionInfos",void 0),r.__decorate([h.property({type:I})],t.prototype,"renderingRule",null),r.__decorate([h.reader("renderingRule",["renderingRule","rasterFunctionInfos"])],t.prototype,"readRenderingRule",null),r.__decorate([h.writer("renderingRule")],t.prototype,"writeRenderingRule",null),r.__decorate([h.property()],t.prototype,"serviceDataType",void 0),r.__decorate([h.property({readOnly:!0,type:n.SpatialReference})],t.prototype,"spatialReference",void 0),r.__decorate([h.reader("spatialReference",["spatialReference","extent"])],t.prototype,"readSpatialReference",null),r.__decorate([h.property()],t.prototype,"pixelType",void 0),r.__decorate([h.reader("pixelType")],t.prototype,"readPixelType",null),r.__decorate([h.writer("pixelType")],t.prototype,"writePixelType",null),r.__decorate([h.property({constructOnly:!0,type:R})],t.prototype,"serviceRasterInfo",void 0),r.__decorate([h.property()],t.prototype,"sourceJSON",void 0),r.__decorate([h.property(m.url)],t.prototype,"url",void 0),r.__decorate([h.property({readOnly:!0})],t.prototype,"version",void 0),r.__decorate([h.reader("version",["currentVersion","fields","timeInfo"])],t.prototype,"readVersion",null),r.__decorate([h.subclass("esri.layers.mixins.ArcGISImageService")],t)}(e)}}.apply(null,n))||(e.exports=i)},690:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(166),r(155),r(151),r(422),r(400)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=new n.default({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),u=new n.default({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layer=null,t.adjustAspectRatio=void 0,t.bandIds=void 0,t.compression=void 0,t.compressionQuality=void 0,t.compressionTolerance=.01,t.format=null,t.interpolation=null,t.noData=null,t.noDataInterpretation=void 0,t.pixelType=void 0,t.lercVersion=2,t}return r.__extends(t,e),t.prototype.writeAdjustAspectRatio=function(e,t,r){this.layer.version<10.3||(t[r]=e)},t.prototype.writeCompressionQuality=function(e,t,r){this.format&&this.format.toLowerCase().indexOf("jpg")>-1&&null!=e&&(t[r]=e)},t.prototype.writeCompressionTolerance=function(e,t,r){"lerc"===this.format&&null!=e&&(t[r]=e)},t.prototype.writeLercVersion=function(e,t,r){"lerc"===this.format&&this.layer.version>=10.5&&(t[r]=e)},Object.defineProperty(t.prototype,"version",{get:function(){var e=this.layer;return e.bandIds,e.format,e.compressionQuality,e.compressionTolerance,e.interpolation,e.noData,e.noDataInterpretation,e.mosaicRule,e.renderingRule,e.adjustAspectRatio,e.pixelFilter,e.renderer,e.definitionExpression,(this._get("version")||0)+1},set:function(e){this._set("version",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mosaicRule",{get:function(){var e=this.layer,t=e.mosaicRule,r=e.definitionExpression;return t?r&&r!==t.where&&((t=t.clone()).where=r):r&&(t=new s({where:r})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingRule",{get:function(){var e=this.layer,t=e.renderingRule,r=e.pixelFilter;return(!e.format||e.format.indexOf("jpg")>-1||e.format.indexOf("png")>-1)&&!r&&(t=this.combineRendererWithRenderingRule()),t},enumerable:!0,configurable:!0}),t.prototype.combineRendererWithRenderingRule=function(){var e=this.layer,t=e.rasterInfo,r=e.renderingRule,n=e.renderer;return n&&a.isSupportedRendererType(n)?a.combineRenderingRules(a.convertRendererToRenderingRule(n,{rasterAttributeTable:t.attributeTable,pixelType:t.pixelType,convertColorRampToColormap:e.version<10.6,dataType:t.dataType}),r):r},r.__decorate([o.property()],t.prototype,"layer",void 0),r.__decorate([o.property({json:{write:!0}})],t.prototype,"adjustAspectRatio",void 0),r.__decorate([o.writer("adjustAspectRatio")],t.prototype,"writeAdjustAspectRatio",null),r.__decorate([o.property({json:{write:!0}}),o.aliasOf("layer.bandIds")],t.prototype,"bandIds",void 0),r.__decorate([o.property({json:{write:!0}})],t.prototype,"compression",void 0),r.__decorate([o.property({json:{write:!0}}),o.aliasOf("layer.compressionQuality")],t.prototype,"compressionQuality",void 0),r.__decorate([o.writer("compressionQuality")],t.prototype,"writeCompressionQuality",null),r.__decorate([o.property({json:{write:!0}}),o.aliasOf("layer.compressionTolerance")],t.prototype,"compressionTolerance",void 0),r.__decorate([o.writer("compressionTolerance")],t.prototype,"writeCompressionTolerance",null),r.__decorate([o.property({json:{write:!0}}),o.aliasOf("layer.format")],t.prototype,"format",void 0),r.__decorate([o.property({type:String,json:{read:{reader:l.read},write:{writer:l.write}}}),o.aliasOf("layer.interpolation")],t.prototype,"interpolation",void 0),r.__decorate([o.property({json:{write:!0}}),o.aliasOf("layer.noData")],t.prototype,"noData",void 0),r.__decorate([o.property({type:String,json:{read:{reader:u.read},write:{writer:u.write}}}),o.aliasOf("layer.noDataInterpretation")],t.prototype,"noDataInterpretation",void 0),r.__decorate([o.property({json:{write:!0}})],t.prototype,"pixelType",void 0),r.__decorate([o.property({json:{write:!0}})],t.prototype,"lercVersion",void 0),r.__decorate([o.writer("lercVersion")],t.prototype,"writeLercVersion",null),r.__decorate([o.property({type:Number,dependsOn:["layer.adjustAspectRatio","layer.bandIds","layer.format","layer.compressionQuality","layer.compressionTolerance","layer.definitionExpression","layer.interpolation","layer.noData","layer.noDataInterpretation","layer.mosaicRule","layer.renderingRule","layer.pixelFilter","layer.renderer","lercVersion","pixelType"]})],t.prototype,"version",null),r.__decorate([o.property({dependsOn:["layer.mosaicRule","layer.definitionExpression"],json:{write:!0}})],t.prototype,"mosaicRule",null),r.__decorate([o.property({dependsOn:["layer.renderingRule","layer.renderer","layer.rasterInfo","layer.format"],json:{write:!0}})],t.prototype,"renderingRule",null),r.__decorate([o.subclass("esri.layers.mixins.ExportImageServiceParameters")],t)}(i.JSONSupport);t.ExportImageServiceParameters=p}.apply(null,n))||(e.exports=i)},691:function(e,t,r){var n;void 0===(n=function(){"use strict";var e=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}();return function(){if(!self||!self.Uint8ClampedArray)return null;var t=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function r(){this.decodeTransform=null,this.colorTransform=-1}function n(e,t){for(var r,n,i=0,o=[],a=16;a>0&&!e[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(r=0;r<a;r++){for(n=0;n<e[r];n++){for((l=o.pop()).children[l.index]=t[i];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=r;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;i++}r+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function i(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function o(r,n,o,a,s,u,p,c,d){var f=o.mcusPerLine,h=o.progressive,y=n,m=0,g=0;function v(){if(g>0)return g--,m>>g&1;if(255===(m=r[n++])){var t=r[n++];if(t)throw new e("unexpected marker "+(m<<8|t).toString(16))}return g=7,m>>>7}function _(t){for(var r=t;;){if("number"==typeof(r=r[v()]))return r;if("object"!=typeof r)throw new e("invalid huffman sequence")}}function b(e){for(var t=0;e>0;)t=t<<1|v(),e--;return t}function w(e){if(1===e)return 1===v()?1:-1;var t=b(e);return t>=1<<e-1?t:t+(-1<<e)+1}var S,x=0,I=0;function R(e,t,r,n,o){var a=r%f;t(e,i(e,(r/f|0)*e.v+n,a*e.h+o))}function T(e,t,r){t(e,i(e,r/e.blocksPerLine|0,r%e.blocksPerLine))}var C,P,L,k,M,O,E=a.length;O=h?0===u?0===c?function(e,t){var r=_(e.huffmanTableDC),n=0===r?0:w(r)<<d;e.blockData[t]=e.pred+=n}:function(e,t){e.blockData[t]|=v()<<d}:0===c?function(e,r){if(x>0)x--;else for(var n=u,i=p;n<=i;){var o=_(e.huffmanTableAC),a=15&o,s=o>>4;if(0!==a){var l=t[n+=s];e.blockData[r+l]=w(a)*(1<<d),n++}else{if(s<15){x=b(s)+(1<<s)-1;break}n+=16}}}:function(r,n){for(var i,o,a=u,s=p,l=0;a<=s;){var c=t[a];switch(I){case 0:if(l=(o=_(r.huffmanTableAC))>>4,0==(i=15&o))l<15?(x=b(l)+(1<<l),I=4):(l=16,I=1);else{if(1!==i)throw new e("invalid ACn encoding");S=w(i),I=l?2:3}continue;case 1:case 2:r.blockData[n+c]?r.blockData[n+c]+=v()<<d:0==--l&&(I=2===I?3:0);break;case 3:r.blockData[n+c]?r.blockData[n+c]+=v()<<d:(r.blockData[n+c]=S<<d,I=0);break;case 4:r.blockData[n+c]&&(r.blockData[n+c]+=v()<<d)}a++}4===I&&0==--x&&(I=0)}:function(e,r){var n=_(e.huffmanTableDC),i=0===n?0:w(n);e.blockData[r]=e.pred+=i;for(var o=1;o<64;){var a=_(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){var u=t[o+=l];e.blockData[r+u]=w(s),o++}else{if(l<15)break;o+=16}}};var A,D,N,F,j=0;for(D=1===E?a[0].blocksPerLine*a[0].blocksPerColumn:f*o.mcusPerColumn;j<D;){var V=s?Math.min(D-j,s):D;for(P=0;P<E;P++)a[P].pred=0;if(x=0,1===E)for(C=a[0],M=0;M<V;M++)T(C,O,j),j++;else for(M=0;M<V;M++){for(P=0;P<E;P++)for(N=(C=a[P]).h,F=C.v,L=0;L<F;L++)for(k=0;k<N;k++)R(C,O,j,L,k);j++}g=0,(A=l(r,n))&&A.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+A.invalid),n=A.offset);var U=A&&A.marker;if(!U||U<=65280)throw new e("marker was not found");if(!(U>=65488&&U<=65495))break;n+=2}return(A=l(r,n))&&A.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+A.invalid),n=A.offset),n-y}function a(t,r,n){var i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b,w=t.quantizationTable,S=t.blockData;if(!w)throw new e("missing required Quantization Table.");for(var x=0;x<64;x+=8)d=S[r+x],f=S[r+x+1],h=S[r+x+2],y=S[r+x+3],m=S[r+x+4],g=S[r+x+5],v=S[r+x+6],_=S[r+x+7],d*=w[x],0!=(f|h|y|m|g|v|_)?(f*=w[x+1],h*=w[x+2],y*=w[x+3],m*=w[x+4],g*=w[x+5],o=(i=(i=5793*d+128>>8)+(o=5793*m+128>>8)+1>>1)-o,b=3784*(a=h)+1567*(s=v*=w[x+6])+128>>8,a=1567*a-3784*s+128>>8,p=(l=(l=2896*(f-(_*=w[x+7]))+128>>8)+(p=g<<4)+1>>1)-p,u=(c=(c=2896*(f+_)+128>>8)+(u=y<<4)+1>>1)-u,s=(i=i+(s=b)+1>>1)-s,a=(o=o+a+1>>1)-a,b=2276*l+3406*c+2048>>12,l=3406*l-2276*c+2048>>12,c=b,b=799*u+4017*p+2048>>12,u=4017*u-799*p+2048>>12,p=b,n[x]=i+c,n[x+7]=i-c,n[x+1]=o+p,n[x+6]=o-p,n[x+2]=a+u,n[x+5]=a-u,n[x+3]=s+l,n[x+4]=s-l):(b=5793*d+512>>10,n[x]=b,n[x+1]=b,n[x+2]=b,n[x+3]=b,n[x+4]=b,n[x+5]=b,n[x+6]=b,n[x+7]=b);for(var I=0;I<8;++I)d=n[I],0!=((f=n[I+8])|(h=n[I+16])|(y=n[I+24])|(m=n[I+32])|(g=n[I+40])|(v=n[I+48])|(_=n[I+56]))?(o=(i=4112+((i=5793*d+2048>>12)+(o=5793*m+2048>>12)+1>>1))-o,b=3784*(a=h)+1567*(s=v)+2048>>12,a=1567*a-3784*s+2048>>12,s=b,p=(l=(l=2896*(f-_)+2048>>12)+(p=g)+1>>1)-p,u=(c=(c=2896*(f+_)+2048>>12)+(u=y)+1>>1)-u,b=2276*l+3406*c+2048>>12,l=3406*l-2276*c+2048>>12,c=b,b=799*u+4017*p+2048>>12,u=4017*u-799*p+2048>>12,d=(d=(i=i+s+1>>1)+c)<16?0:d>=4080?255:d>>4,f=(f=(o=o+a+1>>1)+(p=b))<16?0:f>=4080?255:f>>4,h=(h=(a=o-a)+u)<16?0:h>=4080?255:h>>4,y=(y=(s=i-s)+l)<16?0:y>=4080?255:y>>4,m=(m=s-l)<16?0:m>=4080?255:m>>4,g=(g=a-u)<16?0:g>=4080?255:g>>4,v=(v=o-p)<16?0:v>=4080?255:v>>4,_=(_=i-c)<16?0:_>=4080?255:_>>4,S[r+I]=d,S[r+I+8]=f,S[r+I+16]=h,S[r+I+24]=y,S[r+I+32]=m,S[r+I+40]=g,S[r+I+48]=v,S[r+I+56]=_):(b=(b=5793*d+8192>>14)<-2040?0:b>=2024?255:b+2056>>4,S[r+I]=b,S[r+I+8]=b,S[r+I+16]=b,S[r+I+24]=b,S[r+I+32]=b,S[r+I+40]=b,S[r+I+48]=b,S[r+I+56]=b)}function s(e,t){for(var r=t.blocksPerLine,n=t.blocksPerColumn,o=new Int16Array(64),s=0;s<n;s++)for(var l=0;l<r;l++)a(t,i(t,s,l),o);return t.blockData}function l(e,t,r){function n(t){return e[t]<<8|e[t+1]}var i=e.length-1,o=r<t?r:t;if(t>=i)return null;var a=n(t);if(a>=65472&&a<=65534)return{invalid:null,marker:a,offset:t};for(var s=n(o);!(s>=65472&&s<=65534);){if(++o>=i)return null;s=n(o)}return{invalid:a.toString(16),marker:s,offset:o}}return r.prototype={parse:function(r){function i(){var e=r[d]<<8|r[d+1];return d+=2,e}function a(){var e=i(),t=d+e-2,n=l(r,t,d);n&&n.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+n.invalid),t=n.offset);var o=r.subarray(d,t);return d+=o.length,o}function u(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),n=0;n<e.components.length;n++){j=e.components[n];var i=Math.ceil(Math.ceil(e.samplesPerLine/8)*j.h/e.maxH),o=Math.ceil(Math.ceil(e.scanLines/8)*j.v/e.maxV),a=t*j.h,s=r*j.v*64*(a+1);j.blockData=new Int16Array(s),j.blocksPerLine=i,j.blocksPerColumn=o}e.mcusPerLine=t,e.mcusPerColumn=r}var p,c,d=0,f=null,h=null,y=[],m=[],g=[],v=i();if(65496!==v)throw new e("SOI not found");for(v=i();65497!==v;){var _,b,w;switch(v){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var S=a();65504===v&&74===S[0]&&70===S[1]&&73===S[2]&&70===S[3]&&0===S[4]&&(f={version:{major:S[5],minor:S[6]},densityUnits:S[7],xDensity:S[8]<<8|S[9],yDensity:S[10]<<8|S[11],thumbWidth:S[12],thumbHeight:S[13],thumbData:S.subarray(14,14+3*S[12]*S[13])}),65518===v&&65===S[0]&&100===S[1]&&111===S[2]&&98===S[3]&&101===S[4]&&(h={version:S[5]<<8|S[6],flags0:S[7]<<8|S[8],flags1:S[9]<<8|S[10],transformCode:S[11]});break;case 65499:for(var x=i()+d-2;d<x;){var I=r[d++],R=new Uint16Array(64);if(I>>4==0)for(b=0;b<64;b++)R[t[b]]=r[d++];else{if(I>>4!=1)throw new e("DQT - invalid table spec");for(b=0;b<64;b++)R[t[b]]=i()}y[15&I]=R}break;case 65472:case 65473:case 65474:if(p)throw new e("Only single frame JPEGs supported");i(),(p={}).extended=65473===v,p.progressive=65474===v,p.precision=r[d++],p.scanLines=i(),p.samplesPerLine=i(),p.components=[],p.componentIds={};var T,C=r[d++],P=0,L=0;for(_=0;_<C;_++){T=r[d];var k=r[d+1]>>4,M=15&r[d+1];P<k&&(P=k),L<M&&(L=M);var O=r[d+2];w=p.components.push({h:k,v:M,quantizationId:O,quantizationTable:null}),p.componentIds[T]=w-1,d+=3}p.maxH=P,p.maxV=L,u(p);break;case 65476:var E=i();for(_=2;_<E;){var A=r[d++],D=new Uint8Array(16),N=0;for(b=0;b<16;b++,d++)N+=D[b]=r[d];var F=new Uint8Array(N);for(b=0;b<N;b++,d++)F[b]=r[d];_+=17+N,(A>>4==0?g:m)[15&A]=n(D,F)}break;case 65501:i(),c=i();break;case 65498:i();var j,V=r[d++],U=[];for(_=0;_<V;_++){var B=p.componentIds[r[d++]];j=p.components[B];var G=r[d++];j.huffmanTableDC=g[G>>4],j.huffmanTableAC=m[15&G],U.push(j)}var z=r[d++],J=r[d++],q=r[d++],H=o(r,d,p,U,c,z,J,q>>4,15&q);d+=H;break;case 65535:255!==r[d]&&d--;break;default:if(255===r[d-3]&&r[d-2]>=192&&r[d-2]<=254){d-=3;break}throw new e("unknown marker "+v.toString(16))}v=i()}for(this.width=p.samplesPerLine,this.height=p.scanLines,this.jfif=f,this.eof=d,this.adobe=h,this.components=[],_=0;_<p.components.length;_++){var W=y[(j=p.components[_]).quantizationId];W&&(j.quantizationTable=W),this.components.push({output:s(0,j),scaleX:j.h/p.maxH,scaleY:j.v/p.maxV,blocksPerLine:j.blocksPerLine,blocksPerColumn:j.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(e,t){var r,n,i,o,a,s,l,u,p,c,d,f=this.width/e,h=this.height/t,y=0,m=this.components.length,g=e*t*m,v=new Uint8ClampedArray(g),_=new Uint32Array(e);for(l=0;l<m;l++){for(n=(r=this.components[l]).scaleX*f,i=r.scaleY*h,y=l,d=r.output,o=r.blocksPerLine+1<<3,a=0;a<e;a++)u=0|a*n,_[a]=(4294967288&u)<<3|7&u;for(s=0;s<t;s++)for(c=o*(4294967288&(u=0|s*i))|(7&u)<<3,a=0;a<e;a++)v[y]=d[c+_[a]],y+=m}var b=this.decodeTransform;if(b)for(l=0;l<g;)for(u=0,p=0;u<m;u++,l++,p+=2)v[l]=(v[l]*b[p]>>8)+b[p+1];return v},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this.colorTransform:1===this.colorTransform},_convertYccToRgb:function(e){for(var t,r,n,i=0,o=e.length;i<o;i+=3)t=e[i],r=e[i+1],n=e[i+2],e[i]=t-179.456+1.402*n,e[i+1]=t+135.459-.344*r-.714*n,e[i+2]=t-226.816+1.772*r;return e},_convertYcckToRgb:function(e){for(var t,r,n,i,o=0,a=0,s=e.length;a<s;a+=4)t=e[a],r=e[a+1],n=e[a+2],i=e[a+3],e[o++]=r*(-660635669420364e-19*r+.000437130475926232*n-54080610064599e-18*t+.00048449797120281*i-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*t-.00477271405408747*i+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),e[o++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*n+.000659397001245577*t+.000426105652938837*i-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*t+.000770482631801132*i-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),e[o++]=r*(-.000570115196973677*r-263409051004589e-19*n+.0020741088115012*t-.00288260236853442*i+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*t+.000560833691242812*i-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return e},_convertYcckToCmyk:function(e){for(var t,r,n,i=0,o=e.length;i<o;i+=4)t=e[i],r=e[i+1],n=e[i+2],e[i]=434.456-t-1.402*n,e[i+1]=119.541-t+.344*r+.714*n,e[i+2]=481.816-t-1.772*r;return e},_convertCmykToRgb:function(e){for(var t,r,n,i,o=0,a=0,s=e.length;a<s;a+=4)t=e[a]*(1/255),r=e[a+1]*(1/255),n=e[a+2]*(1/255),i=e[a+3]*(1/255),e[o++]=255+t*(-4.387332384609988*t+54.48615194189176*r+18.82290502165302*n+212.25662451639585*i-285.2331026137004)+r*(1.7149763477362134*r-5.6096736904047315*n-17.873870861415444*i-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*i+17.5119270841813)-i*(21.86122147463605*i+189.48180835922747),e[o++]=255+t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*n+31.159100130055922*i-79.2970844816548)+r*(-15.310361306967817*r+17.575251261109482*n+131.35250912493976*i-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*i-24.86741582555878)-i*(20.737325471181034*i+187.80453709719578),e[o++]=255+t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*n-.23883238689178934*i-14.183576799673286)+r*(10.49593273432072*r+63.02378494754052*n+50.606957656360734*i-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*i-193.58209356861505)-i*(22.33816807309886*i+180.12613974708367);return e},getData:function(t,r,n){if(this.numComponents>4)throw new e("Unsupported color mode");var i=this._getLinearizedBlockData(t,r);if(1===this.numComponents&&n){for(var o=i.length,a=new Uint8ClampedArray(3*o),s=0,l=0;l<o;l++){var u=i[l];a[s++]=u,a[s++]=u,a[s++]=u}return a}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(i);if(4===this.numComponents){if(this._isColorConversionNeeded())return n?this._convertYcckToRgb(i):this._convertYcckToCmyk(i);if(n)return this._convertCmykToRgb(i)}return i}},r}()}.apply(null,[]))||(e.exports=n)},692:function(e,t,r){var n,i;n=[r(168)],void 0===(i=function(e){var t={};t.defaultNoDataValue=e.clampFloat32(-1/0),t.decode=function(a,s){var l=(s=s||{}).encodedMaskData||null===s.encodedMaskData,u=o(a,s.inputOffset||0,l),p=null!=s.noDataValue?e.clampFloat32(s.noDataValue):t.defaultNoDataValue,c=r(u,s.pixelType||Float32Array,s.encodedMaskData,p,s.returnMask),d={width:u.width,height:u.height,pixelData:c.resultPixels,minValue:u.pixels.minValue,maxValue:u.pixels.maxValue,noDataValue:p};return c.resultMask&&(d.maskData=c.resultMask),s.returnEncodedMask&&u.mask&&(d.encodedMaskData=u.mask.bitset?u.mask.bitset:null),s.returnFileInfo&&(d.fileInfo=n(u),s.computeUsedBitDepths&&(d.fileInfo.bitDepths=i(u))),d};var r=function(e,t,r,n,i){var o,s,l=0,u=e.pixels.numBlocksX,p=e.pixels.numBlocksY,c=Math.floor(e.width/u),d=Math.floor(e.height/p),f=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),o=new t(e.width*e.height),i&&r&&(s=new Uint8Array(e.width*e.height));for(var h,y,m=new Float32Array(c*d),g=0;g<=p;g++){var v=g!==p?d:e.height%p;if(0!==v)for(var _=0;_<=u;_++){var b=_!==u?c:e.width%u;if(0!==b){var w,S,x,I,R=g*e.width*d+_*c,T=e.width-b,C=e.pixels.blocks[l];if(C.encoding<2?(0===C.encoding?w=C.rawData:(a(C.stuffedData,C.bitsPerPixel,C.numValidPixels,C.offset,f,m,e.pixels.maxValue),w=m),S=0):x=2===C.encoding?0:C.offset,r)for(y=0;y<v;y++){for(7&R&&(I=r[R>>3],I<<=7&R),h=0;h<b;h++)7&R||(I=r[R>>3]),128&I?(s&&(s[R]=1),o[R++]=C.encoding<2?w[S++]:x):(s&&(s[R]=0),o[R++]=n),I<<=1;R+=T}else if(C.encoding<2)for(y=0;y<v;y++){for(h=0;h<b;h++)o[R++]=w[S++];R+=T}else for(y=0;y<v;y++)if(o.fill)o.fill(x,R,R+b),R+=b+T;else{for(h=0;h<b;h++)o[R++]=x;R+=T}if(1===C.encoding&&S!==C.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:o,resultMask:s}},n=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:this.noDataValue}}},i=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var i=e.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},o=function(e,t,r){var n={},i=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!=n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var o=new DataView(e,t,24);if(n.fileVersion=o.getInt32(0,!0),n.imageType=o.getInt32(4,!0),n.height=o.getUint32(8,!0),n.width=o.getUint32(12,!0),n.maxZError=o.getFloat64(16,!0),t+=24,!r)if(o=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=o.getUint32(0,!0),n.mask.numBlocksX=o.getUint32(4,!0),n.mask.numBytes=o.getUint32(8,!0),n.mask.maxValue=o.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var a=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(o=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(s>0)for(;s--;)a[u++]=o.getUint8(l++);else{var p=o.getUint8(l++);for(s=-s;s--;)a[u++]=p}s=o.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||u<a.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=a,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(a=new Uint8Array(Math.ceil(n.width*n.height/8)),n.mask.bitset=a);o=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=o.getUint32(0,!0),n.pixels.numBlocksX=o.getUint32(4,!0),n.pixels.numBytes=o.getUint32(8,!0),n.pixels.maxValue=o.getFloat32(12,!0),t+=16;var c=n.pixels.numBlocksX,d=n.pixels.numBlocksY,f=c+(n.width%c>0?1:0),h=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(f*h);for(var y=1e9,m=0,g=0;g<h;g++)for(var v=0;v<f;v++){var _=0,b=e.byteLength-t;o=new DataView(e,t,Math.min(10,b));var w={};n.pixels.blocks[m++]=w;var S=o.getUint8(0);if(_++,w.encoding=63&S,w.encoding>3)throw"Invalid block encoding ("+w.encoding+")";if(2!==w.encoding){if(0!==S&&2!==S){if(S>>=6,w.offsetType=S,2===S)w.offset=o.getInt8(1),_++;else if(1===S)w.offset=o.getInt16(1,!0),_+=2;else{if(0!==S)throw"Invalid block offset type";w.offset=o.getFloat32(1,!0),_+=4}if(y=Math.min(w.offset,y),1===w.encoding)if(S=o.getUint8(_),_++,w.bitsPerPixel=63&S,S>>=6,w.numValidPixelsType=S,2===S)w.numValidPixels=o.getUint8(_),_++;else if(1===S)w.numValidPixels=o.getUint16(_,!0),_+=2;else{if(0!==S)throw"Invalid valid pixel count type";w.numValidPixels=o.getUint32(_,!0),_+=4}}var x;if(t+=_,3!=w.encoding)if(0===w.encoding){var I=(n.pixels.numBytes-1)/4;if(I!==Math.floor(I))throw"uncompressed block has invalid length";x=new ArrayBuffer(4*I),new Uint8Array(x).set(new Uint8Array(e,t,4*I));for(var R=new Float32Array(x),T=0;T<R.length;T++)y=Math.min(y,R[T]);w.rawData=R,t+=4*I}else if(1===w.encoding){var C=Math.ceil(w.numValidPixels*w.bitsPerPixel/8),P=Math.ceil(C/4);x=new ArrayBuffer(4*P),new Uint8Array(x).set(new Uint8Array(e,t,C)),w.stuffedData=new Uint32Array(x),t+=C}}else t++,y=Math.min(y,0)}return n.pixels.minValue=y,n.eofOffset=t,n},a=function(e,t,r,n,i,o,a){var s,l,u,p=(1<<t)-1,c=0,d=0,f=Math.ceil((a-n)/i),h=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*h,s=0;s<r;s++){if(0===d&&(u=e[c++],d=32),d>=t)l=u>>>d-t&p,d-=t;else{var y=t-d;l=(u&p)<<y&p,l+=(u=e[c++])>>>(d=32-y)}o[s]=l<f?n+l*i:a}return o};return t}.apply(null,n))||(e.exports=i)},693:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(152),r(151),r(234),r(327),r(694)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.execute=function(e,t){var o=this,s=e.geometry?[e.geometry]:[];return a.normalizeCentralMeridian(s).then((function(a){var s=e.toJSON(),l=a&&a[0];i.isSome(l)&&(s.geometry=JSON.stringify(l.toJSON()));var u=o._encode(r.__assign(r.__assign({f:"json"},o.parsedUrl.query),s)),p=r.__assign(r.__assign({query:u},o.requestOptions),t);return n(o.parsedUrl.path+"/identify",p)})).then((function(e){return l.fromJSON(e.data)}))},r.__decorate([o.subclass("esri.tasks.ImageServiceIdentifyTask")],t)}(s)}.apply(null,n))||(e.exports=i)},694:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(151),r(202),r(187)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.catalogItemVisibilities=null,t.catalogItems=null,t.location=null,t.name=null,t.objectId=null,t.processedValues=null,t.properties=null,t.value=null,t}return r.__extends(t,e),r.__decorate([i.property({json:{write:!0}})],t.prototype,"catalogItemVisibilities",void 0),r.__decorate([i.property({type:a,json:{write:!0}})],t.prototype,"catalogItems",void 0),r.__decorate([i.property({type:o,json:{write:!0}})],t.prototype,"location",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"name",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"objectId",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"processedValues",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"properties",void 0),r.__decorate([i.property({json:{write:!0}})],t.prototype,"value",void 0),r.__decorate([i.subclass("esri.tasks.support.ImageServiceIdentifyResult")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},695:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(151),r(179),r(989)],void 0===(i=function(e,t,r,n,i,o,a){var s={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};return function(e){function t(t){var r=e.call(this,t)||this;return r.contentType=null,r.exifInfo=null,r.id=null,r.globalId=null,r.keywords=null,r.name=null,r.parentGlobalId=null,r.parentObjectId=null,r.size=null,r.url=null,r}var n;return r.__extends(t,e),n=t,Object.defineProperty(t.prototype,"orientationInfo",{get:function(){var e=this.exifInfo,t=a.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return s[t]||null},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})},r.__decorate([i.property({type:String})],t.prototype,"contentType",void 0),r.__decorate([i.property()],t.prototype,"exifInfo",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["exifInfo"]})],t.prototype,"orientationInfo",null),r.__decorate([i.property({type:o.Integer})],t.prototype,"id",void 0),r.__decorate([i.property({type:String})],t.prototype,"globalId",void 0),r.__decorate([i.property({type:String})],t.prototype,"keywords",void 0),r.__decorate([i.property({type:String})],t.prototype,"name",void 0),r.__decorate([i.property({json:{read:!1}})],t.prototype,"parentGlobalId",void 0),r.__decorate([i.property({json:{read:!1}})],t.prototype,"parentObjectId",void 0),r.__decorate([i.property({type:o.Integer})],t.prototype,"size",void 0),r.__decorate([i.property({json:{read:!1}})],t.prototype,"url",void 0),n=r.__decorate([i.subclass("esri.layers.support.AttachmentInfo")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},696:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(282),r(155),r(151),r(202),r(163),r(400),r(313)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.geometry=null,t.renderingRules=null,t.pixelSize=null,t.returnGeometry=!0,t.returnCatalogItems=!0,t.returnPixelValues=!0,t.maxItemCount=null,t.timeExtent=null,t.raster=void 0,t.viewId=void 0,t}return r.__extends(t,e),t.prototype.writeGeometry=function(e,t,r){null!=e&&(t.geometryType=s.getJsonType(e),t[r]=JSON.stringify(e.toJSON()))},Object.defineProperty(t.prototype,"mosaicRule",{set:function(e){var t=e;t&&t.mosaicMethod&&(t=l.fromJSON(r.__assign(r.__assign({},t.toJSON()),{mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation}))),this._set("mosaicRule",t)},enumerable:!0,configurable:!0}),t.prototype.writeMosaicRule=function(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))},Object.defineProperty(t.prototype,"renderingRule",{set:function(e){var t=e;t&&t.rasterFunction&&(t=u.fromJSON(r.__assign(r.__assign({},t.toJSON()),{rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments}))),this._set("renderingRule",t)},enumerable:!0,configurable:!0}),t.prototype.writeRenderingRule=function(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))},t.prototype.writeRenderingRules=function(e,t,r){null!=e&&(t[r]=JSON.stringify(e.map((function(e){return e.toJSON()}))))},t.prototype.writePixelSize=function(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))},t.prototype.writeTimeExtent=function(e,t,r){if(null!=e){var n=e.start?e.start.getTime():null,i=e.end?e.end.getTime():null;t[r]=null!=n?null!=i?n+","+i:""+n:null}},r.__decorate([o.property({json:{write:!0}})],t.prototype,"geometry",void 0),r.__decorate([o.writer("geometry")],t.prototype,"writeGeometry",null),r.__decorate([o.property({type:l,json:{write:!0}})],t.prototype,"mosaicRule",null),r.__decorate([o.writer("mosaicRule")],t.prototype,"writeMosaicRule",null),r.__decorate([o.property({type:u,json:{write:!0}})],t.prototype,"renderingRule",null),r.__decorate([o.writer("renderingRule")],t.prototype,"writeRenderingRule",null),r.__decorate([o.property({type:[u],json:{write:!0}})],t.prototype,"renderingRules",void 0),r.__decorate([o.writer("renderingRules")],t.prototype,"writeRenderingRules",null),r.__decorate([o.property({type:a,json:{write:!0}})],t.prototype,"pixelSize",void 0),r.__decorate([o.writer("pixelSize")],t.prototype,"writePixelSize",null),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"returnGeometry",void 0),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"returnCatalogItems",void 0),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"returnPixelValues",void 0),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"maxItemCount",void 0),r.__decorate([o.property({type:n,json:{write:{target:"time"}}})],t.prototype,"timeExtent",void 0),r.__decorate([o.writer("timeExtent")],t.prototype,"writeTimeExtent",null),r.__decorate([o.property({json:{write:!0}})],t.prototype,"raster",void 0),r.__decorate([o.property({json:{write:!0}})],t.prototype,"viewId",void 0),r.__decorate([o.subclass("esri.tasks.support.ImageServiceIdentifyParameters")],t)}(i.JSONSupport)}.apply(null,n))||(e.exports=i)},826:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(827),r(691),r(828),r(462)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s,l,u=(s=new ArrayBuffer(4),l=new Uint8Array(s),new Uint32Array(s)[0]=1,1===l[0]),p=[0,1,1,2,4,8,1,1,2,4,8,4,8];function c(e,t){var r="unknown";return 3===e?r="f32":1===e?1===t?r="u1":2===t?r="u2":4===t?r="u4":t<=8?r="u8":t<=16?r="u16":t<=32&&(r="u32"):2===e&&(t<=8?r="s8":t<=16?r="s16":t<=32&&(r="s32")),r}function d(e){var t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;default:t=Float32Array}return t}function f(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function h(e,t){var r=e.get(t);return r&&r.values}function y(e,t){var r=e.get(t);return r&&r.values[0]}function m(e,t,r,n,i,a){void 0===n&&(n=0),void 0===i&&(i=o.TIFF_TAGS),void 0===a&&(a=4);var s=new DataView(e,r,2).getUint16(0,t),l=4+2*a,u=2+s*l;if(r+u>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:u};for(var p,c,d,f,h,y,m,g=r+u+4<=e.byteLength?new DataView(e,r+u,4).getUint32(0,t):null,_=r+2,b=new Map,w=0;w<s;w++){if(d=(c=new DataView(e,_+l*w,l)).getUint16(0,t),h=c.getUint16(2,t),f=o.getTagName(d,i),2===a)y=c.getUint16(4,t),m=c.getUint16(6,t);else if(4===a)y=c.getUint32(4,t),m=c.getUint32(8,t);else if(8===a)if(y=0,m=0,t)for(var S=0;S<8;S++)y+=c.getUint8(4+S)*Math.pow(2,8*S),m+=c.getUint8(12+S)*Math.pow(2,8*S);else for(S=0;S<8;S++)y+=c.getUint8(4+S)*Math.pow(2,8*(7-S)),m+=c.getUint8(12+S)*Math.pow(2,8*(7-S));v(e,t,p={id:d,type:h,valueCount:y,valueOffset:m,values:null},n),b.set(f,p)}return{success:!0,ifd:b,nextIFD:g,requiredBufferSize:u}}var g=function(e,t,r,n,o){var s,l,p,f,h,m,g=u===t,v=y(r,"BITSPERSAMPLE"),_=c(y(r,"SAMPLEFORMAT")||1,v),b=y(r,"COMPRESSION")[0]||1,w=d(_);if(1===b)p=e.slice(n,n+o),f=new Uint8Array(p);else if(8===b||32946===b)f=new Uint8Array(e,n,o),m=new a(f).getBytes(),p=new ArrayBuffer(m.length),(f=new Uint8Array(p)).set(m);else if(6===b){f=new Uint8Array(e,n,o);var S=new i;S.parse(f);var x=S.getData(S.width,S.height,!0);p=new ArrayBuffer(x.length),(f=new Uint8Array(p)).set(x)}if("u8"===_||"s8"===_||g)l=new w(p);else{switch(p=new ArrayBuffer(f.length),h=new Uint8Array(p),_){case"u16":case"s16":for(s=0;s<f.length;s+=2)h[s]=f[s+1],h[s+1]=f[s];break;case"u32":case"s32":case"f32":for(s=0;s<f.length;s+=4)h[s]=f[s+3],h[s+1]=f[s+2],h[s+2]=f[s+1],h[s+3]=f[s]}l=new w(p)}return l};function v(e,t,r,n,i){if(void 0===n&&(n=0),r.values)return!0;var o,a,s=r.type,l=r.valueCount,u=r.valueOffset,c=[],d=p[s],f=8*d,h=l*d,y=l*p[s]*8;if(y>32&&h>(i?e.byteLength:e?e.byteLength-u+n:0))return r.offlineOffsetSize=[u,h],r.values=null,!1;if(y<=32)if(t||(u>>>=32-y),1===l)c=[u];else for(a=0;a<l;a++)c.push(u<<f*a>>>32-f);else{u-=n,i&&(u=0);for(var m=u;m<u+h;m+=d){switch(s){case 1:case 2:o=new DataView(e,m,1).getUint8(0);break;case 3:o=new DataView(e,m,2).getUint16(0,t);break;case 4:o=new DataView(e,m,4).getUint32(0,t);break;case 5:o=new DataView(e,m,4).getUint32(0,t)/new DataView(e,m+4,4).getUint32(0,t);break;case 6:o=new DataView(e,m,1).getInt8(0);break;case 7:o=new DataView(e,m,1).getUint8(0);break;case 8:o=new DataView(e,m,2).getInt16(0,t);break;case 9:o=new DataView(e,m,4).getInt32(0,t);break;case 10:o=new DataView(e,m,4).getInt32(0,t)/new DataView(e,m+4,4).getInt32(0,t);break;case 11:o=new DataView(e,m,4).getFloat32(0,t);break;case 12:o=new DataView(e,m,8).getFloat64(0,t);break;default:o=null}c.push(o)}}if(2===s){var g="",v=c;for(c=[],a=0;a<v.length;a++)0===v[a]&&""!==g?(c.push(g),g=""):g+=String.fromCharCode(v[a]);""===g&&0!==c.length||c.push(g)}return r.values=c,!0}function _(e){var t,r=e[0],n=y(r,"TILEWIDTH"),i=y(r,"TILELENGTH"),o=y(r,"IMAGEWIDTH"),a=y(r,"IMAGELENGTH"),s=y(r,"BITSPERSAMPLE"),l=y(r,"SAMPLESPERPIXEL"),u=y(r,"SAMPLEFORMAT")||1,p=c(u,s),d=!!h(r,"PLANARCONFIGURATION")&&2===h(r,"PLANARCONFIGURATION")[0],m=h(r,"GDAL_NODATA");null!=m&&("string"==typeof m[0]?(t=m.map((function(e){return parseFloat(e)}))).some((function(e){return isNaN(e)}))&&(t=null):"number"==typeof m[0]&&(t=m));var g,v=y(r,"COMPRESSION")||1;switch(v){case 1:g="NONE";break;case 2:case 3:case 4:case 32771:g="CCITT";break;case 5:g="LZW";break;case 6:case 7:g="JPEG";break;case 32773:g="PACKBITS";break;case 8:case 32946:g="DEFLATE";break;case 34712:g="JPEG2000";break;default:g=String(v)}var _=!0,b="";1!==v&&6!==v&&8!==v&&32946!==v&&(_=!1,b+="unsupported tag compression "+v),u>3&&(_=!1,b+="unsupported tag sampleFormat "+u),s%8!=0&&(_=!1,b+="unsupported tag bitsPerSample "+s);var w,S=y(r,"GEOASCIIPARAMS");if(S){var x=S.split("|").filter((function(e){return e.indexOf("ESRI PE String = ")>-1}))[0],I=x?x.replace("ESRI PE String = ",""):"";w=0===I.indexOf("PROJCS")||0===I.indexOf("GEOGCS")?{wkid:null,wkt:I}:null}var R,T,C=h(r,"GEOTIEPOINTS"),P=h(r,"GEOPIXELSCALE"),L=h(r,"GEOTRANSMATRIX"),k=r.has("GEOKEYDIRECTORY")?r.get("GEOKEYDIRECTORY").data:null,M=!1;if(k){M=2===y(k,"GTRasterTypeGeoKey");var O=y(k,"GTModelTypeGeoKey");if(2===O){var E=y(k,"GeographicTypeGeoKey");E>1024&&E<32766&&(w={wkid:E})}else if(1===O){var A=y(k,"ProjectedCSTypeGeoKey");A>1024&&A<32766&&(w={wkid:A})}}if(P&&C&&C.length>=6?(R=[P[0],0,C[3]-C[0]*P[0],0,-Math.abs(P[1]),C[4]-C[1]*P[1]],M&&(R[2]-=.5*R[0]+.5*R[1],R[5]-=.5*R[3]+.5*R[4])):L&&16===L.length&&(R=[L[0],L[1],L[3],L[4],L[5],L[7]]),R){for(var D=[{x:0,y:a},{x:0,y:0},{x:o,y:a},{x:o,y:0}],N=void 0,F=Number.POSITIVE_INFINITY,j=Number.POSITIVE_INFINITY,V=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY,B=0;B<D.length;B++)F=(N=f(D[B],R)).x>F?F:N.x,V=N.x<V?V:N.x,j=N.y>j?j:N.y,U=N.y<U?U:N.y;T={xmin:F,xmax:V,ymin:j,ymax:U,spatialReference:w}}var G,z,J,q,H,W=e.filter((function(e){return 1===y(e,"NEWSUBFILETYPE")}));W.length>0&&(G=Math.round(Math.log(o/y(W[0],"IMAGEWIDTH"))/Math.LN2),z=Math.round(Math.log(o/y(W[W.length-1],"IMAGEWIDTH"))/Math.LN2),J=y(W[W.length-1],"TILEWIDTH"),q=y(W[W.length-1],"TILEHEIGHT")),J=z>0?J||n:null,q=z>0?q||i:null,n&&(H=[{maxCol:Math.ceil(o/n)-1,maxRow:Math.ceil(a/i)-1,minRow:0,minCol:0}],W.forEach((function(e){H.push({maxCol:Math.ceil(y(e,"IMAGEWIDTH")/y(e,"TILEWIDTH"))-1,maxRow:Math.ceil(y(e,"IMAGELENGTH")/y(e,"TILELENGTH"))-1,minRow:0,minCol:0})})));var Z=function(e){if(!e)return null;var t=e.match(/<Item(.*?)Item>/gi);if(!t||0===t.length)return null;for(var r,n,i,o,a,s=new Map,l=0;l<t.length;l++)n=(r=t[l]).slice("<Item ".length,r.indexOf(">")),(o=r.indexOf("sample="))>-1&&(a=r.slice(o+'sample="'.length,r.indexOf('"',o+'sample="'.length))),(o=r.indexOf("name="))>-1&&(n=r.slice(o+'name="'.length,r.indexOf('"',o+'name="'.length))),n&&(i=r.slice(r.indexOf(">")+1,r.indexOf("</Item>")).trim(),null!=a?s.has(n)?s.get(n)[a]=i:s.set(n,[i]):s.set(n,i)),a=null;var u=s.get("STATISTICS_MINIMUM"),p=s.get("STATISTICS_MAXIMUM"),c=s.get("STATISTICS_MEAN"),d=s.get("STATISTICS_STDDEV"),f=null;if(u&&p)for(f=[],l=0;l<u.length;l++)f.push({min:parseFloat(u[l]),max:parseFloat(p[l]),avg:c&&parseFloat(c[l]),stddev:d&&parseFloat(d[l])});var h=s.get("BandName"),y=s.get("WavelengthMin"),m=s.get("WavelengthMax"),g=null;if(h)for(g=[],l=0;l<h.length;l++)g.push({BandName:h[l],WavelengthMin:y&&parseFloat(y[l]),WavelengthMax:m&&parseFloat(m[l])});return{statistics:f,bandProperties:g,dataType:s.get("DataType"),rawMetadata:s}}(y(e[0],"GDAL_METADATA"));return{width:o,height:a,tileWidth:n,tileHeight:i,planes:l,isBSQ:d,pixelType:p,compression:g,noData:t,isSupported:_,message:b,extent:T,firstPyramidLevel:G,maximumPyramidLevel:z,pyramidBlockWidth:J,pyramidBlockHeight:q,tileBoundary:H,metadata:Z}}function b(e){var t=new DataView(e,0,8),n=t.getUint16(0,!1),i=null;if(18761===n)i=!0;else{if(19789!==n)throw"unexpected endianess byte";i=!1}if(42!==t.getUint16(2,i))throw"unexpected tiff identifier";var o,a=t.getUint32(4,i),s=[];do{if(!(o=w(e,i,a)).success)break;s.push(o.ifd),a=o.nextIFD}while(a>0);var l=_(s);return r.__assign(r.__assign({},l),{littleEndian:i,ifds:s})}function w(e,t,r,i,a,s){void 0===i&&(i=0),void 0===a&&(a=o.TIFF_TAGS),void 0===s&&(s=4);var l,u=m(e,t,r,i,a,s),p=u.ifd;if(p){var c;if(o.ifdTags.forEach((function(r,n){p.has(n)&&((l=p.get(n)).data=m(e,t,l.valueOffset-i,i,r).ifd)})),p.has("GEOKEYDIRECTORY")&&(c=(l=p.get("GEOKEYDIRECTORY")).values)&&c.length>4){var d=c[0]+"."+c[1]+"."+c[2];l.data=m(e,t,l.valueOffset+6-i,i,o.GEO_KEYS,2).ifd,l.data&&l.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[d]})}p.has("XMP")&&"number"==typeof(c=(l=p.get("XMP")).values)[0]&&7===l.type&&(l.values=[n.bytesToUTF8(new Uint8Array(c))])}return u}t.parseFieldValues=v,t.getImageInfo=_,t.parseHeader=b,t.parseSignature=function(e){var t=new DataView(e,0,8),r=t.getUint16(0,!1),n=null;if(18761===r)n=!0;else{if(19789!==r)throw"unexpected endianess byte";n=!1}if(42!==t.getUint16(2,n))throw"unexpected tiff identifier";return{littleEndian:n,firstIFD:t.getUint32(4,n)}},t.parseIFD=w,t.decodeTileOrStrip=function(e,t){for(var r,n=t.headerInfo,i=t.ifd,o=g(e,n.littleEndian,i,t.offset||0,t.size||e.byteLength),a=n.pixelType,s=n.isBSQ,l=n.planes,u=d(a),p=o.length/l,c=[],f=0;f<l;f++){if(r=new u(p),s)r=o.slice(p*f,p*(f+1));else for(var h=0;h<p;h++)r[h]=o[h*l+f];c.push(r)}var m,v,_=y(i,"TILEWIDTH"),b=y(i,"TILELENGTH"),w=n.noData?n.noData[0]:null,S=n.metadata?n.metadata.statistics:null,x=S?S.map((function(e){return e.min})):null,I=S?S.map((function(e){return e.max})):null;if(null!=w)if(m=new Uint8Array(p),Math.abs(w)>1e24)for(v=0;v<p;v++)Math.abs((c[0][v]-w)/w)<1e-6?m[v]=0:m[v]=1;else for(v=0;v<p;v++)c[0][v]===w?m[v]=0:m[v]=1;else x&&I&&t.applyMinMaxConstraint&&(m=function(e,t,r){if(!(e&&e.length>0&&t&&r))return null;for(var n,i,o,a=e[0].length,s=e.length,l=new Uint8Array(a),u=0;u<s;u++)if(n=e[u],i=t[u],o=r[u],0===u)for(var p=0;p<a;p++)l[p]=n[p]<i||n[p]>o?0:1;else for(p=0;p<a;p++)l[p]&&(l[p]=n[p]<i||n[p]>o?0:1);return l}(c,x,I));return{pixelType:a,width:_,height:b,pixels:c,mask:m,noDataValue:w}},t.decode=function(e,t){var r,n,o=(t=t||b(e)).ifds,s=t.noData;if(0===o.length)throw"no valid image file directory";var l=o[0],p=s?s[0]:null;if(n=t.tileWidth?function(e,t,r){var n=h(r,"TILEOFFSETS");if(void 0===n)return null;for(var i,o,a,s,l,u,p,c,f,y,m,v,_,b=h(r,"TILEBYTECOUNTS"),w=t.tileWidth,S=t.tileHeight,x=t.width,I=t.height,R=t.pixelType,T=t.isBSQ,C=t.planes,P=x*I,L=h(r,"BITSPERSAMPLE")[0],k=d(R),M=[],O=0;O<C;O++)M.push(new k(P));var E=Math.ceil(x/w);if(L%8==0)for(i=0;i<n.length;i++)for(c=(u=Math.floor(i/E)*S)*x+(p=i%E*w),a=g(e,t.littleEndian,r,n[i],b[i]),y=0,f=c,v=Math.min(w,x-p),m=Math.min(S,I-u),o=0;o<C;o++)if(_=M[o],T)for(s=0;s<m;s++)for(f=c+s*x,y=w*S*o+s*w,l=0;l<v;l++,f++,y++)_[f]=a[y];else for(s=0;s<m;s++)for(f=c+s*x,y=s*w*C+o,l=0;l<v;l++,f++,y+=C)_[f]=a[y];return{width:x,height:I,pixelType:R,pixels:M}}(e,t,l):function(e,t,r){var n=u===t.littleEndian,o=h(r,"STRIPOFFSETS");if(void 0===o)return null;var s,l,p,c,f,y,m,g,v,_,b=t.width,w=t.height,S=t.pixelType,x=t.planes,I=b*w,R=h(r,"BITSPERSAMPLE")[0],T=d(S),C=new T(I*x),P=h(r,"STRIPBYTECOUNTS"),L=h(r,"ROWSPERSTRIP")[0],k=h(r,"COMPRESSION")?h(r,"COMPRESSION")[0]:1,M=L;if(R%8==0)for(s=0;s<o.length;s++){if(f=s*(L*b)*x,M=(s+1)*L>w?w-s*L:L,"u8"===S||"s8"===S||n){if(8===k||32946===k)m=new Uint8Array(e,o[s],P[s]),_=new a(m).getBytes(),y=new ArrayBuffer(_.length),(m=new Uint8Array(y)).set(_),m.length!==M*b*x*R/8&&console.log("strip byte counts is different than expected");else if(6===k){m=new Uint8Array(e,o[s],P[s]);var O=new i;O.parse(m);var E=O.getData(O.width,O.height,!0);y=new ArrayBuffer(E.length),(m=new Uint8Array(y)).set(E)}else 1===k&&(P[s]!==M*b*x*R/8&&console.log("strip byte counts is different than expected"),y=e.slice(o[s],o[s]+P[s]));c=new T(y)}else{switch(6===k||8===k||32946===k?(m=new Uint8Array(e,o[s],P[s]),m=new a(m).getBytes(),y=new ArrayBuffer(m.length),g=new Uint8Array(y),m.length!==M*b*x*R/8&&console.log("strip byte counts is different than expected")):1===k&&(P[s]!==M*b*x*R/8&&console.log("strip byte counts is different than expected"),y=new ArrayBuffer(P[s]),m=new Uint8Array(e,o[s],P[s]),g=new Uint8Array(y)),S){case"u16":case"s16":for(p=0;p<m.length;p+=2)g[p]=m[p+1],g[p+1]=m[p];break;case"u32":case"s32":case"f32":for(p=0;p<m.length;p+=4)g[p]=m[p+3],g[p+1]=m[p+2],g[p+2]=m[p+1],g[p+3]=m[p]}c=new T(y)}C.set(c,f)}var A=[];if(1===x)A.push(C);else for(s=0;s<x;s++){for(v=new T(I),l=0;l<I;l++)v[l]=C[l*x+s];A.push(v)}return{width:b,height:w,pixelType:S,pixels:A}}(e,t,l),null!==p){if(n.mask=new Uint8Array(n.width*n.height),Math.abs(p)>1e24)for(r=0;r<n.width*n.height;r++)Math.abs((n.pixels[0][r]-p)/p)<1e-6?n.mask[r]=0:n.mask[r]=1;else for(r=0;r<n.width*n.height;r++)n.pixels[0][r]===p?n.mask[r]=0:n.mask[r]=1;n.noDataValue=p}return n}}.apply(null,n))||(e.exports=i)},827:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.bytesToUTF8=function(e,t){for(var r=0,n="",i=0,o=0,a=e.length;r<a;)(i=(o=e[r++])>>4)<8?i=1:15===i?(i=4,o=(7&o)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++]):14===i?(i=3,o=(15&o)<<12|(63&e[r++])<<6|63&e[r++]):(i=2,o=(31&o)<<6|63&e[r++]),(0!==o||t)&&(n+=String.fromCharCode(o));return n}}.apply(null,n))||(e.exports=i)},828:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r,n=((r=[])[254]="NEWSUBFILETYPE",r[255]="SUBFILETYPE",r[256]="IMAGEWIDTH",r[257]="IMAGELENGTH",r[258]="BITSPERSAMPLE",r[259]="COMPRESSION",r[262]="PHOTOMETRICINTERPRETATION",r[263]="THRESHHOLDING",r[264]="CELLWIDTH",r[265]="CELLLENGTH",r[266]="FILLORDER",r[269]="DOCUMENTNAME",r[270]="IMAGEDESCRIPTION",r[271]="MAKE",r[272]="MODEL",r[273]="STRIPOFFSETS",r[274]="ORIENTATION",r[277]="SAMPLESPERPIXEL",r[278]="ROWSPERSTRIP",r[279]="STRIPBYTECOUNTS",r[280]="MINSAMPLEVALUE",r[281]="MAXSAMPLEVALUE",r[282]="XRESOLUTION",r[283]="YRESOLUTION",r[284]="PLANARCONFIGURATION",r[285]="PAGENAME",r[286]="XPOSITION",r[287]="YPOSITION",r[288]="FREEOFFSETS",r[289]="FREEBYTECOUNTS",r[290]="GRAYRESPONSEUNIT",r[291]="GRAYRESPONSECURVE",r[292]="T4OPTIONS",r[293]="T6OPTIONS",r[296]="RESOLUTIONUNIT",r[297]="PAGENUMBER",r[300]="COLORRESPONSEUNIT",r[301]="TRANSFERFUNCTION",r[305]="SOFTWARE",r[306]="DATETIME",r[315]="ARTIST",r[316]="HOSTCOMPUTER",r[317]="PREDICTOR",r[318]="WHITEPOINT",r[319]="PRIMARYCHROMATICITIES",r[320]="COLORMAP",r[321]="HALFTONEHINTS",r[322]="TILEWIDTH",r[323]="TILELENGTH",r[324]="TILEOFFSETS",r[325]="TILEBYTECOUNTS",r[326]="BADFAXLINES",r[327]="CLEANFAXDATA",r[328]="CONSECUTIVEBADFAXLINES",r[330]="SUBIFD",r[332]="INKSET",r[333]="INKNAMES",r[334]="NUMBEROFINKS",r[336]="DOTRANGE",r[337]="TARGETPRINTER",r[338]="EXTRASAMPLES",r[339]="SAMPLEFORMAT",r[340]="SMINSAMPLEVALUE",r[341]="SMAXSAMPLEVALUE",r[342]="TRANSFERRANGE",r[347]="JPEGTABLES",r[512]="JPEGPROC",r[513]="JPEGIFOFFSET",r[514]="JPEGIFBYTECOUNT",r[515]="JPEGRESTARTINTERVAL",r[517]="JPEGLOSSLESSPREDICTORS",r[518]="JPEGPOINTTRANSFORM",r[519]="JPEGQTABLES",r[520]="JPEGDCTABLES",r[521]="JPEGACTABLES",r[529]="YCBCRCOEFFICIENTS",r[530]="YCBCRSUBSAMPLING",r[531]="YCBCRPOSITIONING",r[532]="REFERENCEBLACKWHITE",r[700]="XMP",r[33550]="GEOPIXELSCALE",r[33922]="GEOTIEPOINTS",r[33432]="COPYRIGHT",r[42112]="GDAL_METADATA",r[42113]="GDAL_NODATA",r[50844]="RPCCOEFFICIENT",r[34264]="GEOTRANSMATRIX",r[34735]="GEOKEYDIRECTORY",r[34736]="GEODOUBLEPARAMS",r[34737]="GEOASCIIPARAMS",r[34665]="EXIFIFD",r[34853]="GPSIFD",r[40965]="INTEROPERABILITYIFD",r),i=function(){var e=[].concat(n);return e[36864]="ExifVersion",e[40960]="FlashpixVersion",e[40961]="ColorSpace",e[42240]="Gamma",e[37121]="ComponentsConfiguration",e[37122]="CompressedBitsPerPixel",e[40962]="PixelXDimension",e[40963]="PixelYDimension",e[37500]="MakerNote",e[37510]="UserComment",e[40964]="RelatedSoundFile",e[36867]="DateTimeOriginal",e[36868]="DateTimeDigitized",e[36880]="OffsetTime",e[36881]="OffsetTimeOriginal",e[36882]="OffsetTimeDigitized",e[37520]="SubSecTime",e[37521]="SubSecTimeOriginal",e[37522]="SubSecTimeDigitized",e[37888]="Temperature",e[37889]="Humidity",e[37890]="Pressure",e[37891]="WaterDepth",e[37892]="Acceleration",e[37893]="CameraElevationAngle",e[42016]="ImageUniqueID",e[42032]="CameraOwnerName",e[42033]="BodySerialNumber",e[42034]="LensSpecification",e[42035]="LensMake",e[42036]="LensModel",e[42037]="LensSerialNumber",e[33434]="ExposureTime",e[33437]="FNumber",e[34850]="ExposureProgram",e[34852]="SpectralSensitivity",e[34855]="PhotographicSensitivity",e[34856]="OECF",e[34864]="SensitivityType",e[34865]="StandardOutputSensitivity",e[34866]="RecommendedExposureIndex",e[34867]="ISOSpeed",e[34868]="ISOSpeedLatitudeyyy",e[34869]="ISOSpeedLatitudezzz",e[37377]="ShutterSpeedValue",e[37378]="ApertureValue",e[37379]="BrightnessValue",e[37380]="ExposureBiasValue",e[37381]="MaxApertureValue",e[37382]="SubjectDistance",e[37383]="MeteringMode",e[37384]="LightSource",e[37385]="Flash",e[37386]="FocalLength",e[37396]="SubjectArea",e[41483]="FlashEnergy",e[41484]="SpatialFrequencyResponse",e[41486]="FocalPlaneXResolution",e[41487]="FocalPlaneYResolution",e[41488]="FocalPlaneResolutionUnit",e[41492]="SubjectLocation",e[41493]="ExposureIndex",e[41495]="SensingMethod",e[41728]="FileSource",e[41729]="SceneType",e[41730]="CFAPattern",e[41985]="CustomRendered",e[41986]="ExposureMode",e[41987]="WhiteBalance",e[41988]="DigitalZoomRatio",e[41989]="FocalLengthIn35mmFilm",e[41990]="SceneCaptureType",e[41991]="GainControl",e[41992]="Contrast",e[41993]="Saturation",e[41994]="Sharpness",e[41995]="DeviceSettingDescription",e[41996]="SubjectDistanceRange",e}(),o=function(){var e=[];return e[1024]="GTModelTypeGeoKey",e[1025]="GTRasterTypeGeoKey",e[1026]="GTCitationGeoKey",e[2048]="GeographicTypeGeoKey",e[2049]="GeogCitationGeoKey",e[2050]="GeogGeodeticDatumGeoKey",e[2051]="GeogPrimeMeridianGeoKey",e[2052]="GeogLinearUnitsGeoKey",e[2053]="GeogLinearUnitSizeGeoKey",e[2054]="GeogAngularUnitsGeoKey",e[2055]="GeogAngularUnitSizeGeoKey",e[2056]="GeogEllipsoidGeoKey",e[2057]="GeogSemiMajorAxisGeoKey",e[2058]="GeogSemiMinorAxisGeoKey",e[2059]="GeogInvFlatteningGeoKey",e[2061]="GeogPrimeMeridianLongGeoKey",e[2060]="GeogAzimuthUnitsGeoKey",e[3072]="ProjectedCSTypeGeoKey",e[3073]="PCSCitationGeoKey",e[3074]="ProjectionGeoKey",e[3075]="ProjCoordTransGeoKey",e[3076]="ProjLinearUnitsGeoKey",e[3077]="ProjLinearUnitSizeGeoKey",e[3078]="ProjStdParallel1GeoKey",e[3079]="ProjStdParallel2GeoKey",e[3080]="ProjNatOriginLongGeoKey",e[3081]="ProjNatOriginLatGeoKey",e[3082]="ProjFalseEastingGeoKey",e[3083]="ProjFalseNorthingGeoKey",e[3084]="ProjFalseOriginLongGeoKey",e[3085]="ProjFalseOriginLatGeoKey",e[3086]="ProjFalseOriginEastingGeoKey",e[3087]="ProjFalseOriginNorthingGeoKey",e[3088]="ProjCenterLongGeoKey",e[3090]="ProjCenterEastingGeoKey",e[3091]="ProjCenterNorthingGeoKey",e[3092]="ProjScaleAtNatOriginGeoKey",e[3093]="ProjScaleAtCenterGeoKey",e[3094]="ProjAzimuthAngleGeoKey",e[3095]="ProjStraightVertPoleLongGeoKey",e[4096]="VerticalCSTypeGeoKey",e[4097]="VerticalCitationGeoKey",e[4098]="VerticalDatumGeoKey",e[4099]="VerticalUnitsGeoKey",e}(),a=new Map;return a.set("EXIFIFD",i),a.set("GPSIFD",["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"]),{TIFF_TAGS:n,ifdTags:a,GEO_KEYS:o,getTagName:function(e,t){var r=(t||n)[e];return void 0===r&&(r="unknown"+String(e)),r}}}.apply(null,n))||(e.exports=i)},829:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(172),r(695),r(314)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.processAttachmentQueryResult=function(e,t){for(var r={},n=0,a=e;n<a.length;n++)for(var s=a[n],l=s.parentObjectId,u=s.parentGlobalId,p=0,c=s.attachmentInfos;p<c.length;p++){var d=c[p],f=d.id,h=i.addProxy(i.addTokenParameter(t+"/"+l+"/attachments/"+f)),y=o.fromJSON(d);y.set({url:h,parentObjectId:l,parentGlobalId:u}),r[l]?r[l].push(y):r[l]=[y]}return r},t.executeAttachmentQuery=function(e,t,i){var o={query:a.mapParameters(r.__assign(r.__assign(r.__assign({},e.query),{f:"json"}),function(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}(t)))};return i&&(o=r.__assign(r.__assign({},i),o)),n(e.path+"/queryAttachments",o)}}.apply(null,n))||(e.exports=i)},979:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(151),r(980),r(461)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.colormapInfos=null,r.type="raster-colormap",r}var n;return r.__extends(t,e),n=t,t.createFromColormap=function(e,t){if(!e)return null;function r(e){return t?t[e]||"":String(e[0])}var i=5===e[0].length,a=e.sort((function(e){return e[0][0]-e[1][0]})),s=i?a.map((function(e){return o.fromJSON({value:e[0],color:e.slice(1,5),label:r(e[0])})})):a.map((function(e){return o.fromJSON({value:e[0],color:e.slice(1,4).concat([255]),label:r(e[0])})}));return new n({colormapInfos:s})},t.createFromColorramp=function(e){var t=a.convertColorRampToColormap(e,256);return n.createFromColormap(t)},t.prototype.clone=function(){return new n({colormapInfos:this.colormapInfos.map((function(e){return e.toJSON()}))})},t.prototype.extractColormap=function(){return this.colormapInfos.map((function(e){return[e.value,e.color.r,e.color.g,e.color.b,e.color.a>1?e.color.a:255*e.color.a&255]})).sort((function(e,t){return e[0]-t[0]}))},r.__decorate([i.property({type:[o],json:{write:!0}})],t.prototype,"colormapInfos",void 0),r.__decorate([i.enumeration({rasterColormap:"raster-colormap"})],t.prototype,"type",void 0),n=r.__decorate([i.subclass("esri.renderers.RasterColormapRenderer")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},980:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(182),r(155),r(151)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.label=null,t.color=null,t}return r.__extends(t,e),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"value",void 0),r.__decorate([o.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),r.__decorate([o.property({type:n,json:{write:!0}})],t.prototype,"color",void 0),r.__decorate([o.subclass("esri.renderers.support.ColormapInfo")],t)}(i.JSONSupport)}.apply(null,n))||(e.exports=i)},981:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(118),r(151),r(578)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.altitude=45,r.azimuth=315,r.colorRamp=null,r.hillshadeType="multi-directional",r.pixelSizePower=.664,r.pixelSizeFactor=.024,r.scalingType="none",r.type="raster-shaded-relief",r.zFactor=1,r}var n;return r.__extends(t,e),n=t,t.prototype.readColorRamp=function(e){return a.fromJSON(e)},t.prototype.clone=function(){return new n({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:i.clone(this.colorRamp)})},r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"altitude",void 0),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"azimuth",void 0),r.__decorate([o.property({types:a.types,json:{write:!0}})],t.prototype,"colorRamp",void 0),r.__decorate([o.reader("colorRamp")],t.prototype,"readColorRamp",null),r.__decorate([o.property({type:["traditional","multi-directional"],json:{write:!0}})],t.prototype,"hillshadeType",void 0),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"pixelSizePower",void 0),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"pixelSizeFactor",void 0),r.__decorate([o.property({type:["none","adjusted"],json:{write:!0}})],t.prototype,"scalingType",void 0),r.__decorate([o.enumeration({rasterShadedRelief:"raster-shaded-relief"})],t.prototype,"type",void 0),r.__decorate([o.property({type:Number,json:{write:!0}})],t.prototype,"zFactor",void 0),n=r.__decorate([o.subclass("esri.renderers.RasterShadedReliefRenderer")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},982:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(155),r(118),r(151),r(549),r(578)],void 0===(i=function(e,t,r,n,i,o,a,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.colorRamp=null,r.computeGamma=!1,r.dynamicRangeAdjustment=!1,r.gamma=[],r.maxPercent=null,r.minPercent=null,r.numberOfStandardDeviations=null,r.outputMax=null,r.outputMin=null,r.sigmoidStrengthLevel=null,r.statistics=[],r.histograms=null,r.useGamma=!1,r.stretchType="none",r.type="raster-stretch",r}var n;return r.__extends(t,e),n=t,t.prototype.readColorRamp=function(e){if(e)return s.fromJSON(e)},t.prototype.writeStatistics=function(e,t,r){null==e||0===e.length?e=null:e[0]instanceof Array||(e=e.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),t[r]=e},t.prototype.readStretchType=function(e,t){var r=t.stretchType;return"number"==typeof r&&(r=a.stretchTypeFunctionEnum[r]),a.stretchTypeJSONDict.read(r)},t.prototype.clone=function(){return new n({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:i.clone(this.statistics),gamma:i.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:i.clone(this.colorRamp),histograms:i.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})},r.__decorate([o.property({types:s.types,json:{write:!0}})],t.prototype,"colorRamp",void 0),r.__decorate([o.reader("colorRamp")],t.prototype,"readColorRamp",null),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"computeGamma",void 0),r.__decorate([o.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],t.prototype,"dynamicRangeAdjustment",void 0),r.__decorate([o.property({type:[Number],json:{write:{allowNull:!0}}})],t.prototype,"gamma",void 0),r.__decorate([o.property({type:Number,json:{write:{allowNull:!0}}})],t.prototype,"maxPercent",void 0),r.__decorate([o.property({type:Number,json:{write:{allowNull:!0}}})],t.prototype,"minPercent",void 0),r.__decorate([o.property({type:Number,json:{write:{allowNull:!0}}})],t.prototype,"numberOfStandardDeviations",void 0),r.__decorate([o.property({type:Number,json:{read:{source:"max"},write:{target:"max",allowNull:!0}}})],t.prototype,"outputMax",void 0),r.__decorate([o.property({type:Number,json:{read:{source:"min"},write:{target:"min",allowNull:!0}}})],t.prototype,"outputMin",void 0),r.__decorate([o.property({type:Number,json:{write:{allowNull:!0}}})],t.prototype,"sigmoidStrengthLevel",void 0),r.__decorate([o.property({json:{write:{allowNull:!0}}})],t.prototype,"statistics",void 0),r.__decorate([o.property()],t.prototype,"histograms",void 0),r.__decorate([o.writer("statistics")],t.prototype,"writeStatistics",null),r.__decorate([o.property({type:Boolean,json:{write:!0}})],t.prototype,"useGamma",void 0),r.__decorate([o.property({type:a.stretchTypeJSONDict.apiValues,json:{type:a.stretchTypeJSONDict.jsonValues,write:a.stretchTypeJSONDict.write}})],t.prototype,"stretchType",void 0),r.__decorate([o.reader("stretchType",["stretchType"])],t.prototype,"readStretchType",null),r.__decorate([o.enumeration({rasterStretch:"raster-stretch"})],t.prototype,"type",void 0),n=r.__decorate([o.subclass("esri.renderers.RasterStretchRenderer")],t)}(n.JSONSupport)}.apply(null,n))||(e.exports=i)},983:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(154),r(153),r(153),r(462)],void 0===(i=function(e,t,r,n,i,o){return function(){function e(e){e&&(this.canvas=e.canvas,this.ctx=e.ctx||e.canvas&&e.canvas.getContext("2d"))}return e.getFormat=function(e){if(!e||e.byteLength<10)return"";var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="jpeg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&(r="png"),r},e.prototype.decode=function(t,o,a){var s=this;if(!t||t.byteLength<10)throw new r("imagecanvasdecoder: decode","required a valid encoded data as input.");var l=e.getFormat(t);if(""===l)throw new r("imagecanvasdecoder: decode","encoded data format is not a supported format (jpeg or png).");var u=o.width,p=o.height,c=o.applyJpegMask;if(c&&(!u||!p))throw new r("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return n.create((function(r,d){var f=null;"jpeg"===l&&c&&(f=e.getMask(t,o));var h,y=new Blob([new Uint8Array(t)],{type:"image/"+l}),m=URL.createObjectURL(y),g=new Image;g.src=m,g.onload=function(){if(URL.revokeObjectURL(m),n.isAborted(a))d(i.createAbortError());else{u=g.width,p=g.height,s.canvas?(s.canvas.width===u&&s.canvas.height===p||(s.canvas.width=u,s.canvas.height=p),s.ctx.clearRect(0,0,u,p)):(s.canvas=document.createElement("canvas"),s.canvas.width=u,s.canvas.height=p,s.ctx=s.canvas.getContext("2d")),s.ctx.drawImage(g,0,0);var e,t=s.ctx.getImageData(0,0,u,p);if(h=t.data,o.renderOnCanvas){if(f)for(e=0;e<f.length;e++)f[e]?h[4*e+3]=255:h[4*e+3]=0;return s.ctx.putImageData(t,0,0),void r(null)}var l=u*p,c=new Uint8Array(l),y=new Uint8Array(l),v=new Uint8Array(l);if(f)for(e=0;e<l;e++)c[e]=h[4*e],y[e]=h[4*e+1],v[e]=h[4*e+2];else for(f=new Uint8Array(l),e=0;e<l;e++)c[e]=h[4*e],y[e]=h[4*e+1],v[e]=h[4*e+2],f[e]=h[4*e+3];r({width:u,height:p,pixels:[c,y,v],mask:f,pixelType:"u8"})}},g.onerror=function(){URL.revokeObjectURL(m),d("cannot load image")}}))},e.getMask=function(e,t){var r=null;try{var n=new Uint8Array(e),i=Math.ceil(n.length/2),a=0,s=n.length-2;for(a=i;a<s&&(255!==n[a]||217!==n[a+1]);a++);if((a+=2)<n.length-1){var l=new o(n.subarray(a)).getBytes();r=new Uint8Array(t.width*t.height);for(var u=0,p=0;p<l.length;p++)for(var c=7;c>=0;c--)r[u++]=l[p]>>c&1}}catch(e){}return r},e}()}.apply(null,n))||(e.exports=i)},984:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(691),r(462)],void 0===(i=function(e,t,r,n){return function(){function e(){}return e.decode=function(e){var t=new Uint8Array(e),i=new r;i.parse(t);var o,a=i.width,s=i.height,l=i.numComponents,u=i.eof,p=i.getData(a,s,!0),c=a*s,d=0,f=0,h=0;if(u<t.length-1){var y=new n(t.subarray(u)).getBytes();o=new Uint8Array(c);var m=0;for(d=0;d<y.length;d++)for(h=7;h>=0;h--)o[m++]=y[d]>>h&1}var g,v=null;if(1===l)v=[p,p,p];else{for(v=[],d=0;d<3;d++)g=new Uint8Array(c),v.push(g);for(h=0,f=0;f<c;f++)for(d=0;d<3;d++)v[d][f]=p[h++]}return{width:a,height:s,pixels:v,mask:o}},e}()}.apply(null,n))||(e.exports=i)},985:function(e,t,r){var n;void 0===(n=function(){"use strict";var e=function(e,t,r,n,i,o,a,s){var l,u,p,c,d,f=(1<<r)-1,h=0,y=0,m=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*m,i)for(l=0;l<n;l++)0===y&&(p=e[h++],y=32),y>=r?(u=p>>>y-r&f,y-=r):(u=(p&f)<<(c=r-y)&f,u+=(p=e[h++])>>>(y=32-c)),t[l]=i[u];else for(d=Math.ceil((s-o)/a),l=0;l<n;l++)0===y&&(p=e[h++],y=32),y>=r?(u=p>>>y-r&f,y-=r):(u=(p&f)<<(c=r-y)&f,u+=(p=e[h++])>>>(y=32-c)),t[l]=u<d?o+u*a:s},t=function(e,t,r,n,i,o,a,s){var l,u,p,c,d=(1<<r)-1,f=0,h=0,y=0;if(i)for(l=0;l<n;l++)0===h&&(p=e[f++],h=32,y=0),h>=r?(u=p>>>y&d,h-=r,y+=r):(u=p>>>y&d,h=32-(c=r-h),u|=((p=e[f++])&(1<<c)-1)<<r-c,y=c),t[l]=i[u];else{var m=Math.ceil((s-o)/a);for(l=0;l<n;l++)0===h&&(p=e[f++],h=32,y=0),h>=r?(u=p>>>y&d,h-=r,y+=r):(u=p>>>y&d,h=32-(c=r-h),u|=((p=e[f++])&(1<<c)-1)<<r-c,y=c),t[l]=u<m?o+u*a:s}return t},r={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,i=Math.floor(n/2),o=0;i;){var a=i>=359?359:i;i-=a;do{t+=e[o++]<<8,r+=t+=e[o++]}while(--a);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[o]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),i={};if(i.fileIdentifierString=String.fromCharCode.apply(null,n),0!==i.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+i.fileIdentifierString;r+=6;var o,a=new DataView(e,r,8),s=a.getInt32(0,!0);if(i.fileVersion=s,r+=4,s>=3&&(i.checksum=a.getUint32(4,!0),r+=4),a=new DataView(e,r,12),i.height=a.getUint32(0,!0),i.width=a.getUint32(4,!0),r+=8,s>=4?(i.numDims=a.getUint32(8,!0),r+=4):i.numDims=1,a=new DataView(e,r,40),i.numValidPixel=a.getUint32(0,!0),i.microBlockSize=a.getInt32(4,!0),i.blobSize=a.getInt32(8,!0),i.imageType=a.getInt32(12,!0),i.maxZError=a.getFloat64(16,!0),i.zMin=a.getFloat64(24,!0),i.zMax=a.getFloat64(32,!0),r+=40,t.headerInfo=i,t.ptr=r,s>=3&&(o=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-o,i.blobSize-14))!==i.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),i=r.numDims*this.getDataTypeSize(r.imageType),o=this.readSubArray(e,t.ptr,n,i),a=this.readSubArray(e,t.ptr+i,n,i);t.ptr+=2*i;var s,l=!0;for(s=0;s<r.numDims;s++)if(o[s]!==a[s]){l=!1;break}return r.minValues=o,r.maxValues=a,l},readSubArray:function(e,t,r,n){var i;if(r===Uint8Array)i=new Uint8Array(e,t,n);else{var o=new ArrayBuffer(n);new Uint8Array(o).set(new Uint8Array(e,t,n)),i=new r(o)}return i},readMask:function(e,t){var r,n,i=t.ptr,o=t.headerInfo,a=o.width*o.height,s=o.numValidPixel,l=new DataView(e,i,4),u={};if(u.numBytes=l.getUint32(0,!0),i+=4,(0===s||a===s)&&0!==u.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(a/8)),u.bitset=r,n=new Uint8Array(a),t.pixels.resultMask=n,i+=u.numBytes;else if(u.numBytes>0){r=new Uint8Array(Math.ceil(a/8));var p=(l=new DataView(e,i,u.numBytes)).getInt16(0,!0),c=2,d=0,f=0;do{if(p>0)for(;p--;)r[d++]=l.getUint8(c++);else for(f=l.getUint8(c++),p=-p;p--;)r[d++]=f;p=l.getInt16(c,!0),c+=2}while(c<u.numBytes);if(-32768!==p||d<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(a);var h=0,y=0;for(y=0;y<a;y++)7&y?(h=r[y>>3],h<<=7&y):h=r[y>>3],128&h&&(n[y]=1);t.pixels.resultMask=n,u.bitset=r,i+=u.numBytes}return t.ptr=i,t.mask=u,!0},readDataOneSweep:function(e,t,n){var i,o=t.ptr,a=t.headerInfo,s=a.numDims,l=a.width*a.height,u=a.imageType,p=a.numValidPixel*r.getDataTypeSize(u)*s,c=t.pixels.resultMask;if(n===Uint8Array)i=new Uint8Array(e,o,p);else{var d=new ArrayBuffer(p);new Uint8Array(d).set(new Uint8Array(e,o,p)),i=new n(d)}if(i.length===l*s)t.pixels.resultPixels=i;else{t.pixels.resultPixels=new n(l*s);var f=0,h=0,y=0,m=0;if(s>1)for(y=0;y<s;y++)for(m=y*l,h=0;h<l;h++)c[h]&&(t.pixels.resultPixels[m+h]=i[f++]);else for(h=0;h<l;h++)c[h]&&(t.pixels.resultPixels[h]=i[f++])}return o+=p,t.ptr=o,!0},readHuffmanTree:function(e,t){var i=this.HUFFMAN_LUT_BITS_MAX,o=new DataView(e,t.ptr,16);if(t.ptr+=16,o.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=o.getInt32(4,!0),s=o.getInt32(8,!0),l=o.getInt32(12,!0);if(s>=l)return!1;var u=new Uint32Array(l-s);r.decodeBits(e,t,u);var p,c,d,f,h=[];for(p=s;p<l;p++)h[c=p-(p<a?0:a)]={first:u[p-s],second:null};var y=e.byteLength-t.ptr,m=Math.ceil(y/4),g=new ArrayBuffer(4*m);new Uint8Array(g).set(new Uint8Array(e,t.ptr,y));var v,_=new Uint32Array(g),b=0,w=0;for(v=_[0],p=s;p<l;p++)(f=h[c=p-(p<a?0:a)].first)>0&&(h[c].second=v<<b>>>32-f,32-b>=f?32===(b+=f)&&(b=0,v=_[++w]):(b+=f-32,v=_[++w],h[c].second|=v>>>32-b));var S,x=0,I=new n;for(p=0;p<h.length;p++)void 0!==h[p]&&(x=Math.max(x,h[p].first));S=x>=i?i:x;var R,T,C,P,L,k=[];for(p=s;p<l;p++)if((f=h[c=p-(p<a?0:a)].first)>0)if(R=[f,c],f<=S)for(T=h[c].second<<S-f,C=1<<S-f,d=0;d<C;d++)k[T|d]=R;else for(T=h[c].second,L=I,P=f-1;P>=0;P--)T>>>P&1?(L.right||(L.right=new n),L=L.right):(L.left||(L.left=new n),L=L.left),0!==P||L.val||(L.val=R[1]);return{decodeLut:k,numBitsLUTQick:S,numBitsLUT:x,tree:I,stuffedData:_,srcPtr:w,bitPos:b}},readHuffman:function(e,t,r){var n,i,o,a,s,l,u,p,c,d=t.headerInfo,f=d.numDims,h=t.headerInfo.height,y=t.headerInfo.width,m=y*h,g=this.readHuffmanTree(e,t),v=g.decodeLut,_=g.tree,b=g.stuffedData,w=g.srcPtr,S=g.bitPos,x=g.numBitsLUTQick,I=g.numBitsLUT,R=0===t.headerInfo.imageType?128:0,T=t.pixels.resultMask,C=0;S>0&&(w++,S=0);var P,L=b[w],k=1===t.encodeMode,M=new r(m*f),O=M;for(P=0;P<d.numDims;P++){if(f>1&&(O=new r(M.buffer,m*P,m),C=0),t.headerInfo.numValidPixel===y*h)for(p=0,l=0;l<h;l++)for(u=0;u<y;u++,p++){if(i=0,s=a=L<<S>>>32-x,32-S<x&&(s=a|=b[w+1]>>>64-S-x),v[s])i=v[s][1],S+=v[s][0];else for(s=a=L<<S>>>32-I,32-S<I&&(s=a|=b[w+1]>>>64-S-I),n=_,c=0;c<I;c++)if(!(n=a>>>I-c-1&1?n.right:n.left).left&&!n.right){i=n.val,S=S+c+1;break}S>=32&&(S-=32,L=b[++w]),o=i-R,k?(o+=u>0?C:l>0?O[p-y]:C,o&=255,O[p]=o,C=o):O[p]=o}else for(p=0,l=0;l<h;l++)for(u=0;u<y;u++,p++)if(T[p]){if(i=0,s=a=L<<S>>>32-x,32-S<x&&(s=a|=b[w+1]>>>64-S-x),v[s])i=v[s][1],S+=v[s][0];else for(s=a=L<<S>>>32-I,32-S<I&&(s=a|=b[w+1]>>>64-S-I),n=_,c=0;c<I;c++)if(!(n=a>>>I-c-1&1?n.right:n.left).left&&!n.right){i=n.val,S=S+c+1;break}S>=32&&(S-=32,L=b[++w]),o=i-R,k?(u>0&&T[p-1]?o+=C:l>0&&T[p-y]?o+=O[p-y]:o+=C,o&=255,O[p]=o,C=o):O[p]=o}t.ptr=t.ptr+4*(w+1)+(S>0?4:0)}t.pixels.resultPixels=M},decodeBits:function(r,n,i,o,a){var s=n.headerInfo,l=s.fileVersion,u=0,p=r.byteLength-n.ptr>=5?5:r.byteLength-n.ptr,c=new DataView(r,n.ptr,p),d=c.getUint8(0);u++;var f=d>>6,h=0===f?4:3-f,y=(32&d)>0,m=31&d,g=0;if(1===h)g=c.getUint8(u),u++;else if(2===h)g=c.getUint16(u,!0),u+=2;else{if(4!==h)throw"Invalid valid pixel count type";g=c.getUint32(u,!0),u+=4}var v,_,b,w,S,x,I,R,T,C=2*s.maxZError,P=s.numDims>1?s.maxValues[a]:s.zMax;if(y){for(n.counter.lut++,R=c.getUint8(u),u++,w=Math.ceil((R-1)*m/8),S=Math.ceil(w/4),_=new ArrayBuffer(4*S),b=new Uint8Array(_),n.ptr+=u,b.set(new Uint8Array(r,n.ptr,w)),I=new Uint32Array(_),n.ptr+=w,T=0;R-1>>>T;)T++;w=Math.ceil(g*T/8),S=Math.ceil(w/4),_=new ArrayBuffer(4*S),(b=new Uint8Array(_)).set(new Uint8Array(r,n.ptr,w)),v=new Uint32Array(_),n.ptr+=w,x=l>=3?function(e,t,r,n,i,o){var a,s=(1<<t)-1,l=0,u=0,p=0,c=0,d=0,f=0,h=[],y=Math.ceil((o-n)/i);for(u=0;u<r;u++)0===c&&(a=e[l++],c=32,f=0),c>=t?(d=a>>>f&s,c-=t,f+=t):(d=a>>>f&s,c=32-(p=t-c),d|=((a=e[l++])&(1<<p)-1)<<t-p,f=p),h[u]=d<y?n+d*i:o;return h.unshift(n),h}(I,m,R-1,o,C,P):function(e,t,r,n,i,o){var a,s=(1<<t)-1,l=0,u=0,p=0,c=0,d=0,f=[],h=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*h;var y=Math.ceil((o-n)/i);for(u=0;u<r;u++)0===c&&(a=e[l++],c=32),c>=t?(d=a>>>c-t&s,c-=t):(d=(a&s)<<(p=t-c)&s,d+=(a=e[l++])>>>(c=32-p)),f[u]=d<y?n+d*i:o;return f.unshift(n),f}(I,m,R-1,o,C,P),l>=3?t(v,i,T,g,x):e(v,i,T,g,x)}else n.counter.bitstuffer++,T=m,n.ptr+=u,T>0&&(w=Math.ceil(g*T/8),S=Math.ceil(w/4),_=new ArrayBuffer(4*S),(b=new Uint8Array(_)).set(new Uint8Array(r,n.ptr,w)),v=new Uint32Array(_),n.ptr+=w,l>=3?null==o?function(e,t,r,n){var i,o,a,s,l=(1<<r)-1,u=0,p=0,c=0;for(i=0;i<n;i++)0===p&&(a=e[u++],p=32,c=0),p>=r?(o=a>>>c&l,p-=r,c+=r):(o=a>>>c&l,p=32-(s=r-p),o|=((a=e[u++])&(1<<s)-1)<<r-s,c=s),t[i]=o}(v,i,T,g):t(v,i,T,g,!1,o,C,P):null==o?function(e,t,r,n){var i,o,a,s,l=(1<<r)-1,u=0,p=0,c=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*c,i=0;i<n;i++)0===p&&(a=e[u++],p=32),p>=r?(o=a>>>p-r&l,p-=r):(o=(a&l)<<(s=r-p)&l,o+=(a=e[u++])>>>(p=32-s)),t[i]=o}(v,i,T,g):e(v,i,T,g,!1,o,C,P))},readTiles:function(e,t,n){var i=t.headerInfo,o=i.width,a=i.height,s=i.microBlockSize,l=i.imageType,u=r.getDataTypeSize(l),p=Math.ceil(o/s),c=Math.ceil(a/s);t.pixels.numBlocksY=c,t.pixels.numBlocksX=p,t.pixels.ptr=0;var d,f,h,y,m,g,v,_,b,w,S=0,x=0,I=0,R=0,T=0,C=0,P=0,L=0,k=0,M=0,O=0,E=0,A=0,D=0,N=0,F=new n(s*s),j=a%s||s,V=o%s||s,U=i.numDims,B=t.pixels.resultMask,G=t.pixels.resultPixels,z=i.fileVersion>=5?14:15,J=i.zMax;for(I=0;I<c;I++)for(T=I!==c-1?s:j,R=0;R<p;R++)for(M=I*o*s+R*s,O=o-(C=R!==p-1?s:V),_=0;_<U;_++){if(U>1?(w=G,M=I*o*s+R*s,G=new n(t.pixels.resultPixels.buffer,o*a*_*u,o*a),J=i.maxValues[_]):w=null,P=e.byteLength-t.ptr,f={},N=0,L=(d=new DataView(e,t.ptr,Math.min(10,P))).getUint8(0),N++,b=i.fileVersion>=5?4&L:0,k=L>>6&255,(L>>2&z)!=(R*s>>3&z))throw"integrity issue";if(b&&0===_)throw"integrity issue";if((m=3&L)>3)throw t.ptr+=N,"Invalid block encoding ("+m+")";if(2!==m)if(0===m){if(b)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=N,E=(E=T*C*u)<(A=e.byteLength-t.ptr)?E:A,h=new ArrayBuffer(E%u==0?E:E+u-E%u),new Uint8Array(h).set(new Uint8Array(e,t.ptr,E)),y=new n(h),D=0,B)for(S=0;S<T;S++){for(x=0;x<C;x++)B[M]&&(G[M]=y[D++]),M++;M+=O}else for(S=0;S<T;S++){for(x=0;x<C;x++)G[M++]=y[D++];M+=O}t.ptr+=D*u}else if(g=r.getDataTypeUsed(b&&l<6?4:l,k),v=r.getOnePixel(f,N,g,d),N+=r.getDataTypeSize(g),3===m)if(t.ptr+=N,t.counter.constantoffset++,B)for(S=0;S<T;S++){for(x=0;x<C;x++)B[M]&&(G[M]=b?Math.min(J,w[M]+v):v),M++;M+=O}else for(S=0;S<T;S++){for(x=0;x<C;x++)G[M]=b?Math.min(J,w[M]+v):v,M++;M+=O}else if(t.ptr+=N,r.decodeBits(e,t,F,v,_),N=0,b)if(B)for(S=0;S<T;S++){for(x=0;x<C;x++)B[M]&&(G[M]=F[N++]+w[M]),M++;M+=O}else for(S=0;S<T;S++){for(x=0;x<C;x++)G[M]=F[N++]+w[M],M++;M+=O}else if(B)for(S=0;S<T;S++){for(x=0;x<C;x++)B[M]&&(G[M]=F[N++]),M++;M+=O}else for(S=0;S<T;S++){for(x=0;x<C;x++)G[M++]=F[N++];M+=O}else{if(b)if(B)for(S=0;S<T;S++)for(x=0;x<C;x++)B[M]&&(G[M]=w[M]),M++;else for(S=0;S<T;S++)for(x=0;x<C;x++)G[M]=w[M],M++;t.counter.constant++,t.ptr+=N}}},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:r.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e){var t=e.headerInfo.zMax,r=e.headerInfo.numDims,n=e.headerInfo.height*e.headerInfo.width,i=0,o=0,a=0,s=e.pixels.resultMask,l=e.pixels.resultPixels;if(s)if(r>1)for(i=0;i<r;i++)for(a=i*n,t=e.headerInfo.maxValues[i],o=0;o<n;o++)s[o]&&(l[a+o]=t);else for(o=0;o<n;o++)s[o]&&(l[o]=t);else if(r>1)for(i=0;i<r;i++)for(a=i*n,t=e.headerInfo.maxValues[i],o=0;o<n;o++)l[a+o]=t;else for(o=0;o<n;o++)l[o]=t},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=5e-324&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var i=0;switch(r){case 0:i=n.getInt8(t);break;case 1:i=n.getUint8(t);break;case 2:i=n.getInt16(t,!0);break;case 3:i=n.getUint16(t,!0);break;case 4:i=n.getInt32(t,!0);break;case 5:i=n.getUInt32(t,!0);break;case 6:i=n.getFloat32(t,!0);break;case 7:i=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return i}},n=function(e,t,r){this.val=e,this.left=t,this.right=r};return{decode:function(e,t){var n=(t=t||{}).noDataValue,i=0,o={};if(o.ptr=t.inputOffset||0,o.pixels={},r.readHeaderInfo(e,o)){var a=o.headerInfo,s=a.fileVersion,l=r.getDataTypeArray(a.imageType);if(s>5)throw"unsupported lerc version 2."+s;r.readMask(e,o),a.numValidPixel===a.width*a.height||o.pixels.resultMask||(o.pixels.resultMask=t.maskData);var u,p=a.width*a.height;if(o.pixels.resultPixels=new l(p*a.numDims),o.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==a.numValidPixel)if(a.zMax===a.zMin)r.constructConstantSurface(o);else if(s>=4&&r.checkMinMaxRanges(e,o))r.constructConstantSurface(o);else{var c=new DataView(e,o.ptr,2),d=c.getUint8(0);if(o.ptr++,d)r.readDataOneSweep(e,o,l);else if(s>1&&a.imageType<=1&&Math.abs(a.maxZError-.5)<1e-5){var f=c.getUint8(1);if(o.ptr++,o.encodeMode=f,f>2||s<4&&f>1)throw"Invalid Huffman flag "+f;f?r.readHuffman(e,o,l):r.readTiles(e,o,l)}else r.readTiles(e,o,l)}o.eofOffset=o.ptr,t.inputOffset?(u=o.headerInfo.blobSize+t.inputOffset-o.ptr,Math.abs(u)>=1&&(o.eofOffset=t.inputOffset+o.headerInfo.blobSize)):(u=o.headerInfo.blobSize-o.ptr,Math.abs(u)>=1&&(o.eofOffset=o.headerInfo.blobSize));var h={width:a.width,height:a.height,pixelData:o.pixels.resultPixels,minValue:a.zMin,maxValue:a.zMax,validPixelCount:a.numValidPixel,dimCount:a.numDims,dimStats:{minValues:a.minValues,maxValues:a.maxValues},maskData:o.pixels.resultMask};if(o.pixels.resultMask&&r.isValidPixelValue(a.imageType,n)){var y=o.pixels.resultMask;for(i=0;i<p;i++)y[i]||(h.pixelData[i]=n);h.noDataValue=n}return o.noDataValue=n,t.returnFileInfo&&(h.fileInfo=r.formatFileInfo(o)),h}},getBandCount:function(e){for(var t=0,n=0,i={ptr:0,pixels:{}};n<e.byteLength-58;)r.readHeaderInfo(e,i),n+=i.headerInfo.blobSize,t++,i.ptr=n;return t}}}.apply(null,[]))||(e.exports=n)},986:function(e,t,r){var n,i;n=[r(462)],void 0===(i=function(e){return function(t){var r,n,i;function o(e){var t,r,n,i,o,a,s,l,u,p,c,d,f;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),n=this.readUInt16()||100,o.delay=1e3*i/n,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=o?o.data:void 0)||this.imgData,c=0;0<=t?c<t:c>t;0<=t?++c:--c)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(u=255-this.transparency.indexed.length)>0)for(d=0;0<=u?d<u:d>u;0<=u?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":a=(p=this.read(t)).indexOf(0),s=String.fromCharCode.apply(String,p.slice(0,a)),this.text[s]=String.fromCharCode.apply(String,p.slice(a+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return o.load=function(e,t,r){var n;return"function"==typeof t&&(r=t),(n=new XMLHttpRequest).open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){var e;return e=new o(new Uint8Array(n.response||n.mozResponseArrayBuffer)),"function"==typeof(null!=t?t.getContext:void 0)&&e.render(t),"function"==typeof r?r(e):void 0},n.send(null)},o.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},o.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.decodePixels=function(t){var r,n,i,o,a,s,l,u,p,c,d,f,h,y,m,g,v,_,b,w,S,x,I;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new e(t)).getBytes(),g=(f=this.pixelBitlength/8)*this.width,h=new Uint8Array(g*this.height),s=t.length,m=0,y=0,n=0;y<s;){switch(t[y++]){case 0:for(o=b=0;b<g;o=b+=1)h[n++]=t[y++];break;case 1:for(o=w=0;w<g;o=w+=1)r=t[y++],a=o<f?0:h[n-f],h[n++]=(r+a)%256;break;case 2:for(o=S=0;S<g;o=S+=1)r=t[y++],i=(o-o%f)/f,v=m&&h[(m-1)*g+i*f+o%f],h[n++]=(v+r)%256;break;case 3:for(o=x=0;x<g;o=x+=1)r=t[y++],i=(o-o%f)/f,a=o<f?0:h[n-f],v=m&&h[(m-1)*g+i*f+o%f],h[n++]=(r+Math.floor((a+v)/2))%256;break;case 4:for(o=I=0;I<g;o=I+=1)r=t[y++],i=(o-o%f)/f,a=o<f?0:h[n-f],0===m?v=_=0:(v=h[(m-1)*g+i*f+o%f],_=i&&h[(m-1)*g+(i-1)*f+o%f]),l=a+v-_,u=Math.abs(l-a),c=Math.abs(l-v),d=Math.abs(l-_),p=u<=c&&u<=d?a:c<=d?v:_,h[n++]=(r+p)%256;break;default:throw new Error("Invalid filter algorithm: "+t[y-1])}m++}return h},o.prototype.decodePalette=function(){var e,t,r,n,i,o,a,s,l;for(r=this.palette,o=this.transparency.indexed||[],i=new Uint8Array((o.length||0)+r.length),n=0,r.length,e=0,t=a=0,s=r.length;a<s;t=a+=3)i[n++]=r[t],i[n++]=r[t+1],i[n++]=r[t+2],i[n++]=null!=(l=o[e++])?l:255;return i},o.prototype.copyToImageData=function(e,t){var r,n,i,o,a,s,l,u,p,c,d;if(n=this.colors,p=null,r=this.hasAlphaChannel,this.palette.length&&(p=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),n=4,r=!0),u=(i=e.data||e).length,a=p||t,o=s=0,1===n)for(;o<u;)l=p?4*t[o/4]:s,c=a[l++],i[o++]=c,i[o++]=c,i[o++]=c,i[o++]=r?a[l++]:this.transparency.grayscale&&this.transparency.grayscale===c?0:255,s=l;else for(;o<u;)l=p?4*t[o/4]:s,i[o++]=a[l++],i[o++]=a[l++],i[o++]=a[l++],i[o++]=r?a[l++]:this.transparency.rgb&&this.transparency.rgb[1]===a[l-3]&&this.transparency.rgb[3]===a[l-2]&&this.transparency.rgb[5]===a[l-1]?0:255,s=l},o.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e},n=t.document&&t.document.createElement("canvas"),i=n&&n.getContext("2d"),r=function(e){var t;return i.width=e.width,i.height=e.height,i.clearRect(0,0,e.width,e.height),i.putImageData(e,0,0),(t=new Image).src=n.toDataURL(),t},o.prototype.decodeFrames=function(e){var t,n,i,o,a,s,l,u;if(this.animation){for(u=[],n=a=0,s=(l=this.animation.frames).length;a<s;n=++a)t=l[n],i=e.createImageData(t.width,t.height),o=this.decodePixels(new Uint8Array(t.data)),this.copyToImageData(i,o),t.imageData=i,u.push(t.image=r(i));return u}},o.prototype.renderFrame=function(e,t){var r,n,i;return r=(n=this.animation.frames)[t],i=n[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=i?i.disposeOp:void 0)?e.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(null!=i?i.disposeOp:void 0)&&e.putImageData(i.imageData,i.xOffset,i.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},o.prototype.animate=function(e){var t,r,n,i,o,a,s=this;return r=0,a=this.animation,i=a.numFrames,n=a.frames,o=a.numPlays,(t=function(){var a,l;if(a=r++%i,l=n[a],s.renderFrame(e,a),i>1&&r/i<o)return s.animation._timeout=setTimeout(t,l.delay)})()},o.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},o.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},o}(this)}.apply(null,n))||(e.exports=i)},987:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r=function(e,t){var r=t.width*t.height,i=t.pixelType;return Math.floor(e.byteLength/(r*n(i)))},n=function(e){var t=1;switch(e){case Uint8Array:case Int8Array:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t};return function(){function e(){}return e.decode=function(e,t){var i,o,a,s,l,u=t.pixelType,p=[],c=t.width*t.height,d=r(e,t),f=t.bandIds,h=t.format,y=f&&f.length||r(e,t),m=e.byteLength-e.byteLength%(c*n(u)),g=new u(e,0,c*d);if("bip"===h)for(i=0;i<y;i++){for(s=new u(c),l=f?f[i]:i,o=0;o<c;o++)s[o]=g[o*d+l];p.push(s)}else if("bsq"===h)for(i=0;i<y;i++)l=f?f[i]:i,p.push(g.subarray(l*c,(l+1)*c));return m<e.byteLength-1&&(a=function(e,t){if(8*e.byteLength<t)return null;var r=new Uint8Array(e,0,Math.ceil(t/8)),n=new Uint8Array(t),i=0,o=0,a=0,s=0;for(a=0;a<r.length-1;a++)for(o=r[a],s=7;s>=0;s--)n[i++]=o>>s&1;for(s=7;i<t-1;)o=r[r.length-1],n[i++]=o>>s&1,s--;return n}(e.slice(m),c)),{pixels:p,mask:a}},e}()}.apply(null,n))||(e.exports=i)},988:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(267)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0};function i(e){var t=e.altitude,r=e.azimuth,n=e.hillshadeType,i=e.pixelSizePower,o=e.pixelSizeFactor,a=e.scalingType,s=e.isGCS,l=e.resolution,u="multi-directional"===n?2*e.zFactor:e.zFactor,p=l.x,c=l.y,d=u/(8*p),f=u/(8*c);if(s&&u>.001&&(d/=111e3,f/=111e3),"adjusted"===a)if(s){var h=111e3*p,y=111e3*c;d=(u+Math.pow(h,i)*o)/(8*h),f=(u+Math.pow(y,i)*o)/(8*y)}else d=(u+Math.pow(p,i)*o)/(8*p),f=(u+Math.pow(c,i)*o)/(8*c);var m=(90-t)*Math.PI/180,g=Math.cos(m),v=(360-r+90)*Math.PI/180,_=Math.sin(m)*Math.cos(v),b=Math.sin(m)*Math.sin(v),w=[315,270,225,360,180,0],S=[60,60,60,60,60,90],x=new Float32Array([3,5,3,2,1,4]),I=x.reduce((function(e,t){return e+t})),R=x.map((function(e){return e/I})),T="multi-directional"===n?w.length:1,C=new Float32Array(6),P=new Float32Array(6),L=new Float32Array(6);if("multi-directional"===n)for(var k=0;k<T;k++)r=w[k],m=(90-(t=S[k]))*Math.PI/180,g=Math.cos(m),v=(360-r+90)*Math.PI/180,_=Math.sin(m)*Math.cos(v),b=Math.sin(m)*Math.sin(v),C[k]=g,P[k]=_,L[k]=b;else C.fill(g),P.fill(_),L.fill(b);return{resolution:l,factor:[d,f],sinZcosA:_,sinZsinA:b,cosZ:g,sinZcosAs:P,sinZsinAs:L,cosZs:C,weights:R,hillshadeType:["traditional","multi-directional"].indexOf(n)}}t.calculateHillshadeParams=i,t.hillshade=function(e,t){if(!n(e))return e;var o=e.width,a=e.height,s=e.mask,l=new Uint8Array(o*a);s&&l.set(s);for(var u,p,c,d,f,h,y,m,g=i(t),v=g.factor,_=g.sinZcosA,b=g.sinZsinA,w=g.cosZ,S=g.sinZcosAs,x=g.sinZsinAs,I=g.cosZs,R=g.weights,T=v[0],C=v[1],P=t.hillshadeType,L=e.pixels[0],k=new Uint8Array(o*a),M=1;M<a-1;M++)for(var O=M*o,E=1;E<o-1;E++)if(!s||s[O+E]){var A=8;if(s&&(A=s[O-o+E-1]+s[O-o+E]+s[O-o+E+1]+s[O+E-1]+s[O+E+1]+s[O+o+E-1]+s[O+o+E]+s[O+o+E+1])<7)k[O+E]=0,l[O+E]=0;else{7===A?(u=s[O-o+E-1]?L[O-o+E-1]:L[O+E],p=s[O-o+E]?L[O-o+E]:L[O+E],c=s[O-o+E+1]?L[O-o+E+1]:L[O+E],d=s[O+E-1]?L[O+E-1]:L[O+E],f=s[O+E+1]?L[O+E+1]:L[O+E],h=s[O+o+E-1]?L[O+o+E-1]:L[O+E],y=s[O+o+E]?L[O+o+E]:L[O+E],m=s[O+o+E+1]?L[O+o+E+1]:L[O+E]):(u=L[O-o+E-1],p=L[O-o+E],c=L[O-o+E+1],d=L[O+E-1],f=L[O+E+1],h=L[O+o+E-1],y=L[O+o+E],m=L[O+o+E+1]);var D=(c+f+f+m-(u+d+d+h))*T,N=(h+y+y+m-(u+p+p+c))*C,F=Math.sqrt(1+D*D+N*N),j=0;if("traditional"===P)(B=255*(w+b*N-_*D)/F)<0&&(B=0),j=B;else for(var V=x.length,U=0;U<V;U++){var B;(B=255*(I[U]+x[U]*N-S[U]*D)/F)<0&&(B=0),j+=B*R[U]}k[O+E]=255&j}}else k[O+E]=0;for(M=0;M<a;M++)k[M*o]=k[M*o+1],k[(M+1)*o-1]=k[(M+1)*o-2];for(M=1;M<o-1;M++)k[M]=k[M+o],k[M+(a-1)*o]=k[M+(a-2)*o];return new r({width:o,height:a,pixels:[k],mask:s?l:null,pixelType:"u8",validPixelCount:e.validPixelCount,statistics:[{minValue:0,maxValue:255}]})},t.tintHillshade=function(e,t,r,i){if(n(e)&&n(t)){for(var o=i.min,a=i.max,s=e.pixels[0],l=t.pixels,u=t.mask,p=l[0],c=255.00001/(a-o),d=new Uint8ClampedArray(p.length),f=new Uint8ClampedArray(p.length),h=new Uint8ClampedArray(p.length),y=r.length-1,m=0;m<p.length;m++)if(!u||0!==u[m]){var g=Math.floor((p[m]-o)*c),v=r[g<0?0:g>y?y:g],_=v[0],b=v[1],w=s[m],S=w*b,x=S*(1-Math.abs(_%2-1)),I=w-S;switch(Math.floor(_)){case 0:d[m]=S+I,f[m]=x+I,h[m]=I;break;case 1:d[m]=x+I,f[m]=S+I,h[m]=I;break;case 2:d[m]=I,f[m]=S+I,h[m]=x+I;break;case 3:d[m]=I,f[m]=x+I,h[m]=S+I;break;case 4:d[m]=x+I,f[m]=I,h[m]=S+I;break;case 5:case 6:d[m]=S+I,f[m]=I,h[m]=x+I}}e.pixels=[d,f,h],e.updateStatistics()}}}.apply(null,n))||(e.exports=i)},989:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(180)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getExifValue=function(e){var t=e.exifInfo,n=e.exifName,i=e.tagName;if(!t||!n||!i)return null;var o=r.find(t,(function(e){return e.name===n}));return o?function(e){var t=e.tagName,n=e.tags;if(!n||!t)return null;var i=r.find(n,(function(e){return e.name===t}));return i&&i.value||null}({tagName:i,tags:o.tags}):null}}.apply(null,n))||(e.exports=i)},990:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(117),r(165),r(314)],void 0===(i=function(e,t,r,n,i){function o(e){var t=e.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.outFields&&(t.outFields=t.outFields.join(",")),t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.source&&(t.layer=JSON.stringify({source:t.source}),delete t.source),t}Object.defineProperty(t,"__esModule",{value:!0}),t.toQueryStringParameters=o,t.executeRelationshipQuery=function(e,t,a){var s={query:i.mapParameters(r.__assign(r.__assign(r.__assign({},e.query),{f:"json"}),o(t)))};return a&&(s=r.__assign(r.__assign({},a),s)),n(e.path+"/queryRelatedRecords",s).then((function(e){for(var t=e.data,r=t.geometryType,n=t.spatialReference,i={},o=0,a=t.relatedRecordGroups;o<a.length;o++){var s=a[o],l={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:n,hasZ:!!t.hasZ,hasM:!!t.hasM,features:s.relatedRecords};if(null!=s.objectId)i[s.objectId]=l;else for(var u in s)s.hasOwnProperty(u)&&"relatedRecords"!==u&&(i[s[u]]=l)}return e.data=i,e}))}}.apply(null,n))||(e.exports=i)}}]);
//# sourceMappingURL=34.js.map